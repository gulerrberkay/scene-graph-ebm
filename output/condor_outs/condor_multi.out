2023-03-13 02:04:16,151 maskrcnn_benchmark INFO: Using 2 GPUs
2023-03-13 02:04:16,152 maskrcnn_benchmark INFO: Namespace(config_file='configs/e2e_relation_X_101_32_8_FPN_1x_energy.yaml', local_rank=0, skip_test=False, opts=[], slurm_id=None, distributed=True)
2023-03-13 02:04:16,152 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2023-03-13 02:04:16,713 maskrcnn_benchmark INFO: 
PyTorch version: 1.13.0+cu117
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Fedora Linux 37 (KDE Plasma) (x86_64)
GCC version: (GCC) 12.2.1 20221121 (Red Hat 12.2.1-4)
Clang version: 15.0.7 (Fedora 15.0.7-1.fc37)
CMake version: version 3.26.0-rc5
Libc version: glibc-2.36

Python version: 3.10.8 (main, Nov 24 2022, 14:13:03) [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.1.14-200.fc37.x86_64-x86_64-with-glibc2.36
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA GeForce RTX 3090
GPU 1: NVIDIA GeForce RTX 3090
GPU 2: NVIDIA GeForce RTX 3090

Nvidia driver version: 525.89.02
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] numpy==1.23.5
[pip3] torch==1.13.0
[pip3] torch-scatter==2.1.0
[pip3] torchaudio==0.13.0
[pip3] torchvision==0.14.0
[conda] Could not collect
        Pillow (9.3.0)
2023-03-13 02:04:16,713 maskrcnn_benchmark INFO: Loaded configuration file configs/e2e_relation_X_101_32_8_FPN_1x_energy.yaml
2023-03-13 02:04:16,713 maskrcnn_benchmark INFO: 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
MODEL:
  META_ARCHITECTURE: "GeneralizedRCNN"
  WEIGHT: "catalog://ImageNetPretrained/FAIR/20171220/X-101-32x8d"
  PRETRAINED_DETECTOR_CKPT: "/users/students/r0879687/amager/vg/pretrained-detector/pretrained_faster_rcnn/model_final.pth"
  BACKBONE:
    CONV_BODY: "R-101-FPN" # VGG-16
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    STRIDE_IN_1X1: False
    NUM_GROUPS: 32
    WIDTH_PER_GROUP: 8
  BASE_ONLY: False           # When training energy model set this to false.
  RELATION_ON: True
  ATTRIBUTE_ON: False
  FLIP_AUG: False            # if there is any left-right relation, FLIP AUG should be false
  RPN:
    USE_FPN: True
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)   # from neural-motifs
    PRE_NMS_TOP_N_TRAIN: 6000
    PRE_NMS_TOP_N_TEST: 6000
    POST_NMS_TOP_N_TRAIN: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_PER_BATCH: False
    RPN_MID_CHANNEL: 256
  ROI_HEADS:
    USE_FPN: True
    POSITIVE_FRACTION: 0.5
    BG_IOU_THRESHOLD: 0.3
    BATCH_SIZE_PER_IMAGE: 256
    DETECTIONS_PER_IMG: 50
    NMS_FILTER_DUPLICATES: True
  ROI_BOX_HEAD:
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    NUM_CLASSES: 151                # 151 for VG, 1201 for GQA
    MLP_HEAD_DIM: 4096
  ROI_ATTRIBUTE_HEAD:
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    USE_BINARY_LOSS: True           # choose binary, because cross_entropy loss deteriorate the box head, even with 0.1 weight
    POS_WEIGHT: 50.0
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    NUM_ATTRIBUTES: 201             # 201 for VG, 501 for GQA
    MAX_ATTRIBUTES: 10             
    ATTRIBUTE_BGFG_SAMPLE: True    
    ATTRIBUTE_BGFG_RATIO: 3        
  ROI_RELATION_HEAD:
    USE_GT_BOX: False
    USE_GT_OBJECT_LABEL: False
    REQUIRE_BOX_OVERLAP: False              # for sgdet, during training, only train pairs with overlap
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True    # for sgdet only, in case some gt boxes are missing
    NUM_CLASSES: 51                 # 51 for VG, 201 for GQA (not contain "to the left of" & "to the right of")
    BATCH_SIZE_PER_IMAGE: 64      # sample as much as possible
    POSITIVE_FRACTION: 0.25
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_HIDDEN_DIM: 512         #1024 for VCTree
    POOLING_ALL_LEVELS: True
    LABEL_SMOOTHING_LOSS: False
    FEATURE_EXTRACTOR: "RelationFeatureExtractor"
    #################### Select Relationship Model ####################
    PREDICTOR: "MotifPredictor"
    #PREDICTOR: "VCTreePredictor"
    #PREDICTOR: "TransformerPredictor"
    #PREDICTOR: "CausalAnalysisPredictor"
    ################# Parameters for Motif Predictor ##################
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_REL_LAYER: 1
    ############# Parameters for Causal Unbias Predictor ##############
    ### Implementation for paper "Unbiased Scene Graph Generation from Biased Training"
    CAUSAL:
      EFFECT_TYPE: 'none'             # candicates: 'TDE', 'NIE', 'TE', 'none'
      FUSION_TYPE: 'sum'              # candicates: 'sum', 'gate'         
      SEPARATE_SPATIAL: False         # separate spatial in union feature
      CONTEXT_LAYER: "motifs"         # candicates: motifs, vctree, vtranse
      SPATIAL_FOR_VISION: True
      EFFECT_ANALYSIS: True
    ############### Parameters for Transformer Predictor ##############
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      OBJ_LAYER: 4
      REL_LAYER: 2
      NUM_HEAD: 8
      KEY_DIM: 64
      VAL_DIM: 64
      INNER_DIM: 2048
    ############### Parameters for Energy Model ##############
    EBM:
      OBJ_EMBED_DIM: 300
      REL_EMBED_DIM: 300
      OBJ_LABEL_EMBED_DIM: 300
      REL_LABEL_EMBED_DIM: 300
      POOLING_DIM: 300
DATASETS:
  TRAIN: ("VG_stanford_filtered_with_attribute_train",)
  VAL: ("VG_stanford_filtered_with_attribute_val",)
  TEST: ("VG_stanford_filtered_with_attribute_test",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
SAMPLER:
  NAME: 'SGLD'
  LR: 0.1                  # For 4GPU -> 1,  1gpu -> 0.25  default:0.1
  VAR: 0.001
  ITERS: 1
  GRAD_CLIP: 0.01

SOLVER:
  PRE_VAL: False
  IMS_PER_BATCH: 4
  BIAS_LR_FACTOR: 1
  BASE_LR: 0.0005          # 0.001/4 = 0.00025 For energy learning
  WARMUP_FACTOR: 0.1
  WEIGHT_DECAY: 0.0001
  MOMENTUM: 0.9
  GRAD_NORM_CLIP: 5.0
  STEPS: (40000, 54000)
  MAX_ITER: 80000
  VAL_PERIOD: 2000
  CHECKPOINT_PERIOD: 2000
  PRINT_GRAD_FREQ: 2000
  SCHEDULE:
    # the following paramters are only used for WarmupReduceLROnPlateau
    TYPE: "WarmupReduceLROnPlateau"    # WarmupMultiStepLR, WarmupReduceLROnPlateau
    #TYPE: "WarmupMultiStepLR"
    PATIENCE: 2
    THRESHOLD: 0.001
    COOLDOWN: 0
    FACTOR: 0.05   #0.1
    MAX_DECAY_STEP: 3

#OUTPUT_DIR: '/users/students/r0879687/amager/vg/output/relation_baseline_predcls_energy_bs4'
#OUTPUT_DIR: '/users/students/r0879687/amager/vg/output/relation_baseline_sgcls_energy_bs4'
OUTPUT_DIR: '/users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi'

TEST:
  IMS_PER_BATCH: 2
  DETECTIONS_PER_IMG: 50
  ALLOW_LOAD_FROM_CACHE: False
  RELATION:
    SYNC_GATHER: True      # turn on will slow down the evaluation to solve the sgdet test out of memory problem
    REQUIRE_OVERLAP: False
    LATER_NMS_PREDICTION_THRES: 0.5

  # Equival schedules with...
  # 1 GPU:
  #   BASE_LR: 0.0025
  #   MAX_ITER: 60000
  #   STEPS: [0, 30000, 40000]
  # 2 GPUs:
  #   BASE_LR: 0.005
  #   MAX_ITER: 30000
  #   STEPS: [0, 15000, 20000]
  # 4 GPUs:
  #   BASE_LR: 0.01
  #   MAX_ITER: 15000
  #   STEPS: [0, 7500, 10000]
  # 8 GPUs:
  #   BASE_LR: 0.02
  #   MAX_ITER: 7500
  #   STEPS: [0, 3750, 5000]

2023-03-13 02:04:16,714 maskrcnn_benchmark INFO: Running with config:
AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  NUM_OBJ_CLASSES: 151
  NUM_REL_CLASSES: 51
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
ENERGY_MODEL:
  DATA_NOISE_VAR: 0.0001
  L2COEFF: 1
  LOSS: ContrastiveDivergence
  META_ARCHITECTURE: GraphEnergyModel
  TEMP: 1
  TRAINIG_MODE: joint
GLOVE_DIR: /users/students/r0879687/amager/vg/glove
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  BASE_ONLY: False
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  DEV_RUN: False
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: /users/students/r0879687/amager/vg/pretrained-detector/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 50
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: False
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 64
    CAUSAL:
      CONTEXT_LAYER: motifs
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 512
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EBM:
      OBJ_EMBED_DIM: 300
      OBJ_LABEL_EMBED_DIM: 300
      POOLING_DIM: 300
      REL_EMBED_DIM: 300
      REL_LABEL_EMBED_DIM: 300
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: MotifPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: False
    USE_GT_OBJECT_LABEL: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: catalog://ImageNetPretrained/FAIR/20171220/X-101-32x8d
OUTPUT_DIR: /users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi
PATHS_CATALOG: /users/students/r0879687/Documents/Master_thesis/ebm/energy-based-scene-graph/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /users/students/r0879687/amager/vg/VG_100K
SAMPLER:
  GRAD_CLIP: 0.01
  ITERS: 1
  LR: 0.1
  NAME: SGLD
  VAR: 0.001
SOLVER:
  BASE_LR: 0.0005
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 4
  MAX_ITER: 80000
  MOMENTUM: 0.9
  PRE_VAL: False
  PRINT_GRAD_FREQ: 2000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.05
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupReduceLROnPlateau
  STEPS: (40000, 54000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 50
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 2
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: True
  SAVE_PROPOSALS: False
WANDB:
  MUTE: False
2023-03-13 02:04:16,714 maskrcnn_benchmark INFO: Saving config into: /users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi/config.yml
2023-03-13 02:04:16,784 maskrcnn_benchmark INFO: #################### prepare training ####################
2023-03-13 02:04:16,786 maskrcnn_benchmark.modeling.detector.generalized_rcnn INFO: #################### Building Backbone ####################
2023-03-13 02:04:17,676 maskrcnn_benchmark.modeling.detector.generalized_rcnn INFO: #################### Building RPN ####################
2023-03-13 02:04:17,684 maskrcnn_benchmark.modeling.detector.generalized_rcnn INFO: #################### Building ROI Heads ####################
loading word vectors from /users/students/r0879687/amager/vg/glove/glove.6B.200d.pt
2023-03-13 02:04:19,848 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
2023-03-13 02:04:19,849 maskrcnn_benchmark.data.build INFO: get dataset statistics...
2023-03-13 02:04:19,849 maskrcnn_benchmark.data.build INFO: Loading data statistics from: /users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi/VG_stanford_filtered_with_attribute_train_statistics.cache
2023-03-13 02:04:19,849 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
loading word vectors from /users/students/r0879687/amager/vg/glove/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
__background__ -> __background__ 
fail on __background__
loading word vectors from /users/students/r0879687/amager/vg/glove/glove.6B.200d.pt
loading word vectors from /users/students/r0879687/amager/vg/glove/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
__background__ -> __background__ 
fail on __background__
2023-03-13 02:04:22,242 maskrcnn_benchmark INFO: #################### end base model construction ####################
2023-03-13 02:04:22,271 maskrcnn_benchmark INFO: #################### End energy Model Constructin ####################
2023-03-13 02:04:26,982 maskrcnn_benchmark INFO: #################### end optimizer and scheduler ####################
2023-03-13 02:04:27,702 maskrcnn_benchmark INFO: #################### end distributed ####################
2023-03-13 02:04:27,704 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from /users/students/r0879687/amager/vg/pretrained-detector/pretrained_faster_rcnn/model_final.pth
2023-03-13 02:04:38,152 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING module.roi_heads.relation.box_feature_extractor.fc6.bias in current model to module.roi_heads.box.feature_extractor.fc6.bias in loaded model.
2023-03-13 02:04:38,153 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING module.roi_heads.relation.box_feature_extractor.fc6.weight in current model to module.roi_heads.box.feature_extractor.fc6.weight in loaded model.
2023-03-13 02:04:38,153 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING module.roi_heads.relation.box_feature_extractor.fc7.bias in current model to module.roi_heads.box.feature_extractor.fc7.bias in loaded model.
2023-03-13 02:04:38,153 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING module.roi_heads.relation.box_feature_extractor.fc7.weight in current model to module.roi_heads.box.feature_extractor.fc7.weight in loaded model.
2023-03-13 02:04:38,153 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias in current model to module.roi_heads.box.feature_extractor.fc6.bias in loaded model.
2023-03-13 02:04:38,154 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight in current model to module.roi_heads.box.feature_extractor.fc6.weight in loaded model.
2023-03-13 02:04:38,154 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias in current model to module.roi_heads.box.feature_extractor.fc7.bias in loaded model.
2023-03-13 02:04:38,154 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight in current model to module.roi_heads.box.feature_extractor.fc7.weight in loaded model.
2023-03-13 02:04:38,154 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias in current model to module.roi_heads.box.feature_extractor.pooler.reduce_channel.0.bias in loaded model.
2023-03-13 02:04:38,154 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight in current model to module.roi_heads.box.feature_extractor.pooler.reduce_channel.0.weight in loaded model.
2023-03-13 02:04:38,206 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! module.roi_heads.relation.box_feature_extractor.fc6.bias                                           loaded from roi_heads.box.feature_extractor.fc6.bias         of shape (4096,)
2023-03-13 02:04:38,206 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! module.roi_heads.relation.box_feature_extractor.fc6.weight                                         loaded from roi_heads.box.feature_extractor.fc6.weight       of shape (4096, 12544)
2023-03-13 02:04:38,206 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! module.roi_heads.relation.box_feature_extractor.fc7.bias                                           loaded from roi_heads.box.feature_extractor.fc7.bias         of shape (4096,)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! module.roi_heads.relation.box_feature_extractor.fc7.weight                                         loaded from roi_heads.box.feature_extractor.fc7.weight       of shape (4096, 4096)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias of shape (3072,)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight of shape (3072, 5136)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight of shape (152, 200)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias of shape (151,)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight of shape (151, 512)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias of shape (2560,)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight of shape (2560, 512)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0 of shape (2048,)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse of shape (2048,)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0 of shape (2048,)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse of shape (2048,)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0 of shape (2048, 512)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse of shape (2048, 512)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0 of shape (2048, 4808)
2023-03-13 02:04:38,207 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse of shape (2048, 4808)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.lin_edge_h.bias of shape (512,)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.lin_edge_h.weight of shape (512, 1024)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.lin_obj_h.bias of shape (512,)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.lin_obj_h.weight of shape (512, 1024)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0 of shape (2048,)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse of shape (2048,)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0 of shape (2048,)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse of shape (2048,)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0 of shape (2048, 512)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse of shape (2048, 512)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0 of shape (2048, 4424)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse of shape (2048, 4424)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.obj_embed1.weight of shape (151, 200)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.obj_embed2.weight of shape (151, 200)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.pos_embed.0.bias of shape (32,)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.pos_embed.0.weight of shape (32, 9)
2023-03-13 02:04:38,208 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.pos_embed.1.bias of shape (32,)
2023-03-13 02:04:38,209 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.pos_embed.1.num_batches_tracked of shape ()
2023-03-13 02:04:38,209 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.pos_embed.1.running_mean of shape (32,)
2023-03-13 02:04:38,209 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.pos_embed.1.running_var of shape (32,)
2023-03-13 02:04:38,209 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.pos_embed.1.weight of shape (32,)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.pos_embed.2.bias of shape (128,)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.pos_embed.2.weight of shape (128, 32)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.untreated_dcd_feat of shape (4936,)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.untreated_edg_feat of shape (4296,)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.context_layer.untreated_obj_feat of shape (4424,)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.freq_bias.obj_baseline.weight of shape (22801, 51)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.post_cat.bias of shape (4096,)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.post_cat.weight of shape (4096, 1024)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.post_emb.bias of shape (1024,)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.post_emb.weight of shape (1024, 512)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.rel_compress.bias of shape (51,)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.predictor.rel_compress.weight of shape (51, 4096)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias                       loaded from roi_heads.box.feature_extractor.fc6.bias         of shape (4096,)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight                     loaded from roi_heads.box.feature_extractor.fc6.weight       of shape (4096, 12544)
2023-03-13 02:04:38,210 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias                       loaded from roi_heads.box.feature_extractor.fc7.bias         of shape (4096,)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight                     loaded from roi_heads.box.feature_extractor.fc7.weight       of shape (4096, 4096)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias of shape (256,)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight of shape (256, 1024, 3, 3)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.0.bias of shape (128,)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.0.weight of shape (128, 2, 7, 7)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.2.bias of shape (128,)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.2.num_batches_tracked of shape ()
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.2.running_mean of shape (128,)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.2.running_var of shape (128,)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.2.weight of shape (128,)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.4.bias of shape (256,)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.4.weight of shape (256, 128, 3, 3)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.6.bias of shape (256,)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.6.num_batches_tracked of shape ()
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.6.running_mean of shape (256,)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.6.running_var of shape (256,)
2023-03-13 02:04:38,211 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: module.roi_heads.relation.union_feature_extractor.rect_conv.6.weight of shape (256,)
2023-03-13 02:04:38,556 maskrcnn_benchmark INFO: #################### end load checkpointer ####################
2023-03-13 02:04:38,556 maskrcnn_benchmark.data.build WARNING: When using more than one image per GPU you may encounter an out-of-memory (OOM) error if your GPU does not have sufficient memory. If this happens, you can reduce SOLVER.IMS_PER_BATCH (for training) or TEST.IMS_PER_BATCH (for inference). For training, you must also adjust the learning rate and schedule length according to the linear scaling rule. See for example: https://github.com/facebookresearch/Detectron/blob/master/configs/getting_started/tutorial_1gpu_e2e_faster_rcnn_R-50-FPN.yaml#L14
2023-03-13 02:05:45,435 maskrcnn_benchmark.utils.miscellaneous INFO: Saving labels mapping into /users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi/labels.json
2023-03-13 02:06:04,391 maskrcnn_benchmark INFO: #################### end dataloader ####################
2023-03-13 02:06:04,391 maskrcnn_benchmark INFO: Start training
2023-03-13 02:06:12,919 maskrcnn_benchmark INFO: ---Total norm 0.81130 clip coef 6.16298-----------------
2023-03-13 02:06:13,029 maskrcnn_benchmark INFO: module.energy.0.weight                            : 0.39176, (torch.Size([300, 600]))
2023-03-13 02:06:13,030 maskrcnn_benchmark INFO: module.obj_emdedding.weight                       : 0.34614, (torch.Size([300, 4096]))
2023-03-13 02:06:13,030 maskrcnn_benchmark INFO: module.energy.2.weight                            : 0.24382, (torch.Size([1, 300]))
2023-03-13 02:06:13,030 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.weight            : 0.22255, (torch.Size([300, 300]))
2023-03-13 02:06:13,030 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.weight            : 0.22214, (torch.Size([300, 600]))
2023-03-13 02:06:13,030 maskrcnn_benchmark INFO: module.energy.0.bias                              : 0.21759, (torch.Size([300]))
2023-03-13 02:06:13,030 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_ih                 : 0.16155, (torch.Size([900]))
2023-03-13 02:06:13,030 maskrcnn_benchmark INFO: module.obj_label_embedding.weight                 : 0.14687, (torch.Size([300, 279]))
2023-03-13 02:06:13,030 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.bias                : 0.14136, (torch.Size([1]))
2023-03-13 02:06:13,030 maskrcnn_benchmark INFO: module.energy.2.bias                              : 0.13635, (torch.Size([1]))
2023-03-13 02:06:13,030 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.weight              : 0.13186, (torch.Size([1, 300]))
2023-03-13 02:06:13,030 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_hh               : 0.10745, (torch.Size([900, 300]))
2023-03-13 02:06:13,031 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_ih                 : 0.09726, (torch.Size([900]))
2023-03-13 02:06:13,031 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.bias              : 0.09624, (torch.Size([300]))
2023-03-13 02:06:13,031 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.bias              : 0.08532, (torch.Size([300]))
2023-03-13 02:06:13,031 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_hh                 : 0.08112, (torch.Size([900]))
2023-03-13 02:06:13,031 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_ih               : 0.07281, (torch.Size([900, 300]))
2023-03-13 02:06:13,031 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_hh               : 0.07177, (torch.Size([900, 300]))
2023-03-13 02:06:13,031 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.bias                : 0.06579, (torch.Size([300]))
2023-03-13 02:06:13,031 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.bias                : 0.05249, (torch.Size([1]))
2023-03-13 02:06:13,031 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.bias                : 0.05088, (torch.Size([1]))
2023-03-13 02:06:13,031 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_hh                 : 0.04897, (torch.Size([900]))
2023-03-13 02:06:13,031 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.weight              : 0.04026, (torch.Size([1, 300]))
2023-03-13 02:06:13,031 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_ih               : 0.03854, (torch.Size([900, 300]))
2023-03-13 02:06:13,032 maskrcnn_benchmark INFO: module.obj_emdedding.bias                         : 0.03270, (torch.Size([300]))
2023-03-13 02:06:13,032 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.weight              : 0.03045, (torch.Size([300, 300]))
2023-03-13 02:06:13,032 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.bias                : 0.02619, (torch.Size([300]))
2023-03-13 02:06:13,032 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.weight              : 0.02399, (torch.Size([1, 300]))
2023-03-13 02:06:13,032 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.bias           : 0.02055, (torch.Size([300]))
2023-03-13 02:06:13,032 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.bias           : 0.01935, (torch.Size([300]))
2023-03-13 02:06:13,032 maskrcnn_benchmark INFO: module.obj_label_embedding.bias                   : 0.01928, (torch.Size([300]))
2023-03-13 02:06:13,032 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_ih               : 0.01526, (torch.Size([900, 300]))
2023-03-13 02:06:13,032 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_hh               : 0.01339, (torch.Size([900, 300]))
2023-03-13 02:06:13,032 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.weight         : 0.01215, (torch.Size([300, 300]))
2023-03-13 02:06:13,032 maskrcnn_benchmark INFO: module.pos_embed.2.weight                         : 0.01166, (torch.Size([128, 32]))
2023-03-13 02:06:13,033 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.weight         : 0.01052, (torch.Size([300, 600, 1, 1]))
2023-03-13 02:06:13,033 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.bias           : 0.01050, (torch.Size([300]))
2023-03-13 02:06:13,033 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.weight         : 0.00979, (torch.Size([300, 300, 1, 1]))
2023-03-13 02:06:13,033 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.weight         : 0.00937, (torch.Size([300, 300]))
2023-03-13 02:06:13,033 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.bias           : 0.00850, (torch.Size([300]))
2023-03-13 02:06:13,033 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.bias           : 0.00791, (torch.Size([300]))
2023-03-13 02:06:13,033 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.weight         : 0.00668, (torch.Size([300, 300]))
2023-03-13 02:06:13,033 maskrcnn_benchmark INFO: module.rel_label_embedding.weight                 : 0.00635, (torch.Size([300, 51]))
2023-03-13 02:06:13,033 maskrcnn_benchmark INFO: module.rel_label_embedding.bias                   : 0.00529, (torch.Size([300]))
2023-03-13 02:06:13,033 maskrcnn_benchmark INFO: module.pos_embed.0.weight                         : 0.00511, (torch.Size([32, 9]))
2023-03-13 02:06:13,033 maskrcnn_benchmark INFO: module.pos_embed.2.bias                           : 0.00400, (torch.Size([128]))
2023-03-13 02:06:13,033 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.weight              : 0.00381, (torch.Size([300, 300]))
2023-03-13 02:06:13,034 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.bias           : 0.00380, (torch.Size([300]))
2023-03-13 02:06:13,034 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.weight         : 0.00267, (torch.Size([300, 300]))
2023-03-13 02:06:13,034 maskrcnn_benchmark INFO: module.pos_embed.1.bias                           : 0.00192, (torch.Size([32]))
2023-03-13 02:06:13,034 maskrcnn_benchmark INFO: module.pos_embed.1.weight                         : 0.00128, (torch.Size([32]))
2023-03-13 02:06:13,034 maskrcnn_benchmark INFO: module.pos_embed.0.bias                           : 0.00000, (torch.Size([32]))
2023-03-13 02:06:13,034 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 02:06:13,040 maskrcnn_benchmark INFO: ---Total norm 5.42147 clip coef 0.92226-----------------
2023-03-13 02:06:13,044 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 3.85013, (torch.Size([3072, 5136]))
2023-03-13 02:06:13,045 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 1.98707, (torch.Size([4096, 12544]))
2023-03-13 02:06:13,045 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.weight: 1.60058, (torch.Size([4096, 4096]))
2023-03-13 02:06:13,045 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 1.38237, (torch.Size([4096, 4096]))
2023-03-13 02:06:13,045 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.19983, (torch.Size([151, 512]))
2023-03-13 02:06:13,045 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.weight: 1.17753, (torch.Size([4096, 12544]))
2023-03-13 02:06:13,045 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.83268, (torch.Size([151]))
2023-03-13 02:06:13,045 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.74966, (torch.Size([512, 1024]))
2023-03-13 02:06:13,045 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.weight: 0.70979, (torch.Size([4096, 1024]))
2023-03-13 02:06:13,045 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.weight: 0.60112, (torch.Size([51, 4096]))
2023-03-13 02:06:13,045 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.56300, (torch.Size([256, 1024, 3, 3]))
2023-03-13 02:06:13,046 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.52628, (torch.Size([256, 128, 3, 3]))
2023-03-13 02:06:13,046 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.40770, (torch.Size([2048, 4808]))
2023-03-13 02:06:13,046 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.40562, (torch.Size([2048, 4808]))
2023-03-13 02:06:13,046 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.29274, (torch.Size([3072]))
2023-03-13 02:06:13,046 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.19985, (torch.Size([512, 1024]))
2023-03-13 02:06:13,046 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.19976, (torch.Size([128, 2, 7, 7]))
2023-03-13 02:06:13,046 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.16974, (torch.Size([2560, 512]))
2023-03-13 02:06:13,046 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.13394, (torch.Size([512]))
2023-03-13 02:06:13,046 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.12215, (torch.Size([2560]))
2023-03-13 02:06:13,046 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.10556, (torch.Size([2048, 4424]))
2023-03-13 02:06:13,047 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.10400, (torch.Size([2048, 4424]))
2023-03-13 02:06:13,047 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.07442, (torch.Size([2048, 512]))
2023-03-13 02:06:13,047 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.07165, (torch.Size([2048, 512]))
2023-03-13 02:06:13,047 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.05458, (torch.Size([512]))
2023-03-13 02:06:13,047 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.bias: 0.05006, (torch.Size([51]))
2023-03-13 02:06:13,047 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.04256, (torch.Size([22801, 51]))
2023-03-13 02:06:13,047 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.bias: 0.03381, (torch.Size([4096]))
2023-03-13 02:06:13,047 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.03228, (torch.Size([128]))
2023-03-13 02:06:13,047 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.weight: 0.03112, (torch.Size([1024, 512]))
2023-03-13 02:06:13,047 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.03081, (torch.Size([128, 32]))
2023-03-13 02:06:13,048 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.bias : 0.02210, (torch.Size([4096]))
2023-03-13 02:06:13,048 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.02118, (torch.Size([2048]))
2023-03-13 02:06:13,048 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.02118, (torch.Size([2048]))
2023-03-13 02:06:13,048 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.02050, (torch.Size([2048]))
2023-03-13 02:06:13,048 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.02050, (torch.Size([2048]))
2023-03-13 02:06:13,048 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.02010, (torch.Size([32, 9]))
2023-03-13 02:06:13,048 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.02008, (torch.Size([2048, 512]))
2023-03-13 02:06:13,048 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.01938, (torch.Size([2048, 512]))
2023-03-13 02:06:13,048 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.01502, (torch.Size([151, 200]))
2023-03-13 02:06:13,048 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.bias : 0.01379, (torch.Size([1024]))
2023-03-13 02:06:13,048 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.01257, (torch.Size([128]))
2023-03-13 02:06:13,049 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.01220, (torch.Size([4096]))
2023-03-13 02:06:13,049 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.bias: 0.00981, (torch.Size([4096]))
2023-03-13 02:06:13,049 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.00923, (torch.Size([128]))
2023-03-13 02:06:13,049 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.00825, (torch.Size([256]))
2023-03-13 02:06:13,049 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00787, (torch.Size([2048]))
2023-03-13 02:06:13,049 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00787, (torch.Size([2048]))
2023-03-13 02:06:13,049 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00784, (torch.Size([256]))
2023-03-13 02:06:13,049 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00777, (torch.Size([2048]))
2023-03-13 02:06:13,049 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00777, (torch.Size([2048]))
2023-03-13 02:06:13,049 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00703, (torch.Size([256]))
2023-03-13 02:06:13,049 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00685, (torch.Size([32]))
2023-03-13 02:06:13,049 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00679, (torch.Size([151, 200]))
2023-03-13 02:06:13,050 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00674, (torch.Size([152, 200]))
2023-03-13 02:06:13,050 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00639, (torch.Size([4096]))
2023-03-13 02:06:13,050 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00516, (torch.Size([256]))
2023-03-13 02:06:13,050 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00413, (torch.Size([128]))
2023-03-13 02:06:13,050 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00371, (torch.Size([32]))
2023-03-13 02:06:13,050 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-13 02:06:13,050 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 02:11:35,896 maskrcnn_benchmark INFO: eta: 1 day, 12:44:30  iter: 200  loss: 1.4017 (2.5525)  ML Loss (cd): -0.2432 (-0.1611)  loss_refine_obj: 1.3968 (2.3799)  loss_rel: 0.2735 (0.3337)  time: 1.6725 (1.6575)  data: 0.0048 (0.0065)  energy lr: 0.000916  base lr : 0.000916  max mem: 4801
2023-03-13 02:16:58,834 maskrcnn_benchmark INFO: eta: 1 day, 12:10:34  iter: 400  loss: 1.2765 (2.0093)  ML Loss (cd): -0.2454 (-0.2013)  loss_refine_obj: 1.2258 (1.8830)  loss_rel: 0.2590 (0.3276)  time: 1.5404 (1.6361)  data: 0.0049 (0.0057)  energy lr: 0.001636  base lr : 0.001636  max mem: 4847
2023-03-13 02:22:19,988 maskrcnn_benchmark INFO: eta: 1 day, 11:51:43  iter: 600  loss: 1.2759 (1.7776)  ML Loss (cd): -0.2472 (-0.2161)  loss_refine_obj: 1.1893 (1.6787)  loss_rel: 0.2759 (0.3151)  time: 1.5383 (1.6260)  data: 0.0046 (0.0054)  energy lr: 0.002000  base lr : 0.002000  max mem: 4847
2023-03-13 02:27:42,577 maskrcnn_benchmark INFO: eta: 1 day, 11:42:00  iter: 800  loss: 1.0460 (1.6188)  ML Loss (cd): -0.2491 (-0.2241)  loss_refine_obj: 0.9980 (1.5329)  loss_rel: 0.3270 (0.3100)  time: 1.7045 (1.6227)  data: 0.0048 (0.0052)  energy lr: 0.002000  base lr : 0.002000  max mem: 4847
2023-03-13 02:33:05,660 maskrcnn_benchmark INFO: eta: 1 day, 11:34:40  iter: 1000  loss: 0.9516 (1.4940)  ML Loss (cd): -0.2489 (-0.2289)  loss_refine_obj: 0.8664 (1.4155)  loss_rel: 0.2553 (0.3074)  time: 1.6484 (1.6213)  data: 0.0048 (0.0052)  energy lr: 0.002000  base lr : 0.002000  max mem: 4868
2023-03-13 02:38:26,777 maskrcnn_benchmark INFO: eta: 1 day, 11:25:49  iter: 1200  loss: 0.7917 (1.3925)  ML Loss (cd): -0.2458 (-0.2321)  loss_refine_obj: 0.7209 (1.3206)  loss_rel: 0.2683 (0.3040)  time: 1.6050 (1.6187)  data: 0.0048 (0.0051)  energy lr: 0.002000  base lr : 0.002000  max mem: 4868
2023-03-13 02:43:50,925 maskrcnn_benchmark INFO: eta: 1 day, 11:20:49  iter: 1400  loss: 0.8104 (1.3123)  ML Loss (cd): -0.2493 (-0.2344)  loss_refine_obj: 0.6938 (1.2424)  loss_rel: 0.2848 (0.3043)  time: 1.6099 (1.6190)  data: 0.0048 (0.0051)  energy lr: 0.002000  base lr : 0.002000  max mem: 4868
2023-03-13 02:49:13,932 maskrcnn_benchmark INFO: eta: 1 day, 11:14:47  iter: 1600  loss: 0.7143 (1.2417)  ML Loss (cd): -0.2495 (-0.2363)  loss_refine_obj: 0.6616 (1.1763)  loss_rel: 0.3034 (0.3017)  time: 1.5765 (1.6185)  data: 0.0048 (0.0050)  energy lr: 0.002000  base lr : 0.002000  max mem: 4868
2023-03-13 02:54:35,273 maskrcnn_benchmark INFO: eta: 1 day, 11:07:41  iter: 1800  loss: 0.6365 (1.1840)  ML Loss (cd): -0.2497 (-0.2377)  loss_refine_obj: 0.6659 (1.1207)  loss_rel: 0.2536 (0.3010)  time: 1.5968 (1.6172)  data: 0.0048 (0.0050)  energy lr: 0.002000  base lr : 0.002000  max mem: 4868
2023-03-13 02:59:56,372 maskrcnn_benchmark INFO: ---Total norm 0.23032 clip coef 21.70927-----------------
2023-03-13 02:59:56,521 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.weight            : 0.09585, (torch.Size([300, 600]))
2023-03-13 02:59:56,521 maskrcnn_benchmark INFO: module.energy.0.weight                            : 0.09431, (torch.Size([300, 600]))
2023-03-13 02:59:56,521 maskrcnn_benchmark INFO: module.energy.2.weight                            : 0.07717, (torch.Size([1, 300]))
2023-03-13 02:59:56,521 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.bias                : 0.07660, (torch.Size([1]))
2023-03-13 02:59:56,521 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_ih                 : 0.07052, (torch.Size([900]))
2023-03-13 02:59:56,522 maskrcnn_benchmark INFO: module.obj_label_embedding.weight                 : 0.06166, (torch.Size([300, 279]))
2023-03-13 02:59:56,522 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.weight              : 0.06002, (torch.Size([1, 300]))
2023-03-13 02:59:56,522 maskrcnn_benchmark INFO: module.energy.2.bias                              : 0.05113, (torch.Size([1]))
2023-03-13 02:59:56,522 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_hh               : 0.04825, (torch.Size([900, 300]))
2023-03-13 02:59:56,522 maskrcnn_benchmark INFO: module.obj_emdedding.weight                       : 0.04283, (torch.Size([300, 4096]))
2023-03-13 02:59:56,522 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_hh                 : 0.03535, (torch.Size([900]))
2023-03-13 02:59:56,522 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_ih               : 0.02902, (torch.Size([900, 300]))
2023-03-13 02:59:56,522 maskrcnn_benchmark INFO: module.energy.0.bias                              : 0.02066, (torch.Size([300]))
2023-03-13 02:59:56,522 maskrcnn_benchmark INFO: module.obj_label_embedding.bias                   : 0.01452, (torch.Size([300]))
2023-03-13 02:59:56,522 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.bias           : 0.01396, (torch.Size([300]))
2023-03-13 02:59:56,523 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.bias           : 0.01310, (torch.Size([300]))
2023-03-13 02:59:56,523 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.weight            : 0.01276, (torch.Size([300, 300]))
2023-03-13 02:59:56,523 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.weight         : 0.01000, (torch.Size([300, 300]))
2023-03-13 02:59:56,523 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.bias              : 0.00931, (torch.Size([300]))
2023-03-13 02:59:56,523 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.bias              : 0.00895, (torch.Size([300]))
2023-03-13 02:59:56,523 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_hh               : 0.00852, (torch.Size([900, 300]))
2023-03-13 02:59:56,523 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.weight         : 0.00682, (torch.Size([300, 300]))
2023-03-13 02:59:56,523 maskrcnn_benchmark INFO: module.pos_embed.2.weight                         : 0.00674, (torch.Size([128, 32]))
2023-03-13 02:59:56,523 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.weight         : 0.00622, (torch.Size([300, 300]))
2023-03-13 02:59:56,523 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_ih                 : 0.00585, (torch.Size([900]))
2023-03-13 02:59:56,523 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.bias           : 0.00577, (torch.Size([300]))
2023-03-13 02:59:56,524 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.bias           : 0.00575, (torch.Size([300]))
2023-03-13 02:59:56,524 maskrcnn_benchmark INFO: module.pos_embed.0.weight                         : 0.00512, (torch.Size([32, 9]))
2023-03-13 02:59:56,524 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.weight              : 0.00497, (torch.Size([1, 300]))
2023-03-13 02:59:56,524 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_hh               : 0.00424, (torch.Size([900, 300]))
2023-03-13 02:59:56,524 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_ih               : 0.00370, (torch.Size([900, 300]))
2023-03-13 02:59:56,524 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_hh                 : 0.00297, (torch.Size([900]))
2023-03-13 02:59:56,524 maskrcnn_benchmark INFO: module.rel_label_embedding.weight                 : 0.00290, (torch.Size([300, 51]))
2023-03-13 02:59:56,524 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.bias                : 0.00285, (torch.Size([1]))
2023-03-13 02:59:56,524 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.bias           : 0.00272, (torch.Size([300]))
2023-03-13 02:59:56,524 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_ih               : 0.00270, (torch.Size([900, 300]))
2023-03-13 02:59:56,524 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.bias                : 0.00253, (torch.Size([300]))
2023-03-13 02:59:56,524 maskrcnn_benchmark INFO: module.pos_embed.2.bias                           : 0.00253, (torch.Size([128]))
2023-03-13 02:59:56,525 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.weight         : 0.00209, (torch.Size([300, 300, 1, 1]))
2023-03-13 02:59:56,525 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.weight         : 0.00197, (torch.Size([300, 600, 1, 1]))
2023-03-13 02:59:56,525 maskrcnn_benchmark INFO: module.rel_label_embedding.bias                   : 0.00184, (torch.Size([300]))
2023-03-13 02:59:56,525 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.weight         : 0.00140, (torch.Size([300, 300]))
2023-03-13 02:59:56,525 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.weight              : 0.00137, (torch.Size([300, 300]))
2023-03-13 02:59:56,525 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.bias                : 0.00121, (torch.Size([300]))
2023-03-13 02:59:56,525 maskrcnn_benchmark INFO: module.pos_embed.1.bias                           : 0.00120, (torch.Size([32]))
2023-03-13 02:59:56,525 maskrcnn_benchmark INFO: module.obj_emdedding.bias                         : 0.00110, (torch.Size([300]))
2023-03-13 02:59:56,525 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.bias           : 0.00092, (torch.Size([300]))
2023-03-13 02:59:56,525 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.weight              : 0.00081, (torch.Size([300, 300]))
2023-03-13 02:59:56,525 maskrcnn_benchmark INFO: module.pos_embed.1.weight                         : 0.00077, (torch.Size([32]))
2023-03-13 02:59:56,526 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.bias                : 0.00033, (torch.Size([1]))
2023-03-13 02:59:56,526 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.weight              : 0.00016, (torch.Size([1, 300]))
2023-03-13 02:59:56,526 maskrcnn_benchmark INFO: module.pos_embed.0.bias                           : 0.00000, (torch.Size([32]))
2023-03-13 02:59:56,526 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 02:59:56,530 maskrcnn_benchmark INFO: ---Total norm 3.41253 clip coef 1.46519-----------------
2023-03-13 02:59:56,535 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 1.67324, (torch.Size([3072, 5136]))
2023-03-13 02:59:56,535 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 1.46259, (torch.Size([4096, 12544]))
2023-03-13 02:59:56,535 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.23445, (torch.Size([151, 512]))
2023-03-13 02:59:56,535 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.weight: 1.08521, (torch.Size([4096, 4096]))
2023-03-13 02:59:56,535 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.weight: 0.99364, (torch.Size([51, 4096]))
2023-03-13 02:59:56,536 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.99119, (torch.Size([4096, 4096]))
2023-03-13 02:59:56,536 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.weight: 0.97571, (torch.Size([4096, 12544]))
2023-03-13 02:59:56,536 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.49926, (torch.Size([512, 1024]))
2023-03-13 02:59:56,536 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.46745, (torch.Size([256, 1024, 3, 3]))
2023-03-13 02:59:56,536 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.weight: 0.45820, (torch.Size([4096, 1024]))
2023-03-13 02:59:56,536 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.36643, (torch.Size([2048, 4808]))
2023-03-13 02:59:56,536 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.34975, (torch.Size([2048, 4808]))
2023-03-13 02:59:56,536 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.29429, (torch.Size([256, 128, 3, 3]))
2023-03-13 02:59:56,537 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.16860, (torch.Size([2560, 512]))
2023-03-13 02:59:56,537 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.11841, (torch.Size([128, 2, 7, 7]))
2023-03-13 02:59:56,537 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.06241, (torch.Size([512, 1024]))
2023-03-13 02:59:56,537 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.05698, (torch.Size([512]))
2023-03-13 02:59:56,537 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.04514, (torch.Size([2048, 4424]))
2023-03-13 02:59:56,537 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.04462, (torch.Size([2048, 4424]))
2023-03-13 02:59:56,537 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.03950, (torch.Size([151]))
2023-03-13 02:59:56,537 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.03681, (torch.Size([2048, 512]))
2023-03-13 02:59:56,537 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.bias: 0.03553, (torch.Size([51]))
2023-03-13 02:59:56,537 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.03264, (torch.Size([2048, 512]))
2023-03-13 02:59:56,538 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.02915, (torch.Size([22801, 51]))
2023-03-13 02:59:56,538 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.02242, (torch.Size([128]))
2023-03-13 02:59:56,538 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.02235, (torch.Size([3072]))
2023-03-13 02:59:56,538 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.weight: 0.02027, (torch.Size([1024, 512]))
2023-03-13 02:59:56,538 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.01223, (torch.Size([128, 32]))
2023-03-13 02:59:56,538 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.bias: 0.01070, (torch.Size([4096]))
2023-03-13 02:59:56,538 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01066, (torch.Size([32, 9]))
2023-03-13 02:59:56,538 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.01033, (torch.Size([4096]))
2023-03-13 02:59:56,538 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.bias : 0.00936, (torch.Size([4096]))
2023-03-13 02:59:56,538 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.00688, (torch.Size([256]))
2023-03-13 02:59:56,539 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.00643, (torch.Size([512]))
2023-03-13 02:59:56,539 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.00636, (torch.Size([2048]))
2023-03-13 02:59:56,539 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.00636, (torch.Size([2048]))
2023-03-13 02:59:56,539 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.bias : 0.00588, (torch.Size([1024]))
2023-03-13 02:59:56,539 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.bias: 0.00583, (torch.Size([4096]))
2023-03-13 02:59:56,539 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.00581, (torch.Size([2048]))
2023-03-13 02:59:56,539 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.00581, (torch.Size([2048]))
2023-03-13 02:59:56,539 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.00579, (torch.Size([2560]))
2023-03-13 02:59:56,539 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.00528, (torch.Size([151, 200]))
2023-03-13 02:59:56,539 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.00495, (torch.Size([128]))
2023-03-13 02:59:56,539 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00490, (torch.Size([2048, 512]))
2023-03-13 02:59:56,540 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00473, (torch.Size([2048, 512]))
2023-03-13 02:59:56,540 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00455, (torch.Size([256]))
2023-03-13 02:59:56,540 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00446, (torch.Size([4096]))
2023-03-13 02:59:56,540 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00418, (torch.Size([256]))
2023-03-13 02:59:56,540 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00408, (torch.Size([256]))
2023-03-13 02:59:56,540 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00325, (torch.Size([152, 200]))
2023-03-13 02:59:56,540 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00249, (torch.Size([128]))
2023-03-13 02:59:56,540 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00225, (torch.Size([151, 200]))
2023-03-13 02:59:56,540 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00158, (torch.Size([128]))
2023-03-13 02:59:56,540 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00137, (torch.Size([32]))
2023-03-13 02:59:56,541 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00113, (torch.Size([32]))
2023-03-13 02:59:56,541 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00077, (torch.Size([2048]))
2023-03-13 02:59:56,541 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00077, (torch.Size([2048]))
2023-03-13 02:59:56,541 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00073, (torch.Size([2048]))
2023-03-13 02:59:56,541 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00073, (torch.Size([2048]))
2023-03-13 02:59:56,541 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-13 02:59:56,541 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 02:59:56,546 maskrcnn_benchmark INFO: eta: 1 day, 11:00:53  iter: 2000  loss: 0.7296 (1.1357)  ML Loss (cd): -0.2493 (-0.2389)  loss_refine_obj: 0.6470 (1.0744)  loss_rel: 0.2916 (0.3002)  time: 1.5758 (1.6161)  data: 0.0048 (0.0050)  energy lr: 0.002000  base lr : 0.002000  max mem: 4892
2023-03-13 02:59:56,550 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi/model_0002000.pth
2023-03-13 03:00:31,827 maskrcnn_benchmark INFO: Start validating
2023-03-13 03:00:31,849 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-13 03:25:17,464 maskrcnn_benchmark INFO: Total run time: 0:24:45.613987 (0.5942455946922303 s / img per device, on 2 devices)
2023-03-13 03:25:17,465 maskrcnn_benchmark INFO: Model inference time: 0:19:56.607923 (0.4786431692123413 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(249987, 7)
0/249987
DONE (t=1.69s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=30.20s).
Accumulating evaluation results...
DONE (t=6.81s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.141
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.269
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.134
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.061
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.105
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.177
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.212
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.308
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.155
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.257
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.339
2023-03-13 03:29:51,697 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2685
====================================================================================================
SGG eval:   R @ 20: 0.2049;   R @ 50: 0.2725;   R @ 100: 0.3084;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2116; ngR @ 50: 0.2936; ngR @ 100: 0.3509;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0021;  zR @ 50: 0.0063;  zR @ 100: 0.0124;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0030;  zR @ 50: 0.0075;  zR @ 100: 0.0140;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0110;  zR @ 50: 0.0220;  zR @ 100: 0.0366;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0193;  zR @ 50: 0.0279;  zR @ 100: 0.0408;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0307;  zR @ 50: 0.0524;  zR @ 100: 0.0792;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0154;  zR @ 50: 0.0479;  zR @ 100: 0.0786;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0194;  zR @ 50: 0.0570;  zR @ 100: 0.0796;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0303;  zR @ 50: 0.0424;  zR @ 100: 0.0545;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0288;  zR @ 50: 0.0590;  zR @ 100: 0.0806;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0216;  zR @ 50: 0.0486;  zR @ 100: 0.0703;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0213;  zR @ 50: 0.0213;  zR @ 100: 0.0757;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0429;  zR @ 50: 0.0917;  zR @ 100: 0.1131;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0260;  zR @ 50: 0.0260;  zR @ 100: 0.0390;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1827;  zR @ 50: 0.2583;  zR @ 100: 0.2990;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.0833;  zR @ 50: 0.1458;  zR @ 100: 0.1905;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1987;  zR @ 50: 0.1987;  zR @ 100: 0.2372;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.3333;  zR @ 50: 0.6667;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0373;  mR @ 50: 0.0504;  mR @ 100: 0.0577;  for mode=sgdet, type=Mean Recall.
(above:0.0192) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0152) (attached to:0.0000) (behind:0.1997) (belonging to:0.0000) (between:0.0000) (carrying:0.0680) (covered in:0.0000) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.3641) (holding:0.1939) (in:0.1350) (in front of:0.0362) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2193) (of:0.2024) (on:0.4090) (on back of:0.0000) (over:0.0000) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.3229) (says:0.0000) (sitting on:0.0279) (standing on:0.0000) (to:0.0000) (under:0.0323) (using:0.0769) (walking in:0.0000) (walking on:0.0027) (watching:0.0000) (wearing:0.5394) (wears:0.0000) (with:0.0230) 
====================================================================================================

2023-03-13 03:29:52,686 maskrcnn_benchmark INFO: Validation Result: 0.3084
2023-03-13 03:35:18,059 maskrcnn_benchmark INFO: eta: 2 days, 4:35:25  iter: 2200  loss: 0.7110 (1.0940)  ML Loss (cd): -0.2497 (-0.2398)  loss_refine_obj: 0.7179 (1.0356)  loss_rel: 0.2544 (0.2982)  time: 1.6667 (2.4335)  data: 0.0050 (0.8214)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 03:40:44,140 maskrcnn_benchmark INFO: eta: 2 days, 3:00:45  iter: 2400  loss: 0.5433 (1.0584)  ML Loss (cd): -0.2497 (-0.2406)  loss_refine_obj: 0.5750 (1.0020)  loss_rel: 0.1826 (0.2970)  time: 1.6132 (2.3666)  data: 0.0049 (0.7534)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 03:46:09,841 maskrcnn_benchmark INFO: eta: 2 days, 1:39:37  iter: 2600  loss: 0.6827 (1.0292)  ML Loss (cd): -0.2497 (-0.2413)  loss_refine_obj: 0.6275 (0.9744)  loss_rel: 0.2477 (0.2961)  time: 1.5837 (2.3098)  data: 0.0048 (0.6958)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 03:51:31,476 maskrcnn_benchmark INFO: eta: 2 days, 0:27:26  iter: 2800  loss: 0.6324 (1.0045)  ML Loss (cd): -0.2498 (-0.2419)  loss_refine_obj: 0.6445 (0.9513)  loss_rel: 0.2083 (0.2951)  time: 1.6662 (2.2597)  data: 0.0048 (0.6465)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 03:56:57,371 maskrcnn_benchmark INFO: eta: 1 day, 23:25:59  iter: 3000  loss: 0.5759 (0.9822)  ML Loss (cd): -0.2498 (-0.2424)  loss_refine_obj: 0.6221 (0.9300)  loss_rel: 0.2389 (0.2946)  time: 1.5869 (2.2177)  data: 0.0048 (0.6037)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 04:02:18,012 maskrcnn_benchmark INFO: eta: 1 day, 22:29:26  iter: 3200  loss: 0.5883 (0.9633)  ML Loss (cd): -0.2497 (-0.2429)  loss_refine_obj: 0.5810 (0.9123)  loss_rel: 0.2345 (0.2938)  time: 1.5588 (2.1793)  data: 0.0053 (0.5663)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 04:07:31,415 maskrcnn_benchmark INFO: eta: 1 day, 21:36:12  iter: 3400  loss: 0.7114 (0.9451)  ML Loss (cd): -0.2496 (-0.2433)  loss_refine_obj: 0.6364 (0.8959)  loss_rel: 0.2710 (0.2925)  time: 1.5193 (2.1432)  data: 0.0050 (0.5333)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 04:12:44,060 maskrcnn_benchmark INFO: eta: 1 day, 20:48:01  iter: 3600  loss: 0.7019 (0.9289)  ML Loss (cd): -0.2498 (-0.2436)  loss_refine_obj: 0.6196 (0.8806)  loss_rel: 0.2681 (0.2919)  time: 1.5934 (2.1110)  data: 0.0050 (0.5039)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 04:17:50,325 maskrcnn_benchmark INFO: eta: 1 day, 20:02:14  iter: 3800  loss: 0.6740 (0.9146)  ML Loss (cd): -0.2499 (-0.2440)  loss_refine_obj: 0.6624 (0.8672)  loss_rel: 0.2599 (0.2914)  time: 1.4525 (2.0805)  data: 0.0050 (0.4777)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 04:22:56,135 maskrcnn_benchmark INFO: ---Total norm 0.22057 clip coef 22.66893-----------------
2023-03-13 04:22:56,403 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.weight            : 0.09493, (torch.Size([300, 600]))
2023-03-13 04:22:56,404 maskrcnn_benchmark INFO: module.energy.0.weight                            : 0.09071, (torch.Size([300, 600]))
2023-03-13 04:22:56,404 maskrcnn_benchmark INFO: module.energy.2.weight                            : 0.07559, (torch.Size([1, 300]))
2023-03-13 04:22:56,404 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.bias                : 0.07433, (torch.Size([1]))
2023-03-13 04:22:56,404 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_ih                 : 0.06770, (torch.Size([900]))
2023-03-13 04:22:56,405 maskrcnn_benchmark INFO: module.obj_label_embedding.weight                 : 0.05880, (torch.Size([300, 279]))
2023-03-13 04:22:56,405 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.weight              : 0.05714, (torch.Size([1, 300]))
2023-03-13 04:22:56,405 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_hh               : 0.04610, (torch.Size([900, 300]))
2023-03-13 04:22:56,405 maskrcnn_benchmark INFO: module.energy.2.bias                              : 0.04575, (torch.Size([1]))
2023-03-13 04:22:56,405 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_hh                 : 0.03390, (torch.Size([900]))
2023-03-13 04:22:56,405 maskrcnn_benchmark INFO: module.obj_emdedding.weight                       : 0.03185, (torch.Size([300, 4096]))
2023-03-13 04:22:56,405 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_ih               : 0.02837, (torch.Size([900, 300]))
2023-03-13 04:22:56,405 maskrcnn_benchmark INFO: module.energy.0.bias                              : 0.01889, (torch.Size([300]))
2023-03-13 04:22:56,405 maskrcnn_benchmark INFO: module.obj_label_embedding.bias                   : 0.01380, (torch.Size([300]))
2023-03-13 04:22:56,405 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.bias           : 0.01316, (torch.Size([300]))
2023-03-13 04:22:56,406 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.bias           : 0.01216, (torch.Size([300]))
2023-03-13 04:22:56,406 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.weight         : 0.01046, (torch.Size([300, 300]))
2023-03-13 04:22:56,406 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.bias              : 0.00837, (torch.Size([300]))
2023-03-13 04:22:56,406 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.bias              : 0.00826, (torch.Size([300]))
2023-03-13 04:22:56,406 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.weight         : 0.00788, (torch.Size([300, 300]))
2023-03-13 04:22:56,406 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.weight            : 0.00779, (torch.Size([300, 300]))
2023-03-13 04:22:56,406 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.bias                : 0.00737, (torch.Size([1]))
2023-03-13 04:22:56,406 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.weight              : 0.00714, (torch.Size([1, 300]))
2023-03-13 04:22:56,406 maskrcnn_benchmark INFO: module.pos_embed.2.weight                         : 0.00685, (torch.Size([128, 32]))
2023-03-13 04:22:56,406 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.weight         : 0.00605, (torch.Size([300, 300]))
2023-03-13 04:22:56,406 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_hh               : 0.00601, (torch.Size([900, 300]))
2023-03-13 04:22:56,406 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_ih                 : 0.00557, (torch.Size([900]))
2023-03-13 04:22:56,407 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.bias           : 0.00540, (torch.Size([300]))
2023-03-13 04:22:56,407 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.bias           : 0.00518, (torch.Size([300]))
2023-03-13 04:22:56,407 maskrcnn_benchmark INFO: module.pos_embed.0.weight                         : 0.00484, (torch.Size([32, 9]))
2023-03-13 04:22:56,407 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_hh               : 0.00463, (torch.Size([900, 300]))
2023-03-13 04:22:56,407 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_ih               : 0.00355, (torch.Size([900, 300]))
2023-03-13 04:22:56,407 maskrcnn_benchmark INFO: module.rel_label_embedding.weight                 : 0.00349, (torch.Size([300, 51]))
2023-03-13 04:22:56,407 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_hh                 : 0.00281, (torch.Size([900]))
2023-03-13 04:22:56,407 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_ih               : 0.00255, (torch.Size([900, 300]))
2023-03-13 04:22:56,407 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.bias           : 0.00254, (torch.Size([300]))
2023-03-13 04:22:56,407 maskrcnn_benchmark INFO: module.pos_embed.2.bias                           : 0.00240, (torch.Size([128]))
2023-03-13 04:22:56,407 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.bias                : 0.00215, (torch.Size([300]))
2023-03-13 04:22:56,408 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.bias                : 0.00211, (torch.Size([1]))
2023-03-13 04:22:56,410 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.weight         : 0.00197, (torch.Size([300, 300]))
2023-03-13 04:22:56,410 maskrcnn_benchmark INFO: module.rel_label_embedding.bias                   : 0.00197, (torch.Size([300]))
2023-03-13 04:22:56,411 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.weight         : 0.00189, (torch.Size([300, 300, 1, 1]))
2023-03-13 04:22:56,411 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.weight         : 0.00181, (torch.Size([300, 600, 1, 1]))
2023-03-13 04:22:56,411 maskrcnn_benchmark INFO: module.pos_embed.1.bias                           : 0.00109, (torch.Size([32]))
2023-03-13 04:22:56,411 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.weight              : 0.00108, (torch.Size([1, 300]))
2023-03-13 04:22:56,411 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.weight              : 0.00105, (torch.Size([300, 300]))
2023-03-13 04:22:56,411 maskrcnn_benchmark INFO: module.obj_emdedding.bias                         : 0.00103, (torch.Size([300]))
2023-03-13 04:22:56,411 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.bias                : 0.00093, (torch.Size([300]))
2023-03-13 04:22:56,411 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.bias           : 0.00087, (torch.Size([300]))
2023-03-13 04:22:56,411 maskrcnn_benchmark INFO: module.pos_embed.1.weight                         : 0.00076, (torch.Size([32]))
2023-03-13 04:22:56,411 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.weight              : 0.00036, (torch.Size([300, 300]))
2023-03-13 04:22:56,411 maskrcnn_benchmark INFO: module.pos_embed.0.bias                           : 0.00000, (torch.Size([32]))
2023-03-13 04:22:56,411 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 04:22:56,417 maskrcnn_benchmark INFO: ---Total norm 3.06805 clip coef 1.62970-----------------
2023-03-13 04:22:56,422 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 1.46540, (torch.Size([3072, 5136]))
2023-03-13 04:22:56,422 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.44103, (torch.Size([151, 512]))
2023-03-13 04:22:56,422 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 1.08545, (torch.Size([4096, 12544]))
2023-03-13 04:22:56,423 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.weight: 1.01644, (torch.Size([4096, 4096]))
2023-03-13 04:22:56,423 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.weight: 0.99024, (torch.Size([4096, 12544]))
2023-03-13 04:22:56,423 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.weight: 0.85340, (torch.Size([51, 4096]))
2023-03-13 04:22:56,423 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.71159, (torch.Size([4096, 4096]))
2023-03-13 04:22:56,423 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.43551, (torch.Size([256, 1024, 3, 3]))
2023-03-13 04:22:56,424 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.40106, (torch.Size([512, 1024]))
2023-03-13 04:22:56,424 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.weight: 0.38950, (torch.Size([4096, 1024]))
2023-03-13 04:22:56,424 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.28490, (torch.Size([2048, 4808]))
2023-03-13 04:22:56,424 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.25446, (torch.Size([2048, 4808]))
2023-03-13 04:22:56,424 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.23841, (torch.Size([256, 128, 3, 3]))
2023-03-13 04:22:56,424 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.17636, (torch.Size([2560, 512]))
2023-03-13 04:22:56,424 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.09244, (torch.Size([128, 2, 7, 7]))
2023-03-13 04:22:56,424 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.05799, (torch.Size([512, 1024]))
2023-03-13 04:22:56,424 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.05741, (torch.Size([151]))
2023-03-13 04:22:56,424 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.04898, (torch.Size([512]))
2023-03-13 04:22:56,424 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.04181, (torch.Size([2048, 4424]))
2023-03-13 04:22:56,424 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.03954, (torch.Size([2048, 4424]))
2023-03-13 04:22:56,425 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.bias: 0.03070, (torch.Size([51]))
2023-03-13 04:22:56,425 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.02898, (torch.Size([22801, 51]))
2023-03-13 04:22:56,425 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.02882, (torch.Size([2048, 512]))
2023-03-13 04:22:56,425 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.02586, (torch.Size([3072]))
2023-03-13 04:22:56,425 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.02292, (torch.Size([2048, 512]))
2023-03-13 04:22:56,425 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.weight: 0.01708, (torch.Size([1024, 512]))
2023-03-13 04:22:56,425 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.01530, (torch.Size([128, 32]))
2023-03-13 04:22:56,425 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.01433, (torch.Size([128]))
2023-03-13 04:22:56,425 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01234, (torch.Size([32, 9]))
2023-03-13 04:22:56,425 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.bias: 0.00981, (torch.Size([4096]))
2023-03-13 04:22:56,425 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.00909, (torch.Size([4096]))
2023-03-13 04:22:56,426 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.bias : 0.00819, (torch.Size([4096]))
2023-03-13 04:22:56,426 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.00716, (torch.Size([2560]))
2023-03-13 04:22:56,426 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.00678, (torch.Size([512]))
2023-03-13 04:22:56,426 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.00578, (torch.Size([151, 200]))
2023-03-13 04:22:56,426 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.00554, (torch.Size([256]))
2023-03-13 04:22:56,426 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.00547, (torch.Size([2048]))
2023-03-13 04:22:56,426 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.00547, (torch.Size([2048]))
2023-03-13 04:22:56,426 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.bias : 0.00525, (torch.Size([1024]))
2023-03-13 04:22:56,426 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.bias: 0.00493, (torch.Size([4096]))
2023-03-13 04:22:56,426 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.00478, (torch.Size([2048]))
2023-03-13 04:22:56,426 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.00478, (torch.Size([2048]))
2023-03-13 04:22:56,426 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00459, (torch.Size([2048, 512]))
2023-03-13 04:22:56,429 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00459, (torch.Size([2048, 512]))
2023-03-13 04:22:56,429 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.00424, (torch.Size([128]))
2023-03-13 04:22:56,429 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00384, (torch.Size([256]))
2023-03-13 04:22:56,429 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00379, (torch.Size([256]))
2023-03-13 04:22:56,430 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00365, (torch.Size([4096]))
2023-03-13 04:22:56,430 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00332, (torch.Size([256]))
2023-03-13 04:22:56,430 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00307, (torch.Size([152, 200]))
2023-03-13 04:22:56,430 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00258, (torch.Size([128]))
2023-03-13 04:22:56,430 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00245, (torch.Size([32]))
2023-03-13 04:22:56,430 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00241, (torch.Size([128]))
2023-03-13 04:22:56,430 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00201, (torch.Size([151, 200]))
2023-03-13 04:22:56,430 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00196, (torch.Size([32]))
2023-03-13 04:22:56,430 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00085, (torch.Size([2048]))
2023-03-13 04:22:56,430 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00085, (torch.Size([2048]))
2023-03-13 04:22:56,430 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00081, (torch.Size([2048]))
2023-03-13 04:22:56,431 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00081, (torch.Size([2048]))
2023-03-13 04:22:56,431 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-13 04:22:56,431 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 04:22:56,436 maskrcnn_benchmark INFO: eta: 1 day, 19:20:28  iter: 4000  loss: 0.6375 (0.9012)  ML Loss (cd): -0.2499 (-0.2442)  loss_refine_obj: 0.6168 (0.8551)  loss_rel: 0.2146 (0.2903)  time: 1.5168 (2.0530)  data: 0.0049 (0.4540)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 04:22:56,441 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi/model_0004000.pth
2023-03-13 04:23:30,126 maskrcnn_benchmark INFO: Start validating
2023-03-13 04:23:30,154 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-13 04:48:15,016 maskrcnn_benchmark INFO: Total run time: 0:24:44.861883 (0.5939447533607483 s / img per device, on 2 devices)
2023-03-13 04:48:15,018 maskrcnn_benchmark INFO: Model inference time: 0:19:08.135578 (0.45925423126220705 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(249987, 7)
0/249987
DONE (t=1.72s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=30.09s).
Accumulating evaluation results...
DONE (t=6.71s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.145
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.280
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.136
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.062
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.108
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.184
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.217
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.314
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.160
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.263
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.348
2023-03-13 04:52:52,402 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2799
====================================================================================================
SGG eval:   R @ 20: 0.2294;   R @ 50: 0.2934;   R @ 100: 0.3313;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2334; ngR @ 50: 0.3177; ngR @ 100: 0.3775;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0021;  zR @ 50: 0.0095;  zR @ 100: 0.0276;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0060;  zR @ 50: 0.0150;  zR @ 100: 0.0165;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0147;  zR @ 50: 0.0293;  zR @ 100: 0.0330;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0193;  zR @ 50: 0.0279;  zR @ 100: 0.0494;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0219;  zR @ 50: 0.0417;  zR @ 100: 0.0738;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0256;  zR @ 50: 0.0513;  zR @ 100: 0.0889;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0330;  zR @ 50: 0.0512;  zR @ 100: 0.0783;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0202;  zR @ 50: 0.0298;  zR @ 100: 0.0389;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0432;  zR @ 50: 0.0791;  zR @ 100: 0.1058;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0270;  zR @ 50: 0.0486;  zR @ 100: 0.0824;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0213;  zR @ 50: 0.0319;  zR @ 100: 0.0916;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0524;  zR @ 50: 0.1006;  zR @ 100: 0.1292;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0130;  zR @ 50: 0.0390;  zR @ 100: 0.0390;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1362;  zR @ 50: 0.2176;  zR @ 100: 0.2932;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.0833;  zR @ 50: 0.2083;  zR @ 100: 0.2083;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1474;  zR @ 50: 0.1859;  zR @ 100: 0.2436;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.0000;  zR @ 50: 0.3333;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0400;  mR @ 50: 0.0528;  mR @ 100: 0.0609;  for mode=sgdet, type=Mean Recall.
(above:0.0178) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0362) (attached to:0.0000) (behind:0.1899) (belonging to:0.0000) (between:0.0000) (carrying:0.0811) (covered in:0.0000) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.3992) (holding:0.2391) (in:0.1329) (in front of:0.0073) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2134) (of:0.2290) (on:0.4390) (on back of:0.0000) (over:0.0000) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.2455) (says:0.0000) (sitting on:0.0576) (standing on:0.0000) (to:0.0000) (under:0.0612) (using:0.0769) (walking in:0.0000) (walking on:0.0018) (watching:0.0098) (wearing:0.5800) (wears:0.0000) (with:0.0254) 
====================================================================================================

2023-03-13 04:52:53,385 maskrcnn_benchmark INFO: Validation Result: 0.3313
2023-03-13 04:58:10,649 maskrcnn_benchmark INFO: eta: 2 days, 3:46:04  iter: 4200  loss: 0.5881 (0.8881)  ML Loss (cd): -0.2498 (-0.2445)  loss_refine_obj: 0.5622 (0.8436)  loss_rel: 0.2705 (0.2891)  time: 1.5524 (2.4586)  data: 0.0051 (0.8605)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 05:03:22,186 maskrcnn_benchmark INFO: eta: 2 days, 2:46:16  iter: 4400  loss: 0.7274 (0.8779)  ML Loss (cd): -0.2498 (-0.2447)  loss_refine_obj: 0.6744 (0.8337)  loss_rel: 0.2596 (0.2889)  time: 1.5444 (2.4177)  data: 0.0049 (0.8216)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 05:08:38,047 maskrcnn_benchmark INFO: eta: 2 days, 1:52:24  iter: 4600  loss: 0.6192 (0.8671)  ML Loss (cd): -0.2499 (-0.2450)  loss_refine_obj: 0.6079 (0.8240)  loss_rel: 0.2876 (0.2880)  time: 1.5982 (2.3812)  data: 0.0048 (0.7861)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 05:13:57,901 maskrcnn_benchmark INFO: eta: 2 days, 1:03:38  iter: 4800  loss: 0.6457 (0.8579)  ML Loss (cd): -0.2499 (-0.2452)  loss_refine_obj: 0.6069 (0.8151)  loss_rel: 0.2387 (0.2879)  time: 1.5795 (2.3486)  data: 0.0048 (0.7536)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 05:19:16,508 maskrcnn_benchmark INFO: eta: 2 days, 0:18:01  iter: 5000  loss: 0.6390 (0.8487)  ML Loss (cd): -0.2499 (-0.2453)  loss_refine_obj: 0.6420 (0.8068)  loss_rel: 0.2342 (0.2872)  time: 1.5760 (2.3184)  data: 0.0049 (0.7236)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 05:24:31,768 maskrcnn_benchmark INFO: eta: 1 day, 23:34:42  iter: 5200  loss: 0.5888 (0.8402)  ML Loss (cd): -0.2499 (-0.2455)  loss_refine_obj: 0.6119 (0.7989)  loss_rel: 0.2360 (0.2869)  time: 1.5875 (2.2899)  data: 0.0048 (0.6960)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 05:29:49,622 maskrcnn_benchmark INFO: eta: 1 day, 22:54:49  iter: 5400  loss: 0.5560 (0.8332)  ML Loss (cd): -0.2499 (-0.2457)  loss_refine_obj: 0.6156 (0.7922)  loss_rel: 0.2893 (0.2867)  time: 1.5658 (2.2639)  data: 0.0048 (0.6704)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 05:35:08,028 maskrcnn_benchmark INFO: eta: 1 day, 22:17:31  iter: 5600  loss: 0.7048 (0.8258)  ML Loss (cd): -0.2499 (-0.2458)  loss_refine_obj: 0.6318 (0.7853)  loss_rel: 0.2325 (0.2863)  time: 1.6134 (2.2399)  data: 0.0049 (0.6466)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 05:40:26,083 maskrcnn_benchmark INFO: eta: 1 day, 21:42:20  iter: 5800  loss: 0.6591 (0.8197)  ML Loss (cd): -0.2499 (-0.2460)  loss_refine_obj: 0.5943 (0.7794)  loss_rel: 0.3462 (0.2862)  time: 1.5274 (2.2175)  data: 0.0050 (0.6245)  energy lr: 0.002000  base lr : 0.002000  max mem: 4962
2023-03-13 05:45:41,335 maskrcnn_benchmark INFO: ---Total norm 0.01120 clip coef 446.34140-----------------
2023-03-13 05:45:41,505 maskrcnn_benchmark INFO: module.energy.2.bias                              : 0.00646, (torch.Size([1]))
2023-03-13 05:45:41,505 maskrcnn_benchmark INFO: module.energy.0.weight                            : 0.00411, (torch.Size([300, 600]))
2023-03-13 05:45:41,505 maskrcnn_benchmark INFO: module.energy.2.weight                            : 0.00380, (torch.Size([1, 300]))
2023-03-13 05:45:41,506 maskrcnn_benchmark INFO: module.energy.0.bias                              : 0.00352, (torch.Size([300]))
2023-03-13 05:45:41,506 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.weight            : 0.00333, (torch.Size([300, 600]))
2023-03-13 05:45:41,506 maskrcnn_benchmark INFO: module.obj_emdedding.weight                       : 0.00223, (torch.Size([300, 4096]))
2023-03-13 05:45:41,506 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_ih                 : 0.00204, (torch.Size([900]))
2023-03-13 05:45:41,506 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.bias                : 0.00189, (torch.Size([1]))
2023-03-13 05:45:41,506 maskrcnn_benchmark INFO: module.obj_label_embedding.weight                 : 0.00178, (torch.Size([300, 279]))
2023-03-13 05:45:41,506 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.weight              : 0.00155, (torch.Size([1, 300]))
2023-03-13 05:45:41,506 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.bias              : 0.00154, (torch.Size([300]))
2023-03-13 05:45:41,506 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.bias              : 0.00151, (torch.Size([300]))
2023-03-13 05:45:41,506 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_hh               : 0.00143, (torch.Size([900, 300]))
2023-03-13 05:45:41,506 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_hh                 : 0.00102, (torch.Size([900]))
2023-03-13 05:45:41,507 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_ih               : 0.00077, (torch.Size([900, 300]))
2023-03-13 05:45:41,507 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.weight              : 0.00057, (torch.Size([1, 300]))
2023-03-13 05:45:41,507 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.bias                : 0.00052, (torch.Size([1]))
2023-03-13 05:45:41,507 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.weight            : 0.00049, (torch.Size([300, 300]))
2023-03-13 05:45:41,507 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.bias           : 0.00046, (torch.Size([300]))
2023-03-13 05:45:41,507 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_hh               : 0.00045, (torch.Size([900, 300]))
2023-03-13 05:45:41,507 maskrcnn_benchmark INFO: module.obj_label_embedding.bias                   : 0.00041, (torch.Size([300]))
2023-03-13 05:45:41,507 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.bias           : 0.00039, (torch.Size([300]))
2023-03-13 05:45:41,507 maskrcnn_benchmark INFO: module.pos_embed.2.weight                         : 0.00035, (torch.Size([128, 32]))
2023-03-13 05:45:41,507 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_ih                 : 0.00035, (torch.Size([900]))
2023-03-13 05:45:41,507 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.weight         : 0.00024, (torch.Size([300, 300]))
2023-03-13 05:45:41,508 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.weight         : 0.00020, (torch.Size([300, 300]))
2023-03-13 05:45:41,508 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.bias           : 0.00019, (torch.Size([300]))
2023-03-13 05:45:41,508 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_hh                 : 0.00018, (torch.Size([900]))
2023-03-13 05:45:41,508 maskrcnn_benchmark INFO: module.pos_embed.0.weight                         : 0.00017, (torch.Size([32, 9]))
2023-03-13 05:45:41,508 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.bias           : 0.00017, (torch.Size([300]))
2023-03-13 05:45:41,508 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_ih               : 0.00016, (torch.Size([900, 300]))
2023-03-13 05:45:41,508 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.weight         : 0.00014, (torch.Size([300, 300]))
2023-03-13 05:45:41,508 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.bias                : 0.00014, (torch.Size([1]))
2023-03-13 05:45:41,508 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.bias                : 0.00013, (torch.Size([300]))
2023-03-13 05:45:41,508 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_hh               : 0.00009, (torch.Size([900, 300]))
2023-03-13 05:45:41,508 maskrcnn_benchmark INFO: module.pos_embed.2.bias                           : 0.00009, (torch.Size([128]))
2023-03-13 05:45:41,508 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_ih               : 0.00009, (torch.Size([900, 300]))
2023-03-13 05:45:41,509 maskrcnn_benchmark INFO: module.obj_emdedding.bias                         : 0.00007, (torch.Size([300]))
2023-03-13 05:45:41,509 maskrcnn_benchmark INFO: module.rel_label_embedding.weight                 : 0.00006, (torch.Size([300, 51]))
2023-03-13 05:45:41,509 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.weight              : 0.00006, (torch.Size([300, 300]))
2023-03-13 05:45:41,509 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.bias                : 0.00006, (torch.Size([300]))
2023-03-13 05:45:41,509 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.bias           : 0.00006, (torch.Size([300]))
2023-03-13 05:45:41,509 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.weight              : 0.00005, (torch.Size([1, 300]))
2023-03-13 05:45:41,509 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.weight         : 0.00005, (torch.Size([300, 600, 1, 1]))
2023-03-13 05:45:41,509 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.weight         : 0.00005, (torch.Size([300, 300, 1, 1]))
2023-03-13 05:45:41,509 maskrcnn_benchmark INFO: module.pos_embed.1.weight                         : 0.00004, (torch.Size([32]))
2023-03-13 05:45:41,509 maskrcnn_benchmark INFO: module.rel_label_embedding.bias                   : 0.00004, (torch.Size([300]))
2023-03-13 05:45:41,509 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.weight         : 0.00004, (torch.Size([300, 300]))
2023-03-13 05:45:41,510 maskrcnn_benchmark INFO: module.pos_embed.1.bias                           : 0.00004, (torch.Size([32]))
2023-03-13 05:45:41,510 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.bias           : 0.00002, (torch.Size([300]))
2023-03-13 05:45:41,510 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.weight              : 0.00002, (torch.Size([300, 300]))
2023-03-13 05:45:41,510 maskrcnn_benchmark INFO: module.pos_embed.0.bias                           : 0.00000, (torch.Size([32]))
2023-03-13 05:45:41,510 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 05:45:41,513 maskrcnn_benchmark INFO: ---Total norm 3.69664 clip coef 1.35258-----------------
2023-03-13 05:45:41,518 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 2.13099, (torch.Size([3072, 5136]))
2023-03-13 05:45:41,518 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 2.06233, (torch.Size([151, 512]))
2023-03-13 05:45:41,519 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.weight: 1.31959, (torch.Size([4096, 4096]))
2023-03-13 05:45:41,519 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.weight: 1.29884, (torch.Size([4096, 12544]))
2023-03-13 05:45:41,519 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.weight: 0.68325, (torch.Size([51, 4096]))
2023-03-13 05:45:41,519 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 0.59910, (torch.Size([4096, 12544]))
2023-03-13 05:45:41,519 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.42466, (torch.Size([4096, 4096]))
2023-03-13 05:45:41,519 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.31023, (torch.Size([512, 1024]))
2023-03-13 05:45:41,519 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.weight: 0.28057, (torch.Size([4096, 1024]))
2023-03-13 05:45:41,520 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.27030, (torch.Size([2560, 512]))
2023-03-13 05:45:41,520 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.23957, (torch.Size([256, 1024, 3, 3]))
2023-03-13 05:45:41,520 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.18484, (torch.Size([2048, 4808]))
2023-03-13 05:45:41,520 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.18254, (torch.Size([2048, 4808]))
2023-03-13 05:45:41,520 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.17607, (torch.Size([256, 128, 3, 3]))
2023-03-13 05:45:41,520 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.07329, (torch.Size([512, 1024]))
2023-03-13 05:45:41,520 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.07235, (torch.Size([128, 2, 7, 7]))
2023-03-13 05:45:41,520 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.07148, (torch.Size([151]))
2023-03-13 05:45:41,520 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.bias: 0.06839, (torch.Size([51]))
2023-03-13 05:45:41,520 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.05200, (torch.Size([512]))
2023-03-13 05:45:41,520 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.04762, (torch.Size([2048, 4424]))
2023-03-13 05:45:41,520 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.04643, (torch.Size([2048, 4424]))
2023-03-13 05:45:41,521 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.04069, (torch.Size([3072]))
2023-03-13 05:45:41,521 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.02470, (torch.Size([22801, 51]))
2023-03-13 05:45:41,521 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.01907, (torch.Size([2048, 512]))
2023-03-13 05:45:41,521 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.01875, (torch.Size([2048, 512]))
2023-03-13 05:45:41,521 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.01832, (torch.Size([128, 32]))
2023-03-13 05:45:41,521 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01607, (torch.Size([32, 9]))
2023-03-13 05:45:41,521 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.01484, (torch.Size([128]))
2023-03-13 05:45:41,521 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.bias: 0.01440, (torch.Size([4096]))
2023-03-13 05:45:41,521 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.weight: 0.01264, (torch.Size([1024, 512]))
2023-03-13 05:45:41,521 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.01088, (torch.Size([2560]))
2023-03-13 05:45:41,521 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.bias : 0.00895, (torch.Size([4096]))
2023-03-13 05:45:41,522 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.00874, (torch.Size([151, 200]))
2023-03-13 05:45:41,522 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.00856, (torch.Size([256]))
2023-03-13 05:45:41,522 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.00835, (torch.Size([4096]))
2023-03-13 05:45:41,522 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.00833, (torch.Size([512]))
2023-03-13 05:45:41,522 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.bias: 0.00714, (torch.Size([4096]))
2023-03-13 05:45:41,522 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00567, (torch.Size([2048, 512]))
2023-03-13 05:45:41,522 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.bias : 0.00546, (torch.Size([1024]))
2023-03-13 05:45:41,522 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00537, (torch.Size([2048, 512]))
2023-03-13 05:45:41,522 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00512, (torch.Size([152, 200]))
2023-03-13 05:45:41,522 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00490, (torch.Size([128]))
2023-03-13 05:45:41,522 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00455, (torch.Size([32]))
2023-03-13 05:45:41,522 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.00422, (torch.Size([2048]))
2023-03-13 05:45:41,523 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.00422, (torch.Size([2048]))
2023-03-13 05:45:41,523 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.00415, (torch.Size([2048]))
2023-03-13 05:45:41,523 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.00415, (torch.Size([2048]))
2023-03-13 05:45:41,523 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.00395, (torch.Size([128]))
2023-03-13 05:45:41,523 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00340, (torch.Size([256]))
2023-03-13 05:45:41,523 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00318, (torch.Size([256]))
2023-03-13 05:45:41,523 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00312, (torch.Size([4096]))
2023-03-13 05:45:41,523 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00248, (torch.Size([32]))
2023-03-13 05:45:41,523 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00224, (torch.Size([256]))
2023-03-13 05:45:41,523 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00154, (torch.Size([128]))
2023-03-13 05:45:41,523 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00125, (torch.Size([151, 200]))
2023-03-13 05:45:41,524 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00098, (torch.Size([2048]))
2023-03-13 05:45:41,524 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00098, (torch.Size([2048]))
2023-03-13 05:45:41,524 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00096, (torch.Size([2048]))
2023-03-13 05:45:41,524 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00096, (torch.Size([2048]))
2023-03-13 05:45:41,524 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-13 05:45:41,524 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 05:45:41,528 maskrcnn_benchmark INFO: eta: 1 day, 21:08:37  iter: 6000  loss: 0.5950 (0.8129)  ML Loss (cd): -0.2499 (-0.2461)  loss_refine_obj: 0.6029 (0.7734)  loss_rel: 0.2274 (0.2855)  time: 1.5088 (2.1962)  data: 0.0048 (0.6038)  energy lr: 0.002000  base lr : 0.002000  max mem: 4979
2023-03-13 05:45:41,531 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi/model_0006000.pth
2023-03-13 05:46:15,769 maskrcnn_benchmark INFO: Start validating
2023-03-13 05:46:15,796 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-13 06:10:57,310 maskrcnn_benchmark INFO: Total run time: 0:24:41.513190 (0.5926052760124206 s / img per device, on 2 devices)
2023-03-13 06:10:57,311 maskrcnn_benchmark INFO: Model inference time: 0:20:00.326729 (0.48013069162368777 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(249987, 7)
0/249987
DONE (t=1.50s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=30.94s).
Accumulating evaluation results...
DONE (t=6.76s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.147
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.282
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.137
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.065
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.108
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.186
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.220
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.318
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.320
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.268
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.352
2023-03-13 06:15:35,619 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2819
====================================================================================================
SGG eval:   R @ 20: 0.2279;   R @ 50: 0.2941;   R @ 100: 0.3310;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2339; ngR @ 50: 0.3127; ngR @ 100: 0.3743;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0085;  zR @ 50: 0.0180;  zR @ 100: 0.0342;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0120;  zR @ 50: 0.0240;  zR @ 100: 0.0330;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0147;  zR @ 50: 0.0330;  zR @ 100: 0.0549;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0193;  zR @ 50: 0.0236;  zR @ 100: 0.0579;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0278;  zR @ 50: 0.0431;  zR @ 100: 0.0716;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0427;  zR @ 50: 0.0598;  zR @ 100: 0.0761;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0278;  zR @ 50: 0.0562;  zR @ 100: 0.0746;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0182;  zR @ 50: 0.0318;  zR @ 100: 0.0394;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0468;  zR @ 50: 0.1043;  zR @ 100: 0.1201;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0351;  zR @ 50: 0.0689;  zR @ 100: 0.0689;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0426;  zR @ 50: 0.0771;  zR @ 100: 0.0996;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0607;  zR @ 50: 0.1363;  zR @ 100: 0.1435;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0260;  zR @ 50: 0.0260;  zR @ 100: 0.0260;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1478;  zR @ 50: 0.2409;  zR @ 100: 0.3048;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.0625;  zR @ 50: 0.1667;  zR @ 100: 0.2083;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1474;  zR @ 50: 0.1474;  zR @ 100: 0.1859;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.0000;  zR @ 50: 0.6667;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0475;  mR @ 50: 0.0630;  mR @ 100: 0.0725;  for mode=sgdet, type=Mean Recall.
(above:0.0129) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0202) (attached to:0.0000) (behind:0.1655) (belonging to:0.0000) (between:0.0000) (carrying:0.1930) (covered in:0.0000) (covering:0.0000) (eating:0.2143) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.3821) (holding:0.2085) (in:0.1414) (in front of:0.0090) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2477) (of:0.2191) (on:0.4327) (on back of:0.0000) (over:0.0000) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.3943) (says:0.0000) (sitting on:0.1091) (standing on:0.0000) (to:0.0000) (under:0.0527) (using:0.1538) (walking in:0.0000) (walking on:0.0527) (watching:0.0098) (wearing:0.5819) (wears:0.0000) (with:0.0218) 
====================================================================================================

2023-03-13 06:15:36,588 maskrcnn_benchmark INFO: Validation Result: 0.3310
2023-03-13 06:20:54,411 maskrcnn_benchmark INFO: eta: 2 days, 2:33:20  iter: 6200  loss: 0.5822 (0.8073)  ML Loss (cd): -0.2499 (-0.2462)  loss_refine_obj: 0.5770 (0.7679)  loss_rel: 0.2088 (0.2855)  time: 1.6526 (2.4661)  data: 0.0050 (0.8741)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 06:26:19,207 maskrcnn_benchmark INFO: eta: 2 days, 1:52:50  iter: 6400  loss: 0.5794 (0.8013)  ML Loss (cd): -0.2499 (-0.2463)  loss_refine_obj: 0.5650 (0.7628)  loss_rel: 0.2714 (0.2848)  time: 1.5714 (2.4398)  data: 0.0051 (0.8469)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 06:31:44,566 maskrcnn_benchmark INFO: eta: 2 days, 1:14:34  iter: 6600  loss: 0.5998 (0.7956)  ML Loss (cd): -0.2499 (-0.2464)  loss_refine_obj: 0.5988 (0.7577)  loss_rel: 0.2853 (0.2843)  time: 1.6184 (2.4152)  data: 0.0049 (0.8214)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 06:37:05,982 maskrcnn_benchmark INFO: eta: 2 days, 0:37:31  iter: 6800  loss: 0.6054 (0.7909)  ML Loss (cd): -0.2499 (-0.2465)  loss_refine_obj: 0.6034 (0.7533)  loss_rel: 0.2585 (0.2841)  time: 1.5837 (2.3914)  data: 0.0049 (0.7974)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 06:42:24,611 maskrcnn_benchmark INFO: eta: 2 days, 0:01:47  iter: 7000  loss: 0.5955 (0.7859)  ML Loss (cd): -0.2499 (-0.2466)  loss_refine_obj: 0.5968 (0.7492)  loss_rel: 0.2227 (0.2834)  time: 1.6224 (2.3686)  data: 0.0048 (0.7747)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 06:47:51,254 maskrcnn_benchmark INFO: eta: 1 day, 23:29:07  iter: 7200  loss: 0.6175 (0.7813)  ML Loss (cd): -0.2499 (-0.2467)  loss_refine_obj: 0.5900 (0.7449)  loss_rel: 0.2464 (0.2831)  time: 1.6714 (2.3482)  data: 0.0048 (0.7534)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 06:53:14,710 maskrcnn_benchmark INFO: eta: 1 day, 22:57:23  iter: 7400  loss: 0.5314 (0.7771)  ML Loss (cd): -0.2499 (-0.2468)  loss_refine_obj: 0.5505 (0.7410)  loss_rel: 0.2383 (0.2829)  time: 1.5654 (2.3284)  data: 0.0048 (0.7331)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 06:58:38,960 maskrcnn_benchmark INFO: eta: 1 day, 22:27:10  iter: 7600  loss: 0.6155 (0.7730)  ML Loss (cd): -0.2499 (-0.2469)  loss_refine_obj: 0.6152 (0.7373)  loss_rel: 0.2400 (0.2826)  time: 1.6671 (2.3098)  data: 0.0048 (0.7140)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 07:04:00,304 maskrcnn_benchmark INFO: eta: 1 day, 21:57:46  iter: 7800  loss: 0.6382 (0.7694)  ML Loss (cd): -0.2499 (-0.2470)  loss_refine_obj: 0.6392 (0.7339)  loss_rel: 0.2715 (0.2825)  time: 1.5520 (2.2918)  data: 0.0048 (0.6958)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 07:09:18,353 maskrcnn_benchmark INFO: ---Total norm 0.04224 clip coef 118.37849-----------------
2023-03-13 07:09:18,618 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.weight            : 0.01859, (torch.Size([300, 600]))
2023-03-13 07:09:18,618 maskrcnn_benchmark INFO: module.energy.0.weight                            : 0.01748, (torch.Size([300, 600]))
2023-03-13 07:09:18,618 maskrcnn_benchmark INFO: module.energy.2.weight                            : 0.01555, (torch.Size([1, 300]))
2023-03-13 07:09:18,623 maskrcnn_benchmark INFO: module.energy.2.bias                              : 0.01467, (torch.Size([1]))
2023-03-13 07:09:18,623 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_ih                 : 0.01259, (torch.Size([900]))
2023-03-13 07:09:18,623 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.bias                : 0.01108, (torch.Size([1]))
2023-03-13 07:09:18,623 maskrcnn_benchmark INFO: module.obj_label_embedding.weight                 : 0.01036, (torch.Size([300, 279]))
2023-03-13 07:09:18,623 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.weight              : 0.00840, (torch.Size([1, 300]))
2023-03-13 07:09:18,623 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_hh               : 0.00794, (torch.Size([900, 300]))
2023-03-13 07:09:18,624 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_hh                 : 0.00630, (torch.Size([900]))
2023-03-13 07:09:18,624 maskrcnn_benchmark INFO: module.energy.0.bias                              : 0.00540, (torch.Size([300]))
2023-03-13 07:09:18,624 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_ih               : 0.00511, (torch.Size([900, 300]))
2023-03-13 07:09:18,624 maskrcnn_benchmark INFO: module.obj_emdedding.weight                       : 0.00392, (torch.Size([300, 4096]))
2023-03-13 07:09:18,624 maskrcnn_benchmark INFO: module.obj_label_embedding.bias                   : 0.00261, (torch.Size([300]))
2023-03-13 07:09:18,624 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.bias              : 0.00243, (torch.Size([300]))
2023-03-13 07:09:18,624 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.bias           : 0.00242, (torch.Size([300]))
2023-03-13 07:09:18,624 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.bias              : 0.00226, (torch.Size([300]))
2023-03-13 07:09:18,624 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.bias           : 0.00222, (torch.Size([300]))
2023-03-13 07:09:18,624 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.weight         : 0.00168, (torch.Size([300, 300]))
2023-03-13 07:09:18,625 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.weight            : 0.00123, (torch.Size([300, 300]))
2023-03-13 07:09:18,625 maskrcnn_benchmark INFO: module.pos_embed.2.weight                         : 0.00118, (torch.Size([128, 32]))
2023-03-13 07:09:18,625 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.weight         : 0.00114, (torch.Size([300, 300]))
2023-03-13 07:09:18,625 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.weight         : 0.00113, (torch.Size([300, 300]))
2023-03-13 07:09:18,625 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.bias           : 0.00098, (torch.Size([300]))
2023-03-13 07:09:18,625 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.bias           : 0.00093, (torch.Size([300]))
2023-03-13 07:09:18,625 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_hh               : 0.00078, (torch.Size([900, 300]))
2023-03-13 07:09:18,625 maskrcnn_benchmark INFO: module.pos_embed.0.weight                         : 0.00072, (torch.Size([32, 9]))
2023-03-13 07:09:18,625 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_ih                 : 0.00067, (torch.Size([900]))
2023-03-13 07:09:18,625 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_hh               : 0.00065, (torch.Size([900, 300]))
2023-03-13 07:09:18,626 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.weight              : 0.00064, (torch.Size([1, 300]))
2023-03-13 07:09:18,626 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_ih               : 0.00054, (torch.Size([900, 300]))
2023-03-13 07:09:18,626 maskrcnn_benchmark INFO: module.rel_label_embedding.weight                 : 0.00049, (torch.Size([300, 51]))
2023-03-13 07:09:18,626 maskrcnn_benchmark INFO: module.pos_embed.2.bias                           : 0.00043, (torch.Size([128]))
2023-03-13 07:09:18,626 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.weight         : 0.00041, (torch.Size([300, 300]))
2023-03-13 07:09:18,626 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.bias           : 0.00038, (torch.Size([300]))
2023-03-13 07:09:18,626 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_hh                 : 0.00034, (torch.Size([900]))
2023-03-13 07:09:18,626 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_ih               : 0.00033, (torch.Size([900, 300]))
2023-03-13 07:09:18,626 maskrcnn_benchmark INFO: module.rel_label_embedding.bias                   : 0.00030, (torch.Size([300]))
2023-03-13 07:09:18,626 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.weight         : 0.00029, (torch.Size([300, 300, 1, 1]))
2023-03-13 07:09:18,626 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.bias                : 0.00028, (torch.Size([300]))
2023-03-13 07:09:18,627 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.weight         : 0.00026, (torch.Size([300, 600, 1, 1]))
2023-03-13 07:09:18,627 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.bias                : 0.00023, (torch.Size([1]))
2023-03-13 07:09:18,627 maskrcnn_benchmark INFO: module.pos_embed.1.bias                           : 0.00017, (torch.Size([32]))
2023-03-13 07:09:18,627 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.weight              : 0.00017, (torch.Size([300, 300]))
2023-03-13 07:09:18,627 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.bias           : 0.00013, (torch.Size([300]))
2023-03-13 07:09:18,627 maskrcnn_benchmark INFO: module.obj_emdedding.bias                         : 0.00012, (torch.Size([300]))
2023-03-13 07:09:18,627 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.bias                : 0.00011, (torch.Size([300]))
2023-03-13 07:09:18,627 maskrcnn_benchmark INFO: module.pos_embed.1.weight                         : 0.00011, (torch.Size([32]))
2023-03-13 07:09:18,627 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.bias                : 0.00010, (torch.Size([1]))
2023-03-13 07:09:18,628 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.weight              : 0.00009, (torch.Size([300, 300]))
2023-03-13 07:09:18,628 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.weight              : 0.00007, (torch.Size([1, 300]))
2023-03-13 07:09:18,628 maskrcnn_benchmark INFO: module.pos_embed.0.bias                           : 0.00000, (torch.Size([32]))
2023-03-13 07:09:18,628 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 07:09:18,639 maskrcnn_benchmark INFO: ---Total norm 4.03664 clip coef 1.23865-----------------
2023-03-13 07:09:18,647 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 2.11032, (torch.Size([151, 512]))
2023-03-13 07:09:18,647 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 1.92858, (torch.Size([3072, 5136]))
2023-03-13 07:09:18,647 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 1.30704, (torch.Size([4096, 12544]))
2023-03-13 07:09:18,648 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.weight: 1.27058, (torch.Size([4096, 4096]))
2023-03-13 07:09:18,648 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.weight: 1.20104, (torch.Size([4096, 12544]))
2023-03-13 07:09:18,648 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.weight: 1.10455, (torch.Size([51, 4096]))
2023-03-13 07:09:18,648 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.77998, (torch.Size([4096, 4096]))
2023-03-13 07:09:18,648 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.62185, (torch.Size([256, 1024, 3, 3]))
2023-03-13 07:09:18,648 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.52477, (torch.Size([256, 128, 3, 3]))
2023-03-13 07:09:18,648 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.46945, (torch.Size([512, 1024]))
2023-03-13 07:09:18,649 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.weight: 0.46760, (torch.Size([4096, 1024]))
2023-03-13 07:09:18,649 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.37461, (torch.Size([128, 2, 7, 7]))
2023-03-13 07:09:18,649 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.30460, (torch.Size([2048, 4808]))
2023-03-13 07:09:18,649 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.29366, (torch.Size([2048, 4808]))
2023-03-13 07:09:18,649 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.25095, (torch.Size([2560, 512]))
2023-03-13 07:09:18,649 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.10501, (torch.Size([151]))
2023-03-13 07:09:18,650 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.07854, (torch.Size([512, 1024]))
2023-03-13 07:09:18,650 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.07287, (torch.Size([512]))
2023-03-13 07:09:18,650 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.bias: 0.06571, (torch.Size([51]))
2023-03-13 07:09:18,650 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.06211, (torch.Size([128]))
2023-03-13 07:09:18,650 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.04921, (torch.Size([2048, 4424]))
2023-03-13 07:09:18,650 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.04912, (torch.Size([2048, 4424]))
2023-03-13 07:09:18,650 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.04843, (torch.Size([3072]))
2023-03-13 07:09:18,650 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.03893, (torch.Size([22801, 51]))
2023-03-13 07:09:18,650 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.03038, (torch.Size([2048, 512]))
2023-03-13 07:09:18,651 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.03018, (torch.Size([2048, 512]))
2023-03-13 07:09:18,651 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.weight: 0.02033, (torch.Size([1024, 512]))
2023-03-13 07:09:18,651 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.02031, (torch.Size([128, 32]))
2023-03-13 07:09:18,651 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.01668, (torch.Size([128]))
2023-03-13 07:09:18,651 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.01617, (torch.Size([256]))
2023-03-13 07:09:18,651 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.01534, (torch.Size([4096]))
2023-03-13 07:09:18,651 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01445, (torch.Size([32, 9]))
2023-03-13 07:09:18,651 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.bias: 0.01391, (torch.Size([4096]))
2023-03-13 07:09:18,651 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.01292, (torch.Size([2560]))
2023-03-13 07:09:18,652 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.bias : 0.01267, (torch.Size([4096]))
2023-03-13 07:09:18,653 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.01130, (torch.Size([512]))
2023-03-13 07:09:18,653 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.01119, (torch.Size([151, 200]))
2023-03-13 07:09:18,653 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00838, (torch.Size([256]))
2023-03-13 07:09:18,653 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.bias : 0.00784, (torch.Size([1024]))
2023-03-13 07:09:18,653 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.00704, (torch.Size([2048]))
2023-03-13 07:09:18,653 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.00704, (torch.Size([2048]))
2023-03-13 07:09:18,653 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00702, (torch.Size([256]))
2023-03-13 07:09:18,653 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.00697, (torch.Size([2048]))
2023-03-13 07:09:18,654 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.00697, (torch.Size([2048]))
2023-03-13 07:09:18,654 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00674, (torch.Size([256]))
2023-03-13 07:09:18,654 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00638, (torch.Size([128]))
2023-03-13 07:09:18,654 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.bias: 0.00635, (torch.Size([4096]))
2023-03-13 07:09:18,654 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00630, (torch.Size([2048, 512]))
2023-03-13 07:09:18,654 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00610, (torch.Size([2048, 512]))
2023-03-13 07:09:18,654 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00577, (torch.Size([4096]))
2023-03-13 07:09:18,654 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00470, (torch.Size([152, 200]))
2023-03-13 07:09:18,654 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00450, (torch.Size([32]))
2023-03-13 07:09:18,654 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00411, (torch.Size([32]))
2023-03-13 07:09:18,655 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00406, (torch.Size([128]))
2023-03-13 07:09:18,655 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00239, (torch.Size([151, 200]))
2023-03-13 07:09:18,655 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00132, (torch.Size([2048]))
2023-03-13 07:09:18,655 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00132, (torch.Size([2048]))
2023-03-13 07:09:18,655 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00131, (torch.Size([2048]))
2023-03-13 07:09:18,655 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00131, (torch.Size([2048]))
2023-03-13 07:09:18,655 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-13 07:09:18,655 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 07:09:18,661 maskrcnn_benchmark INFO: eta: 1 day, 21:29:08  iter: 8000  loss: 0.5478 (0.7656)  ML Loss (cd): -0.2499 (-0.2470)  loss_refine_obj: 0.5797 (0.7302)  loss_rel: 0.2413 (0.2824)  time: 1.5935 (2.2743)  data: 0.0047 (0.6785)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 07:09:18,664 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi/model_0008000.pth
2023-03-13 07:10:07,100 maskrcnn_benchmark INFO: Start validating
2023-03-13 07:10:07,122 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-13 07:34:36,163 maskrcnn_benchmark INFO: Total run time: 0:24:29.040996 (0.5876163984298706 s / img per device, on 2 devices)
2023-03-13 07:34:36,164 maskrcnn_benchmark INFO: Model inference time: 0:21:00.211418 (0.5040845673561096 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(249987, 7)
0/249987
DONE (t=1.72s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=30.96s).
Accumulating evaluation results...
DONE (t=6.77s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.283
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.136
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.063
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.110
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.185
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.219
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.319
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.321
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.161
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.268
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.353
2023-03-13 07:39:14,995 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2829
====================================================================================================
SGG eval:   R @ 20: 0.2332;   R @ 50: 0.3013;   R @ 100: 0.3397;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2407; ngR @ 50: 0.3284; ngR @ 100: 0.3856;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0063;  zR @ 100: 0.0190;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0075;  zR @ 50: 0.0165;  zR @ 100: 0.0295;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0147;  zR @ 50: 0.0366;  zR @ 100: 0.0513;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0150;  zR @ 50: 0.0150;  zR @ 100: 0.0408;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0256;  zR @ 50: 0.0387;  zR @ 100: 0.0748;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0205;  zR @ 50: 0.0632;  zR @ 100: 0.0970;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0151;  zR @ 50: 0.0460;  zR @ 100: 0.0709;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0131;  zR @ 50: 0.0308;  zR @ 100: 0.0328;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0576;  zR @ 50: 0.0935;  zR @ 100: 0.1022;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0216;  zR @ 50: 0.0419;  zR @ 100: 0.0554;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0319;  zR @ 50: 0.0437;  zR @ 100: 0.0943;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0577;  zR @ 50: 0.1030;  zR @ 100: 0.1423;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0130;  zR @ 50: 0.0260;  zR @ 100: 0.0260;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1711;  zR @ 50: 0.2583;  zR @ 100: 0.2990;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.1042;  zR @ 50: 0.1875;  zR @ 100: 0.1875;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1474;  zR @ 50: 0.1474;  zR @ 100: 0.1859;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.3333;  zR @ 50: 0.6667;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0429;  mR @ 50: 0.0589;  mR @ 100: 0.0695;  for mode=sgdet, type=Mean Recall.
(above:0.0158) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.2661) (attached to:0.0000) (behind:0.1201) (belonging to:0.0000) (between:0.0000) (carrying:0.0197) (covered in:0.0000) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.4166) (holding:0.2646) (in:0.1393) (in front of:0.0526) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2040) (of:0.2050) (on:0.4521) (on back of:0.0000) (over:0.0000) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.2991) (says:0.0000) (sitting on:0.0908) (standing on:0.0000) (to:0.0000) (under:0.0906) (using:0.0769) (walking in:0.0000) (walking on:0.0721) (watching:0.0784) (wearing:0.5927) (wears:0.0000) (with:0.0193) 
====================================================================================================

2023-03-13 07:39:15,989 maskrcnn_benchmark INFO: Validation Result: 0.3397
2023-03-13 07:44:08,211 maskrcnn_benchmark INFO: eta: 2 days, 1:20:07  iter: 8200  loss: 0.5563 (0.7621)  ML Loss (cd): -0.2499 (-0.2471)  loss_refine_obj: 0.5782 (0.7271)  loss_rel: 0.2098 (0.2821)  time: 1.4528 (2.4736)  data: 0.0050 (0.8813)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 07:49:03,116 maskrcnn_benchmark INFO: eta: 2 days, 0:43:29  iter: 8400  loss: 0.6647 (0.7593)  ML Loss (cd): -0.2499 (-0.2472)  loss_refine_obj: 0.6299 (0.7243)  loss_rel: 0.3007 (0.2822)  time: 1.4747 (2.4498)  data: 0.0051 (0.8604)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 07:53:56,555 maskrcnn_benchmark INFO: eta: 2 days, 0:08:07  iter: 8600  loss: 0.6676 (0.7560)  ML Loss (cd): -0.2499 (-0.2472)  loss_refine_obj: 0.6324 (0.7213)  loss_rel: 0.2335 (0.2820)  time: 1.4691 (2.4270)  data: 0.0050 (0.8405)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 07:58:52,333 maskrcnn_benchmark INFO: eta: 1 day, 23:34:27  iter: 8800  loss: 0.5876 (0.7530)  ML Loss (cd): -0.2499 (-0.2473)  loss_refine_obj: 0.5709 (0.7185)  loss_rel: 0.2454 (0.2818)  time: 1.4846 (2.4054)  data: 0.0051 (0.8215)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 08:03:48,024 maskrcnn_benchmark INFO: eta: 1 day, 23:02:04  iter: 9000  loss: 0.5573 (0.7499)  ML Loss (cd): -0.2500 (-0.2474)  loss_refine_obj: 0.5787 (0.7158)  loss_rel: 0.2546 (0.2814)  time: 1.4620 (2.3848)  data: 0.0049 (0.8034)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 08:08:42,056 maskrcnn_benchmark INFO: eta: 1 day, 22:30:39  iter: 9200  loss: 0.5860 (0.7470)  ML Loss (cd): -0.2499 (-0.2474)  loss_refine_obj: 0.5602 (0.7132)  loss_rel: 0.2536 (0.2812)  time: 1.4631 (2.3650)  data: 0.0049 (0.7860)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 08:13:38,234 maskrcnn_benchmark INFO: eta: 1 day, 22:00:38  iter: 9400  loss: 0.5628 (0.7436)  ML Loss (cd): -0.2500 (-0.2475)  loss_refine_obj: 0.5840 (0.7104)  loss_rel: 0.2076 (0.2807)  time: 1.5090 (2.3462)  data: 0.0048 (0.7694)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 08:18:37,362 maskrcnn_benchmark INFO: eta: 1 day, 21:32:01  iter: 9600  loss: 0.5633 (0.7410)  ML Loss (cd): -0.2499 (-0.2475)  loss_refine_obj: 0.5685 (0.7080)  loss_rel: 0.2872 (0.2805)  time: 1.4824 (2.3284)  data: 0.0049 (0.7535)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 08:23:36,531 maskrcnn_benchmark INFO: eta: 1 day, 21:04:23  iter: 9800  loss: 0.5398 (0.7383)  ML Loss (cd): -0.2499 (-0.2476)  loss_refine_obj: 0.5278 (0.7056)  loss_rel: 0.2932 (0.2803)  time: 1.4556 (2.3114)  data: 0.0050 (0.7382)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 08:28:39,836 maskrcnn_benchmark INFO: ---Total norm 0.04463 clip coef 112.02936-----------------
2023-03-13 08:28:40,100 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.weight            : 0.02041, (torch.Size([300, 600]))
2023-03-13 08:28:40,100 maskrcnn_benchmark INFO: module.energy.0.weight                            : 0.01921, (torch.Size([300, 600]))
2023-03-13 08:28:40,100 maskrcnn_benchmark INFO: module.energy.2.weight                            : 0.01617, (torch.Size([1, 300]))
2023-03-13 08:28:40,101 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_ih                 : 0.01365, (torch.Size([900]))
2023-03-13 08:28:40,101 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.bias                : 0.01312, (torch.Size([1]))
2023-03-13 08:28:40,102 maskrcnn_benchmark INFO: module.energy.2.bias                              : 0.01171, (torch.Size([1]))
2023-03-13 08:28:40,102 maskrcnn_benchmark INFO: module.obj_label_embedding.weight                 : 0.01076, (torch.Size([300, 279]))
2023-03-13 08:28:40,102 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.weight              : 0.00974, (torch.Size([1, 300]))
2023-03-13 08:28:40,102 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_hh               : 0.00854, (torch.Size([900, 300]))
2023-03-13 08:28:40,102 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_hh                 : 0.00683, (torch.Size([900]))
2023-03-13 08:28:40,102 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_ih               : 0.00546, (torch.Size([900, 300]))
2023-03-13 08:28:40,102 maskrcnn_benchmark INFO: module.obj_emdedding.weight                       : 0.00492, (torch.Size([300, 4096]))
2023-03-13 08:28:40,102 maskrcnn_benchmark INFO: module.energy.0.bias                              : 0.00443, (torch.Size([300]))
2023-03-13 08:28:40,102 maskrcnn_benchmark INFO: module.obj_label_embedding.bias                   : 0.00276, (torch.Size([300]))
2023-03-13 08:28:40,102 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.bias           : 0.00262, (torch.Size([300]))
2023-03-13 08:28:40,102 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.bias           : 0.00240, (torch.Size([300]))
2023-03-13 08:28:40,103 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.bias              : 0.00193, (torch.Size([300]))
2023-03-13 08:28:40,103 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.bias              : 0.00190, (torch.Size([300]))
2023-03-13 08:28:40,103 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.weight         : 0.00172, (torch.Size([300, 300]))
2023-03-13 08:28:40,103 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.weight              : 0.00131, (torch.Size([1, 300]))
2023-03-13 08:28:40,103 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.bias                : 0.00124, (torch.Size([1]))
2023-03-13 08:28:40,103 maskrcnn_benchmark INFO: module.pos_embed.2.weight                         : 0.00118, (torch.Size([128, 32]))
2023-03-13 08:28:40,103 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.weight         : 0.00116, (torch.Size([300, 300]))
2023-03-13 08:28:40,103 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.weight            : 0.00113, (torch.Size([300, 300]))
2023-03-13 08:28:40,103 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.weight         : 0.00112, (torch.Size([300, 300]))
2023-03-13 08:28:40,103 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.bias           : 0.00110, (torch.Size([300]))
2023-03-13 08:28:40,104 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.bias           : 0.00101, (torch.Size([300]))
2023-03-13 08:28:40,104 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_hh               : 0.00100, (torch.Size([900, 300]))
2023-03-13 08:28:40,104 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_ih                 : 0.00084, (torch.Size([900]))
2023-03-13 08:28:40,104 maskrcnn_benchmark INFO: module.pos_embed.0.weight                         : 0.00059, (torch.Size([32, 9]))
2023-03-13 08:28:40,104 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_hh               : 0.00053, (torch.Size([900, 300]))
2023-03-13 08:28:40,104 maskrcnn_benchmark INFO: module.pos_embed.2.bias                           : 0.00046, (torch.Size([128]))
2023-03-13 08:28:40,104 maskrcnn_benchmark INFO: module.rel_label_embedding.weight                 : 0.00046, (torch.Size([300, 51]))
2023-03-13 08:28:40,104 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_ih               : 0.00043, (torch.Size([900, 300]))
2023-03-13 08:28:40,104 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_hh                 : 0.00042, (torch.Size([900]))
2023-03-13 08:28:40,104 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_ih               : 0.00037, (torch.Size([900, 300]))
2023-03-13 08:28:40,104 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.bias                : 0.00032, (torch.Size([300]))
2023-03-13 08:28:40,105 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.bias           : 0.00031, (torch.Size([300]))
2023-03-13 08:28:40,105 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.weight         : 0.00029, (torch.Size([300, 300]))
2023-03-13 08:28:40,105 maskrcnn_benchmark INFO: module.rel_label_embedding.bias                   : 0.00028, (torch.Size([300]))
2023-03-13 08:28:40,105 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.weight         : 0.00022, (torch.Size([300, 300, 1, 1]))
2023-03-13 08:28:40,106 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.weight         : 0.00021, (torch.Size([300, 600, 1, 1]))
2023-03-13 08:28:40,106 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.bias                : 0.00020, (torch.Size([1]))
2023-03-13 08:28:40,106 maskrcnn_benchmark INFO: module.pos_embed.1.bias                           : 0.00017, (torch.Size([32]))
2023-03-13 08:28:40,106 maskrcnn_benchmark INFO: module.obj_emdedding.bias                         : 0.00016, (torch.Size([300]))
2023-03-13 08:28:40,106 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.weight              : 0.00015, (torch.Size([300, 300]))
2023-03-13 08:28:40,106 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.bias                : 0.00014, (torch.Size([300]))
2023-03-13 08:28:40,106 maskrcnn_benchmark INFO: module.pos_embed.1.weight                         : 0.00011, (torch.Size([32]))
2023-03-13 08:28:40,106 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.bias           : 0.00010, (torch.Size([300]))
2023-03-13 08:28:40,106 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.weight              : 0.00010, (torch.Size([1, 300]))
2023-03-13 08:28:40,106 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.weight              : 0.00007, (torch.Size([300, 300]))
2023-03-13 08:28:40,106 maskrcnn_benchmark INFO: module.pos_embed.0.bias                           : 0.00000, (torch.Size([32]))
2023-03-13 08:28:40,107 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 08:28:40,113 maskrcnn_benchmark INFO: ---Total norm 2.86592 clip coef 1.74464-----------------
2023-03-13 08:28:40,119 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.60320, (torch.Size([151, 512]))
2023-03-13 08:28:40,119 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 1.55794, (torch.Size([3072, 5136]))
2023-03-13 08:28:40,119 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.weight: 1.05088, (torch.Size([4096, 4096]))
2023-03-13 08:28:40,119 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.weight: 1.01069, (torch.Size([4096, 12544]))
2023-03-13 08:28:40,119 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 0.54620, (torch.Size([4096, 12544]))
2023-03-13 08:28:40,119 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.weight: 0.54433, (torch.Size([51, 4096]))
2023-03-13 08:28:40,119 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.36247, (torch.Size([4096, 4096]))
2023-03-13 08:28:40,119 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.28470, (torch.Size([512, 1024]))
2023-03-13 08:28:40,120 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.weight: 0.25891, (torch.Size([4096, 1024]))
2023-03-13 08:28:40,121 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.23145, (torch.Size([256, 1024, 3, 3]))
2023-03-13 08:28:40,121 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.20429, (torch.Size([2560, 512]))
2023-03-13 08:28:40,121 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.18289, (torch.Size([2048, 4808]))
2023-03-13 08:28:40,121 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.17673, (torch.Size([256, 128, 3, 3]))
2023-03-13 08:28:40,121 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.16892, (torch.Size([2048, 4808]))
2023-03-13 08:28:40,121 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.08715, (torch.Size([128, 2, 7, 7]))
2023-03-13 08:28:40,121 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.06907, (torch.Size([151]))
2023-03-13 08:28:40,121 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.05656, (torch.Size([512, 1024]))
2023-03-13 08:28:40,121 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.05107, (torch.Size([512]))
2023-03-13 08:28:40,121 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.bias: 0.04824, (torch.Size([51]))
2023-03-13 08:28:40,121 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.03778, (torch.Size([2048, 4424]))
2023-03-13 08:28:40,122 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.03687, (torch.Size([3072]))
2023-03-13 08:28:40,122 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.03477, (torch.Size([2048, 4424]))
2023-03-13 08:28:40,122 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.02334, (torch.Size([22801, 51]))
2023-03-13 08:28:40,122 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.02192, (torch.Size([128, 32]))
2023-03-13 08:28:40,122 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.01969, (torch.Size([2048, 512]))
2023-03-13 08:28:40,122 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.01748, (torch.Size([2048, 512]))
2023-03-13 08:28:40,122 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01435, (torch.Size([32, 9]))
2023-03-13 08:28:40,122 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.bias: 0.01237, (torch.Size([4096]))
2023-03-13 08:28:40,122 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.weight: 0.01164, (torch.Size([1024, 512]))
2023-03-13 08:28:40,122 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.01156, (torch.Size([128]))
2023-03-13 08:28:40,123 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.00907, (torch.Size([2560]))
2023-03-13 08:28:40,123 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.00884, (torch.Size([151, 200]))
2023-03-13 08:28:40,123 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.00835, (torch.Size([512]))
2023-03-13 08:28:40,123 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.bias : 0.00831, (torch.Size([4096]))
2023-03-13 08:28:40,123 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.00807, (torch.Size([4096]))
2023-03-13 08:28:40,123 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.00720, (torch.Size([256]))
2023-03-13 08:28:40,123 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.bias: 0.00628, (torch.Size([4096]))
2023-03-13 08:28:40,123 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.bias : 0.00522, (torch.Size([1024]))
2023-03-13 08:28:40,123 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.00504, (torch.Size([2048]))
2023-03-13 08:28:40,123 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.00504, (torch.Size([2048]))
2023-03-13 08:28:40,124 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.00498, (torch.Size([128]))
2023-03-13 08:28:40,124 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00488, (torch.Size([2048, 512]))
2023-03-13 08:28:40,124 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.00461, (torch.Size([2048]))
2023-03-13 08:28:40,124 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.00461, (torch.Size([2048]))
2023-03-13 08:28:40,124 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00444, (torch.Size([128]))
2023-03-13 08:28:40,124 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00431, (torch.Size([2048, 512]))
2023-03-13 08:28:40,124 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00398, (torch.Size([32]))
2023-03-13 08:28:40,124 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00368, (torch.Size([152, 200]))
2023-03-13 08:28:40,124 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00295, (torch.Size([256]))
2023-03-13 08:28:40,124 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00283, (torch.Size([256]))
2023-03-13 08:28:40,124 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00273, (torch.Size([4096]))
2023-03-13 08:28:40,125 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00265, (torch.Size([32]))
2023-03-13 08:28:40,128 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00260, (torch.Size([256]))
2023-03-13 08:28:40,128 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00201, (torch.Size([128]))
2023-03-13 08:28:40,128 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00147, (torch.Size([151, 200]))
2023-03-13 08:28:40,128 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00108, (torch.Size([2048]))
2023-03-13 08:28:40,128 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00108, (torch.Size([2048]))
2023-03-13 08:28:40,128 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00098, (torch.Size([2048]))
2023-03-13 08:28:40,129 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00098, (torch.Size([2048]))
2023-03-13 08:28:40,129 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-13 08:28:40,129 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 08:28:40,134 maskrcnn_benchmark INFO: eta: 1 day, 20:38:10  iter: 10000  loss: 0.5430 (0.7355)  ML Loss (cd): -0.2499 (-0.2476)  loss_refine_obj: 0.5765 (0.7031)  loss_rel: 0.2616 (0.2801)  time: 1.5391 (2.2956)  data: 0.0049 (0.7235)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 08:28:40,138 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi/model_0010000.pth
2023-03-13 08:29:15,905 maskrcnn_benchmark INFO: Start validating
2023-03-13 08:29:15,929 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-13 08:54:01,964 maskrcnn_benchmark INFO: Total run time: 0:24:46.034913 (0.5944139650344848 s / img per device, on 2 devices)
2023-03-13 08:54:01,965 maskrcnn_benchmark INFO: Model inference time: 0:19:32.318370 (0.4689273480415344 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(249987, 7)
0/249987
DONE (t=1.77s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=30.64s).
Accumulating evaluation results...
DONE (t=7.07s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.148
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.284
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.138
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.064
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.110
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.187
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.220
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.318
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.320
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.267
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.352
2023-03-13 08:58:42,754 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2841
====================================================================================================
SGG eval:   R @ 20: 0.2314;   R @ 50: 0.2987;   R @ 100: 0.3357;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2369; ngR @ 50: 0.3216; ngR @ 100: 0.3789;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0063;  zR @ 50: 0.0148;  zR @ 100: 0.0296;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0135;  zR @ 50: 0.0230;  zR @ 100: 0.0400;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0183;  zR @ 50: 0.0330;  zR @ 100: 0.0513;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0236;  zR @ 50: 0.0236;  zR @ 100: 0.0451;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0278;  zR @ 50: 0.0387;  zR @ 100: 0.0585;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0308;  zR @ 50: 0.0615;  zR @ 100: 0.0940;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0306;  zR @ 50: 0.0497;  zR @ 100: 0.0827;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0258;  zR @ 50: 0.0490;  zR @ 100: 0.0657;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0504;  zR @ 50: 0.0899;  zR @ 100: 0.1201;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0284;  zR @ 50: 0.0486;  zR @ 100: 0.0723;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0426;  zR @ 50: 0.0691;  zR @ 100: 0.1022;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0619;  zR @ 50: 0.1119;  zR @ 100: 0.1190;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0130;  zR @ 50: 0.0260;  zR @ 100: 0.0260;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1827;  zR @ 50: 0.2583;  zR @ 100: 0.3339;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.1280;  zR @ 50: 0.1577;  zR @ 100: 0.1994;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1474;  zR @ 50: 0.1859;  zR @ 100: 0.2436;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.0000;  zR @ 50: 0.6667;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0490;  mR @ 50: 0.0654;  mR @ 100: 0.0785;  for mode=sgdet, type=Mean Recall.
(above:0.0301) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.2299) (attached to:0.0000) (behind:0.1616) (belonging to:0.0000) (between:0.0000) (carrying:0.1316) (covered in:0.0000) (covering:0.0000) (eating:0.2857) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.4076) (holding:0.2476) (in:0.1434) (in front of:0.1082) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.1853) (of:0.2053) (on:0.4406) (on back of:0.0000) (over:0.0244) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.3259) (says:0.0000) (sitting on:0.1012) (standing on:0.0000) (to:0.0000) (under:0.0680) (using:0.0769) (walking in:0.0000) (walking on:0.0671) (watching:0.0784) (wearing:0.5921) (wears:0.0000) (with:0.0153) 
====================================================================================================

2023-03-13 08:58:43,749 maskrcnn_benchmark INFO: Validation Result: 0.3357
2023-03-13 09:03:45,479 maskrcnn_benchmark INFO: eta: 1 day, 23:38:16  iter: 10200  loss: 0.5559 (0.7332)  ML Loss (cd): -0.2500 (-0.2476)  loss_refine_obj: 0.5845 (0.7009)  loss_rel: 0.2213 (0.2799)  time: 1.1232 (2.4570)  data: 0.0052 (0.8863)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 09:07:21,907 maskrcnn_benchmark INFO: eta: 1 day, 22:59:24  iter: 10400  loss: 0.6316 (0.7310)  ML Loss (cd): -0.2499 (-0.2477)  loss_refine_obj: 0.6187 (0.6988)  loss_rel: 0.2752 (0.2799)  time: 1.0812 (2.4305)  data: 0.0047 (0.8693)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 09:10:58,641 maskrcnn_benchmark INFO: eta: 1 day, 22:21:55  iter: 10600  loss: 0.5410 (0.7282)  ML Loss (cd): -0.2500 (-0.2477)  loss_refine_obj: 0.5573 (0.6964)  loss_rel: 0.2378 (0.2795)  time: 1.1179 (2.4051)  data: 0.0049 (0.8530)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 09:16:06,050 maskrcnn_benchmark INFO: eta: 1 day, 21:55:21  iter: 10800  loss: 0.5922 (0.7262)  ML Loss (cd): -0.2500 (-0.2478)  loss_refine_obj: 0.5954 (0.6945)  loss_rel: 0.2204 (0.2794)  time: 1.6217 (2.3890)  data: 0.0049 (0.8373)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 09:21:30,953 maskrcnn_benchmark INFO: eta: 1 day, 21:31:24  iter: 11000  loss: 0.5903 (0.7244)  ML Loss (cd): -0.2499 (-0.2478)  loss_refine_obj: 0.5728 (0.6929)  loss_rel: 0.2533 (0.2793)  time: 1.6083 (2.3751)  data: 0.0050 (0.8222)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 09:26:54,557 maskrcnn_benchmark INFO: eta: 1 day, 21:07:59  iter: 11200  loss: 0.5237 (0.7222)  ML Loss (cd): -0.2499 (-0.2478)  loss_refine_obj: 0.5381 (0.6910)  loss_rel: 0.2406 (0.2790)  time: 1.5500 (2.3616)  data: 0.0049 (0.8076)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 09:32:20,509 maskrcnn_benchmark INFO: eta: 1 day, 20:45:26  iter: 11400  loss: 0.6661 (0.7202)  ML Loss (cd): -0.2500 (-0.2479)  loss_refine_obj: 0.6040 (0.6893)  loss_rel: 0.2689 (0.2788)  time: 1.5947 (2.3488)  data: 0.0049 (0.7935)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 09:37:46,500 maskrcnn_benchmark INFO: eta: 1 day, 20:23:28  iter: 11600  loss: 0.5711 (0.7183)  ML Loss (cd): -0.2500 (-0.2479)  loss_refine_obj: 0.5872 (0.6877)  loss_rel: 0.2488 (0.2786)  time: 1.6170 (2.3364)  data: 0.0048 (0.7799)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 09:43:09,202 maskrcnn_benchmark INFO: eta: 1 day, 20:01:46  iter: 11800  loss: 0.5461 (0.7166)  ML Loss (cd): -0.2500 (-0.2479)  loss_refine_obj: 0.5881 (0.6861)  loss_rel: 0.2501 (0.2785)  time: 1.5690 (2.3241)  data: 0.0047 (0.7668)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 09:48:35,145 maskrcnn_benchmark INFO: ---Total norm 0.04376 clip coef 114.26895-----------------
2023-03-13 09:48:35,386 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.weight            : 0.02034, (torch.Size([300, 600]))
2023-03-13 09:48:35,386 maskrcnn_benchmark INFO: module.energy.0.weight                            : 0.01952, (torch.Size([300, 600]))
2023-03-13 09:48:35,387 maskrcnn_benchmark INFO: module.energy.2.weight                            : 0.01616, (torch.Size([1, 300]))
2023-03-13 09:48:35,387 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.bias                : 0.01319, (torch.Size([1]))
2023-03-13 09:48:35,387 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_ih                 : 0.01299, (torch.Size([900]))
2023-03-13 09:48:35,387 maskrcnn_benchmark INFO: module.obj_label_embedding.weight                 : 0.01058, (torch.Size([300, 279]))
2023-03-13 09:48:35,388 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.weight              : 0.00969, (torch.Size([1, 300]))
2023-03-13 09:48:35,388 maskrcnn_benchmark INFO: module.energy.2.bias                              : 0.00931, (torch.Size([1]))
2023-03-13 09:48:35,388 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_hh               : 0.00840, (torch.Size([900, 300]))
2023-03-13 09:48:35,388 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_hh                 : 0.00650, (torch.Size([900]))
2023-03-13 09:48:35,388 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_ih               : 0.00522, (torch.Size([900, 300]))
2023-03-13 09:48:35,388 maskrcnn_benchmark INFO: module.obj_emdedding.weight                       : 0.00494, (torch.Size([300, 4096]))
2023-03-13 09:48:35,388 maskrcnn_benchmark INFO: module.energy.0.bias                              : 0.00390, (torch.Size([300]))
2023-03-13 09:48:35,388 maskrcnn_benchmark INFO: module.obj_label_embedding.bias                   : 0.00256, (torch.Size([300]))
2023-03-13 09:48:35,388 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.bias           : 0.00245, (torch.Size([300]))
2023-03-13 09:48:35,388 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.bias           : 0.00222, (torch.Size([300]))
2023-03-13 09:48:35,388 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.bias                : 0.00184, (torch.Size([1]))
2023-03-13 09:48:35,389 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.bias              : 0.00166, (torch.Size([300]))
2023-03-13 09:48:35,389 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.weight         : 0.00165, (torch.Size([300, 300]))
2023-03-13 09:48:35,389 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.bias              : 0.00165, (torch.Size([300]))
2023-03-13 09:48:35,389 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.weight              : 0.00162, (torch.Size([1, 300]))
2023-03-13 09:48:35,389 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.weight            : 0.00118, (torch.Size([300, 300]))
2023-03-13 09:48:35,389 maskrcnn_benchmark INFO: module.pos_embed.2.weight                         : 0.00113, (torch.Size([128, 32]))
2023-03-13 09:48:35,389 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_ih                 : 0.00111, (torch.Size([900]))
2023-03-13 09:48:35,389 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.weight         : 0.00111, (torch.Size([300, 300]))
2023-03-13 09:48:35,389 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.weight         : 0.00109, (torch.Size([300, 300]))
2023-03-13 09:48:35,389 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.bias           : 0.00103, (torch.Size([300]))
2023-03-13 09:48:35,389 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_hh               : 0.00101, (torch.Size([900, 300]))
2023-03-13 09:48:35,390 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.bias           : 0.00093, (torch.Size([300]))
2023-03-13 09:48:35,390 maskrcnn_benchmark INFO: module.pos_embed.0.weight                         : 0.00063, (torch.Size([32, 9]))
2023-03-13 09:48:35,390 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_hh               : 0.00060, (torch.Size([900, 300]))
2023-03-13 09:48:35,390 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_hh                 : 0.00056, (torch.Size([900]))
2023-03-13 09:48:35,390 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_ih               : 0.00050, (torch.Size([900, 300]))
2023-03-13 09:48:35,390 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_ih               : 0.00048, (torch.Size([900, 300]))
2023-03-13 09:48:35,390 maskrcnn_benchmark INFO: module.rel_label_embedding.weight                 : 0.00047, (torch.Size([300, 51]))
2023-03-13 09:48:35,390 maskrcnn_benchmark INFO: module.pos_embed.2.bias                           : 0.00044, (torch.Size([128]))
2023-03-13 09:48:35,390 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.bias                : 0.00041, (torch.Size([300]))
2023-03-13 09:48:35,390 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.bias           : 0.00035, (torch.Size([300]))
2023-03-13 09:48:35,391 maskrcnn_benchmark INFO: module.rel_label_embedding.bias                   : 0.00029, (torch.Size([300]))
2023-03-13 09:48:35,392 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.weight         : 0.00028, (torch.Size([300, 300]))
2023-03-13 09:48:35,392 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.weight         : 0.00026, (torch.Size([300, 300, 1, 1]))
2023-03-13 09:48:35,392 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.weight         : 0.00024, (torch.Size([300, 600, 1, 1]))
2023-03-13 09:48:35,392 maskrcnn_benchmark INFO: module.obj_emdedding.bias                         : 0.00020, (torch.Size([300]))
2023-03-13 09:48:35,392 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.weight              : 0.00019, (torch.Size([300, 300]))
2023-03-13 09:48:35,392 maskrcnn_benchmark INFO: module.pos_embed.1.bias                           : 0.00017, (torch.Size([32]))
2023-03-13 09:48:35,392 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.bias                : 0.00017, (torch.Size([300]))
2023-03-13 09:48:35,392 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.bias           : 0.00012, (torch.Size([300]))
2023-03-13 09:48:35,393 maskrcnn_benchmark INFO: module.pos_embed.1.weight                         : 0.00012, (torch.Size([32]))
2023-03-13 09:48:35,393 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.bias                : 0.00004, (torch.Size([1]))
2023-03-13 09:48:35,393 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.weight              : 0.00004, (torch.Size([300, 300]))
2023-03-13 09:48:35,393 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.weight              : 0.00003, (torch.Size([1, 300]))
2023-03-13 09:48:35,393 maskrcnn_benchmark INFO: module.pos_embed.0.bias                           : 0.00000, (torch.Size([32]))
2023-03-13 09:48:35,393 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 09:48:35,397 maskrcnn_benchmark INFO: ---Total norm 2.57890 clip coef 1.93881-----------------
2023-03-13 09:48:35,402 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 1.32805, (torch.Size([3072, 5136]))
2023-03-13 09:48:35,402 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.28019, (torch.Size([151, 512]))
2023-03-13 09:48:35,403 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.weight: 0.93521, (torch.Size([4096, 4096]))
2023-03-13 09:48:35,403 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.weight: 0.89967, (torch.Size([4096, 12544]))
2023-03-13 09:48:35,403 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 0.85864, (torch.Size([4096, 12544]))
2023-03-13 09:48:35,403 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.44375, (torch.Size([4096, 4096]))
2023-03-13 09:48:35,403 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.weight: 0.40850, (torch.Size([51, 4096]))
2023-03-13 09:48:35,403 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.38502, (torch.Size([256, 1024, 3, 3]))
2023-03-13 09:48:35,403 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.28883, (torch.Size([256, 128, 3, 3]))
2023-03-13 09:48:35,403 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.23990, (torch.Size([512, 1024]))
2023-03-13 09:48:35,403 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.weight: 0.23001, (torch.Size([4096, 1024]))
2023-03-13 09:48:35,403 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.17253, (torch.Size([128, 2, 7, 7]))
2023-03-13 09:48:35,403 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.17219, (torch.Size([2560, 512]))
2023-03-13 09:48:35,404 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.15857, (torch.Size([2048, 4808]))
2023-03-13 09:48:35,404 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.15669, (torch.Size([2048, 4808]))
2023-03-13 09:48:35,404 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.04645, (torch.Size([512, 1024]))
2023-03-13 09:48:35,404 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.03800, (torch.Size([151]))
2023-03-13 09:48:35,404 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.03304, (torch.Size([22801, 51]))
2023-03-13 09:48:35,404 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.03278, (torch.Size([512]))
2023-03-13 09:48:35,404 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.03136, (torch.Size([2048, 4424]))
2023-03-13 09:48:35,404 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.03119, (torch.Size([2048, 4424]))
2023-03-13 09:48:35,404 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.bias: 0.02902, (torch.Size([51]))
2023-03-13 09:48:35,404 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.02793, (torch.Size([128]))
2023-03-13 09:48:35,404 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.02381, (torch.Size([3072]))
2023-03-13 09:48:35,405 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.01886, (torch.Size([128, 32]))
2023-03-13 09:48:35,405 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.01693, (torch.Size([2048, 512]))
2023-03-13 09:48:35,405 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.01670, (torch.Size([2048, 512]))
2023-03-13 09:48:35,405 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01522, (torch.Size([32, 9]))
2023-03-13 09:48:35,405 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.weight: 0.01027, (torch.Size([1024, 512]))
2023-03-13 09:48:35,405 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.bias: 0.00951, (torch.Size([4096]))
2023-03-13 09:48:35,405 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.00937, (torch.Size([4096]))
2023-03-13 09:48:35,405 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.00812, (torch.Size([128]))
2023-03-13 09:48:35,405 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.00672, (torch.Size([2560]))
2023-03-13 09:48:35,405 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.00656, (torch.Size([151, 200]))
2023-03-13 09:48:35,405 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.00580, (torch.Size([256]))
2023-03-13 09:48:35,405 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.bias : 0.00540, (torch.Size([4096]))
2023-03-13 09:48:35,406 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.00510, (torch.Size([512]))
2023-03-13 09:48:35,406 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.bias: 0.00492, (torch.Size([4096]))
2023-03-13 09:48:35,406 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00488, (torch.Size([256]))
2023-03-13 09:48:35,406 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00455, (torch.Size([256]))
2023-03-13 09:48:35,406 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00389, (torch.Size([2048, 512]))
2023-03-13 09:48:35,406 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00382, (torch.Size([2048, 512]))
2023-03-13 09:48:35,406 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.00364, (torch.Size([2048]))
2023-03-13 09:48:35,406 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.00364, (torch.Size([2048]))
2023-03-13 09:48:35,406 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00361, (torch.Size([152, 200]))
2023-03-13 09:48:35,406 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00356, (torch.Size([128]))
2023-03-13 09:48:35,406 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.00354, (torch.Size([2048]))
2023-03-13 09:48:35,407 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.00354, (torch.Size([2048]))
2023-03-13 09:48:35,407 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00352, (torch.Size([4096]))
2023-03-13 09:48:35,407 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.bias : 0.00334, (torch.Size([1024]))
2023-03-13 09:48:35,407 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00293, (torch.Size([256]))
2023-03-13 09:48:35,407 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00264, (torch.Size([128]))
2023-03-13 09:48:35,407 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00221, (torch.Size([32]))
2023-03-13 09:48:35,407 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00202, (torch.Size([32]))
2023-03-13 09:48:35,407 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00146, (torch.Size([151, 200]))
2023-03-13 09:48:35,407 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00073, (torch.Size([2048]))
2023-03-13 09:48:35,407 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00073, (torch.Size([2048]))
2023-03-13 09:48:35,407 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00070, (torch.Size([2048]))
2023-03-13 09:48:35,408 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00070, (torch.Size([2048]))
2023-03-13 09:48:35,408 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-13 09:48:35,408 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 09:48:35,413 maskrcnn_benchmark INFO: eta: 1 day, 19:40:55  iter: 12000  loss: 0.5661 (0.7149)  ML Loss (cd): -0.2500 (-0.2480)  loss_refine_obj: 0.5883 (0.6846)  loss_rel: 0.2444 (0.2783)  time: 1.6659 (2.3126)  data: 0.0047 (0.7541)  energy lr: 0.002000  base lr : 0.002000  max mem: 4980
2023-03-13 09:48:35,416 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi/model_0012000.pth
2023-03-13 09:49:22,483 maskrcnn_benchmark INFO: Start validating
2023-03-13 09:49:22,510 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-13 10:14:08,144 maskrcnn_benchmark INFO: Total run time: 0:24:45.633656 (0.5942534623146057 s / img per device, on 2 devices)
2023-03-13 10:14:08,145 maskrcnn_benchmark INFO: Model inference time: 0:19:12.976220 (0.4611904880523682 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(249987, 7)
0/249987
DONE (t=1.31s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=31.10s).
Accumulating evaluation results...
DONE (t=6.75s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.150
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.288
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.140
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.063
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.110
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.189
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.222
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.321
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.164
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.270
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.355
2023-03-13 10:18:46,539 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2882
====================================================================================================
SGG eval:   R @ 20: 0.2306;   R @ 50: 0.3006;   R @ 100: 0.3384;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2420; ngR @ 50: 0.3262; ngR @ 100: 0.3853;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0042;  zR @ 50: 0.0116;  zR @ 100: 0.0285;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0135;  zR @ 50: 0.0265;  zR @ 100: 0.0385;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0110;  zR @ 50: 0.0403;  zR @ 100: 0.0513;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0236;  zR @ 50: 0.0236;  zR @ 100: 0.0494;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0344;  zR @ 50: 0.0607;  zR @ 100: 0.0853;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0419;  zR @ 50: 0.0632;  zR @ 100: 0.1103;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0383;  zR @ 50: 0.0588;  zR @ 100: 0.0870;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0242;  zR @ 50: 0.0348;  zR @ 100: 0.0626;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0360;  zR @ 50: 0.0971;  zR @ 100: 0.1058;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0284;  zR @ 50: 0.0486;  zR @ 100: 0.0791;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0213;  zR @ 50: 0.0612;  zR @ 100: 0.0931;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0720;  zR @ 50: 0.1119;  zR @ 100: 0.1369;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0000;  zR @ 50: 0.0260;  zR @ 100: 0.0390;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.2060;  zR @ 50: 0.2874;  zR @ 100: 0.3339;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.1250;  zR @ 50: 0.1667;  zR @ 100: 0.2083;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1474;  zR @ 50: 0.1859;  zR @ 100: 0.2436;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.3333;  zR @ 50: 0.3333;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0477;  mR @ 50: 0.0663;  mR @ 100: 0.0776;  for mode=sgdet, type=Mean Recall.
(above:0.0215) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.2089) (attached to:0.0000) (behind:0.1715) (belonging to:0.0000) (between:0.0000) (carrying:0.1645) (covered in:0.0714) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.4116) (holding:0.2683) (in:0.1441) (in front of:0.0600) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2282) (of:0.1985) (on:0.4411) (on back of:0.0000) (over:0.0122) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.3705) (says:0.0000) (sitting on:0.1091) (standing on:0.0000) (to:0.0000) (under:0.0765) (using:0.0769) (walking in:0.0000) (walking on:0.1929) (watching:0.0490) (wearing:0.5840) (wears:0.0000) (with:0.0187) 
====================================================================================================

2023-03-13 10:18:47,568 maskrcnn_benchmark INFO: Validation Result: 0.3384
2023-03-13 10:18:47,569 maskrcnn_benchmark INFO: Trigger Schedule Decay, RL has been reduced by factor 0.05
2023-03-13 10:18:47,569 maskrcnn_benchmark INFO: Trigger Schedule Decay, RL has been reduced by factor 0.05
2023-03-13 10:24:07,958 maskrcnn_benchmark INFO: eta: 1 day, 22:07:54  iter: 12200  loss: 0.5822 (0.7132)  ML Loss (cd): -0.2500 (-0.2480)  loss_refine_obj: 0.5412 (0.6830)  loss_rel: 0.2377 (0.2782)  time: 1.5951 (2.4495)  data: 0.0051 (0.8903)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 10:29:30,869 maskrcnn_benchmark INFO: eta: 1 day, 21:44:33  iter: 12400  loss: 0.5547 (0.7115)  ML Loss (cd): -0.2500 (-0.2480)  loss_refine_obj: 0.5730 (0.6814)  loss_rel: 0.2097 (0.2781)  time: 1.6567 (2.4360)  data: 0.0051 (0.8761)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 10:34:56,591 maskrcnn_benchmark INFO: eta: 1 day, 21:22:02  iter: 12600  loss: 0.5594 (0.7097)  ML Loss (cd): -0.2500 (-0.2481)  loss_refine_obj: 0.4881 (0.6798)  loss_rel: 0.2767 (0.2780)  time: 1.5891 (2.4232)  data: 0.0050 (0.8622)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 10:40:20,691 maskrcnn_benchmark INFO: eta: 1 day, 20:59:55  iter: 12800  loss: 0.5731 (0.7081)  ML Loss (cd): -0.2500 (-0.2481)  loss_refine_obj: 0.5653 (0.6782)  loss_rel: 0.2166 (0.2780)  time: 1.6231 (2.4106)  data: 0.0050 (0.8488)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 10:45:47,917 maskrcnn_benchmark INFO: eta: 1 day, 20:38:35  iter: 13000  loss: 0.4684 (0.7065)  ML Loss (cd): -0.2500 (-0.2481)  loss_refine_obj: 0.5305 (0.6768)  loss_rel: 0.2137 (0.2778)  time: 1.5793 (2.3987)  data: 0.0050 (0.8358)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 10:51:10,060 maskrcnn_benchmark INFO: eta: 1 day, 20:17:17  iter: 13200  loss: 0.5562 (0.7048)  ML Loss (cd): -0.2500 (-0.2482)  loss_refine_obj: 0.5556 (0.6755)  loss_rel: 0.2371 (0.2775)  time: 1.5418 (2.3868)  data: 0.0049 (0.8233)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 10:56:33,272 maskrcnn_benchmark INFO: eta: 1 day, 19:56:34  iter: 13400  loss: 0.5209 (0.7028)  ML Loss (cd): -0.2500 (-0.2482)  loss_refine_obj: 0.5022 (0.6739)  loss_rel: 0.2338 (0.2771)  time: 1.5831 (2.3753)  data: 0.0049 (0.8110)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 11:01:56,459 maskrcnn_benchmark INFO: eta: 1 day, 19:36:17  iter: 13600  loss: 0.5390 (0.7010)  ML Loss (cd): -0.2500 (-0.2482)  loss_refine_obj: 0.4980 (0.6724)  loss_rel: 0.2417 (0.2769)  time: 1.5721 (2.3641)  data: 0.0048 (0.7992)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 11:07:21,593 maskrcnn_benchmark INFO: eta: 1 day, 19:16:36  iter: 13800  loss: 0.5865 (0.6992)  ML Loss (cd): -0.2500 (-0.2482)  loss_refine_obj: 0.5758 (0.6707)  loss_rel: 0.2456 (0.2767)  time: 1.5979 (2.3534)  data: 0.0048 (0.7877)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 11:12:47,176 maskrcnn_benchmark INFO: ---Total norm 0.01844 clip coef 271.14523-----------------
2023-03-13 11:12:47,462 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.weight            : 0.00826, (torch.Size([300, 600]))
2023-03-13 11:12:47,463 maskrcnn_benchmark INFO: module.energy.0.weight                            : 0.00790, (torch.Size([300, 600]))
2023-03-13 11:12:47,463 maskrcnn_benchmark INFO: module.energy.2.weight                            : 0.00692, (torch.Size([1, 300]))
2023-03-13 11:12:47,463 maskrcnn_benchmark INFO: module.energy.2.bias                              : 0.00624, (torch.Size([1]))
2023-03-13 11:12:47,463 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_ih                 : 0.00531, (torch.Size([900]))
2023-03-13 11:12:47,463 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.bias                : 0.00486, (torch.Size([1]))
2023-03-13 11:12:47,463 maskrcnn_benchmark INFO: module.obj_label_embedding.weight                 : 0.00429, (torch.Size([300, 279]))
2023-03-13 11:12:47,463 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.weight              : 0.00363, (torch.Size([1, 300]))
2023-03-13 11:12:47,463 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_hh               : 0.00338, (torch.Size([900, 300]))
2023-03-13 11:12:47,464 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_hh                 : 0.00265, (torch.Size([900]))
2023-03-13 11:12:47,464 maskrcnn_benchmark INFO: module.energy.0.bias                              : 0.00223, (torch.Size([300]))
2023-03-13 11:12:47,464 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_ih               : 0.00215, (torch.Size([900, 300]))
2023-03-13 11:12:47,464 maskrcnn_benchmark INFO: module.obj_emdedding.weight                       : 0.00189, (torch.Size([300, 4096]))
2023-03-13 11:12:47,464 maskrcnn_benchmark INFO: module.obj_label_embedding.bias                   : 0.00107, (torch.Size([300]))
2023-03-13 11:12:47,464 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.bias           : 0.00099, (torch.Size([300]))
2023-03-13 11:12:47,465 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.bias              : 0.00097, (torch.Size([300]))
2023-03-13 11:12:47,465 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.bias              : 0.00092, (torch.Size([300]))
2023-03-13 11:12:47,465 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.bias           : 0.00090, (torch.Size([300]))
2023-03-13 11:12:47,465 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.weight         : 0.00069, (torch.Size([300, 300]))
2023-03-13 11:12:47,465 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.weight              : 0.00063, (torch.Size([1, 300]))
2023-03-13 11:12:47,465 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.bias                : 0.00055, (torch.Size([1]))
2023-03-13 11:12:47,465 maskrcnn_benchmark INFO: module.pos_embed.2.weight                         : 0.00051, (torch.Size([128, 32]))
2023-03-13 11:12:47,465 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.weight         : 0.00048, (torch.Size([300, 300]))
2023-03-13 11:12:47,465 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.weight         : 0.00047, (torch.Size([300, 300]))
2023-03-13 11:12:47,465 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.bias           : 0.00040, (torch.Size([300]))
2023-03-13 11:12:47,465 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_hh               : 0.00039, (torch.Size([900, 300]))
2023-03-13 11:12:47,466 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.bias           : 0.00036, (torch.Size([300]))
2023-03-13 11:12:47,466 maskrcnn_benchmark INFO: module.pos_embed.0.weight                         : 0.00029, (torch.Size([32, 9]))
2023-03-13 11:12:47,466 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_ih                 : 0.00027, (torch.Size([900]))
2023-03-13 11:12:47,466 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_hh               : 0.00025, (torch.Size([900, 300]))
2023-03-13 11:12:47,466 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.weight            : 0.00023, (torch.Size([300, 300]))
2023-03-13 11:12:47,466 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_ih               : 0.00021, (torch.Size([900, 300]))
2023-03-13 11:12:47,466 maskrcnn_benchmark INFO: module.rel_label_embedding.weight                 : 0.00020, (torch.Size([300, 51]))
2023-03-13 11:12:47,466 maskrcnn_benchmark INFO: module.pos_embed.2.bias                           : 0.00017, (torch.Size([128]))
2023-03-13 11:12:47,466 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.weight         : 0.00017, (torch.Size([300, 300]))
2023-03-13 11:12:47,466 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.bias           : 0.00015, (torch.Size([300]))
2023-03-13 11:12:47,466 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_hh                 : 0.00014, (torch.Size([900]))
2023-03-13 11:12:47,467 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_ih               : 0.00013, (torch.Size([900, 300]))
2023-03-13 11:12:47,467 maskrcnn_benchmark INFO: module.rel_label_embedding.bias                   : 0.00012, (torch.Size([300]))
2023-03-13 11:12:47,467 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.weight         : 0.00011, (torch.Size([300, 300, 1, 1]))
2023-03-13 11:12:47,467 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.weight         : 0.00010, (torch.Size([300, 600, 1, 1]))
2023-03-13 11:12:47,467 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.bias                : 0.00010, (torch.Size([300]))
2023-03-13 11:12:47,467 maskrcnn_benchmark INFO: module.pos_embed.1.bias                           : 0.00007, (torch.Size([32]))
2023-03-13 11:12:47,467 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.weight              : 0.00006, (torch.Size([300, 300]))
2023-03-13 11:12:47,467 maskrcnn_benchmark INFO: module.obj_emdedding.bias                         : 0.00005, (torch.Size([300]))
2023-03-13 11:12:47,467 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.bias           : 0.00005, (torch.Size([300]))
2023-03-13 11:12:47,467 maskrcnn_benchmark INFO: module.pos_embed.1.weight                         : 0.00004, (torch.Size([32]))
2023-03-13 11:12:47,467 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.bias                : 0.00004, (torch.Size([300]))
2023-03-13 11:12:47,468 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.weight              : 0.00004, (torch.Size([300, 300]))
2023-03-13 11:12:47,469 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.weight              : 0.00002, (torch.Size([1, 300]))
2023-03-13 11:12:47,469 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.bias                : 0.00001, (torch.Size([1]))
2023-03-13 11:12:47,469 maskrcnn_benchmark INFO: module.pos_embed.0.bias                           : 0.00000, (torch.Size([32]))
2023-03-13 11:12:47,469 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 11:12:47,474 maskrcnn_benchmark INFO: ---Total norm 3.69259 clip coef 1.35406-----------------
2023-03-13 11:12:47,481 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 1.53562, (torch.Size([3072, 5136]))
2023-03-13 11:12:47,482 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.weight: 1.51795, (torch.Size([4096, 4096]))
2023-03-13 11:12:47,482 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.43630, (torch.Size([151, 512]))
2023-03-13 11:12:47,482 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.weight: 1.33868, (torch.Size([4096, 12544]))
2023-03-13 11:12:47,482 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 1.25128, (torch.Size([4096, 12544]))
2023-03-13 11:12:47,482 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.89831, (torch.Size([512, 1024]))
2023-03-13 11:12:47,482 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.76612, (torch.Size([4096, 4096]))
2023-03-13 11:12:47,482 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.weight: 0.74329, (torch.Size([4096, 1024]))
2023-03-13 11:12:47,482 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.weight: 0.62452, (torch.Size([51, 4096]))
2023-03-13 11:12:47,482 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.58004, (torch.Size([2048, 4808]))
2023-03-13 11:12:47,482 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.57668, (torch.Size([2048, 4808]))
2023-03-13 11:12:47,482 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.44528, (torch.Size([256, 1024, 3, 3]))
2023-03-13 11:12:47,483 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.44413, (torch.Size([256, 128, 3, 3]))
2023-03-13 11:12:47,483 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.22913, (torch.Size([2560, 512]))
2023-03-13 11:12:47,483 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.20079, (torch.Size([128, 2, 7, 7]))
2023-03-13 11:12:47,483 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.14519, (torch.Size([512]))
2023-03-13 11:12:47,483 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.09524, (torch.Size([512, 1024]))
2023-03-13 11:12:47,483 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.06318, (torch.Size([2048, 512]))
2023-03-13 11:12:47,483 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.06228, (torch.Size([2048, 4424]))
2023-03-13 11:12:47,483 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.06150, (torch.Size([2048, 4424]))
2023-03-13 11:12:47,483 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.bias: 0.06005, (torch.Size([51]))
2023-03-13 11:12:47,483 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.05769, (torch.Size([2048, 512]))
2023-03-13 11:12:47,484 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.04820, (torch.Size([22801, 51]))
2023-03-13 11:12:47,484 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.weight: 0.03601, (torch.Size([1024, 512]))
2023-03-13 11:12:47,484 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.03593, (torch.Size([151]))
2023-03-13 11:12:47,484 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.02737, (torch.Size([3072]))
2023-03-13 11:12:47,484 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.02680, (torch.Size([128]))
2023-03-13 11:12:47,484 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.bias : 0.02168, (torch.Size([4096]))
2023-03-13 11:12:47,484 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.01792, (torch.Size([4096]))
2023-03-13 11:12:47,484 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.01558, (torch.Size([128, 32]))
2023-03-13 11:12:47,484 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.bias: 0.01537, (torch.Size([4096]))
2023-03-13 11:12:47,484 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.bias : 0.01443, (torch.Size([1024]))
2023-03-13 11:12:47,484 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.01381, (torch.Size([2048]))
2023-03-13 11:12:47,485 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.01381, (torch.Size([2048]))
2023-03-13 11:12:47,485 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.01363, (torch.Size([2048]))
2023-03-13 11:12:47,485 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.01363, (torch.Size([2048]))
2023-03-13 11:12:47,485 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01354, (torch.Size([32, 9]))
2023-03-13 11:12:47,485 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.01197, (torch.Size([512]))
2023-03-13 11:12:47,485 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.01086, (torch.Size([256]))
2023-03-13 11:12:47,485 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.01026, (torch.Size([128]))
2023-03-13 11:12:47,485 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.00870, (torch.Size([2560]))
2023-03-13 11:12:47,485 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.00773, (torch.Size([151, 200]))
2023-03-13 11:12:47,485 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00770, (torch.Size([2048, 512]))
2023-03-13 11:12:47,486 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.bias: 0.00760, (torch.Size([4096]))
2023-03-13 11:12:47,486 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00760, (torch.Size([256]))
2023-03-13 11:12:47,486 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00759, (torch.Size([2048, 512]))
2023-03-13 11:12:47,486 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00660, (torch.Size([256]))
2023-03-13 11:12:47,486 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00638, (torch.Size([4096]))
2023-03-13 11:12:47,486 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00456, (torch.Size([151, 200]))
2023-03-13 11:12:47,486 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00454, (torch.Size([256]))
2023-03-13 11:12:47,486 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00399, (torch.Size([152, 200]))
2023-03-13 11:12:47,486 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00375, (torch.Size([128]))
2023-03-13 11:12:47,486 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00235, (torch.Size([128]))
2023-03-13 11:12:47,486 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00226, (torch.Size([32]))
2023-03-13 11:12:47,487 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00176, (torch.Size([32]))
2023-03-13 11:12:47,487 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00149, (torch.Size([2048]))
2023-03-13 11:12:47,487 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00149, (torch.Size([2048]))
2023-03-13 11:12:47,487 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00146, (torch.Size([2048]))
2023-03-13 11:12:47,487 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00146, (torch.Size([2048]))
2023-03-13 11:12:47,487 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-13 11:12:47,487 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 11:12:47,491 maskrcnn_benchmark INFO: eta: 1 day, 18:57:23  iter: 14000  loss: 0.6220 (0.6975)  ML Loss (cd): -0.2500 (-0.2483)  loss_refine_obj: 0.5593 (0.6692)  loss_rel: 0.2550 (0.2765)  time: 1.6177 (2.3431)  data: 0.0046 (0.7765)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 11:12:47,495 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi/model_0014000.pth
2023-03-13 11:13:32,667 maskrcnn_benchmark INFO: Start validating
2023-03-13 11:13:32,693 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-13 11:38:16,490 maskrcnn_benchmark INFO: Total run time: 0:24:43.796819 (0.593518727684021 s / img per device, on 2 devices)
2023-03-13 11:38:16,492 maskrcnn_benchmark INFO: Model inference time: 0:19:01.387866 (0.4565551465034485 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(249987, 7)
0/249987
DONE (t=1.79s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=30.39s).
Accumulating evaluation results...
DONE (t=7.00s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.149
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.288
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.139
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.063
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.110
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.189
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.222
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.320
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.323
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.165
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.269
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.355
2023-03-13 11:42:57,784 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2875
====================================================================================================
SGG eval:   R @ 20: 0.2402;   R @ 50: 0.3074;   R @ 100: 0.3433;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2508; ngR @ 50: 0.3369; ngR @ 100: 0.3936;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0074;  zR @ 50: 0.0137;  zR @ 100: 0.0285;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0135;  zR @ 50: 0.0340;  zR @ 100: 0.0506;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0110;  zR @ 50: 0.0403;  zR @ 100: 0.0586;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0236;  zR @ 50: 0.0236;  zR @ 100: 0.0494;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0344;  zR @ 50: 0.0475;  zR @ 100: 0.0716;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0410;  zR @ 50: 0.0684;  zR @ 100: 0.1115;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0306;  zR @ 50: 0.0582;  zR @ 100: 0.0870;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0242;  zR @ 50: 0.0348;  zR @ 100: 0.0515;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0647;  zR @ 50: 0.1043;  zR @ 100: 0.1201;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0284;  zR @ 50: 0.0486;  zR @ 100: 0.0804;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0213;  zR @ 50: 0.0559;  zR @ 100: 0.1102;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0673;  zR @ 50: 0.1048;  zR @ 100: 0.1298;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0130;  zR @ 50: 0.0260;  zR @ 100: 0.0260;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1827;  zR @ 50: 0.2699;  zR @ 100: 0.3223;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.0833;  zR @ 50: 0.1875;  zR @ 100: 0.2083;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1474;  zR @ 50: 0.2051;  zR @ 100: 0.2436;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.3333;  zR @ 50: 0.3333;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0474;  mR @ 50: 0.0637;  mR @ 100: 0.0761;  for mode=sgdet, type=Mean Recall.
(above:0.0372) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.1359) (attached to:0.0000) (behind:0.1755) (belonging to:0.0000) (between:0.0000) (carrying:0.1250) (covered in:0.0714) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.4150) (holding:0.2765) (in:0.1436) (in front of:0.0456) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2447) (of:0.2103) (on:0.4474) (on back of:0.0000) (over:0.0244) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.3705) (says:0.0000) (sitting on:0.0908) (standing on:0.0000) (to:0.0000) (under:0.0816) (using:0.0769) (walking in:0.0000) (walking on:0.1431) (watching:0.0784) (wearing:0.5900) (wears:0.0000) (with:0.0187) 
====================================================================================================

2023-03-13 11:42:58,771 maskrcnn_benchmark INFO: Validation Result: 0.3433
2023-03-13 11:48:23,280 maskrcnn_benchmark INFO: eta: 1 day, 20:58:19  iter: 14200  loss: 0.5363 (0.6958)  ML Loss (cd): -0.2500 (-0.2483)  loss_refine_obj: 0.5694 (0.6679)  loss_rel: 0.2554 (0.2763)  time: 1.5294 (2.4605)  data: 0.0050 (0.8932)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 11:53:46,874 maskrcnn_benchmark INFO: eta: 1 day, 20:37:20  iter: 14400  loss: 0.6063 (0.6946)  ML Loss (cd): -0.2500 (-0.2483)  loss_refine_obj: 0.5833 (0.6665)  loss_rel: 0.2698 (0.2764)  time: 1.6360 (2.4488)  data: 0.0050 (0.8809)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 11:59:08,783 maskrcnn_benchmark INFO: eta: 1 day, 20:16:38  iter: 14600  loss: 0.5648 (0.6930)  ML Loss (cd): -0.2500 (-0.2483)  loss_refine_obj: 0.6132 (0.6651)  loss_rel: 0.2295 (0.2762)  time: 1.5866 (2.4373)  data: 0.0051 (0.8689)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 12:04:32,719 maskrcnn_benchmark INFO: eta: 1 day, 19:56:30  iter: 14800  loss: 0.5351 (0.6913)  ML Loss (cd): -0.2500 (-0.2484)  loss_refine_obj: 0.5401 (0.6637)  loss_rel: 0.2649 (0.2760)  time: 1.6506 (2.4262)  data: 0.0051 (0.8572)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 12:09:57,154 maskrcnn_benchmark INFO: eta: 1 day, 19:36:48  iter: 15000  loss: 0.5662 (0.6898)  ML Loss (cd): -0.2500 (-0.2484)  loss_refine_obj: 0.5682 (0.6624)  loss_rel: 0.2376 (0.2758)  time: 1.6470 (2.4155)  data: 0.0050 (0.8458)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 12:15:23,453 maskrcnn_benchmark INFO: eta: 1 day, 19:17:37  iter: 15200  loss: 0.5554 (0.6879)  ML Loss (cd): -0.2500 (-0.2484)  loss_refine_obj: 0.5073 (0.6609)  loss_rel: 0.2385 (0.2754)  time: 1.6554 (2.4052)  data: 0.0051 (0.8348)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 12:20:49,589 maskrcnn_benchmark INFO: eta: 1 day, 18:58:46  iter: 15400  loss: 0.5917 (0.6863)  ML Loss (cd): -0.2500 (-0.2484)  loss_refine_obj: 0.5916 (0.6597)  loss_rel: 0.2848 (0.2751)  time: 1.6302 (2.3951)  data: 0.0049 (0.8240)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 12:26:15,470 maskrcnn_benchmark INFO: eta: 1 day, 18:40:14  iter: 15600  loss: 0.5290 (0.6847)  ML Loss (cd): -0.2500 (-0.2484)  loss_refine_obj: 0.5397 (0.6583)  loss_rel: 0.2447 (0.2748)  time: 1.6007 (2.3853)  data: 0.0053 (0.8135)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 12:31:42,015 maskrcnn_benchmark INFO: eta: 1 day, 18:22:06  iter: 15800  loss: 0.5099 (0.6830)  ML Loss (cd): -0.2500 (-0.2485)  loss_refine_obj: 0.5419 (0.6569)  loss_rel: 0.2164 (0.2746)  time: 1.6527 (2.3758)  data: 0.0051 (0.8033)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 12:37:07,035 maskrcnn_benchmark INFO: ---Total norm 0.02750 clip coef 181.78398-----------------
2023-03-13 12:37:07,204 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.weight            : 0.01233, (torch.Size([300, 600]))
2023-03-13 12:37:07,204 maskrcnn_benchmark INFO: module.energy.0.weight                            : 0.01186, (torch.Size([300, 600]))
2023-03-13 12:37:07,205 maskrcnn_benchmark INFO: module.energy.2.weight                            : 0.01042, (torch.Size([1, 300]))
2023-03-13 12:37:07,205 maskrcnn_benchmark INFO: module.energy.2.bias                              : 0.00900, (torch.Size([1]))
2023-03-13 12:37:07,205 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_ih                 : 0.00807, (torch.Size([900]))
2023-03-13 12:37:07,205 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.bias                : 0.00747, (torch.Size([1]))
2023-03-13 12:37:07,205 maskrcnn_benchmark INFO: module.obj_label_embedding.weight                 : 0.00619, (torch.Size([300, 279]))
2023-03-13 12:37:07,205 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.weight              : 0.00549, (torch.Size([1, 300]))
2023-03-13 12:37:07,205 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_hh               : 0.00498, (torch.Size([900, 300]))
2023-03-13 12:37:07,205 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_hh                 : 0.00404, (torch.Size([900]))
2023-03-13 12:37:07,205 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_ih               : 0.00328, (torch.Size([900, 300]))
2023-03-13 12:37:07,205 maskrcnn_benchmark INFO: module.energy.0.bias                              : 0.00325, (torch.Size([300]))
2023-03-13 12:37:07,206 maskrcnn_benchmark INFO: module.obj_emdedding.weight                       : 0.00258, (torch.Size([300, 4096]))
2023-03-13 12:37:07,206 maskrcnn_benchmark INFO: module.obj_label_embedding.bias                   : 0.00163, (torch.Size([300]))
2023-03-13 12:37:07,206 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.bias           : 0.00149, (torch.Size([300]))
2023-03-13 12:37:07,206 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.bias              : 0.00143, (torch.Size([300]))
2023-03-13 12:37:07,206 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.bias           : 0.00136, (torch.Size([300]))
2023-03-13 12:37:07,206 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.bias              : 0.00135, (torch.Size([300]))
2023-03-13 12:37:07,206 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.weight         : 0.00108, (torch.Size([300, 300]))
2023-03-13 12:37:07,206 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.weight         : 0.00077, (torch.Size([300, 300]))
2023-03-13 12:37:07,206 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.weight         : 0.00069, (torch.Size([300, 300]))
2023-03-13 12:37:07,206 maskrcnn_benchmark INFO: module.pos_embed.2.weight                         : 0.00061, (torch.Size([128, 32]))
2023-03-13 12:37:07,206 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.bias           : 0.00059, (torch.Size([300]))
2023-03-13 12:37:07,207 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.weight              : 0.00056, (torch.Size([1, 300]))
2023-03-13 12:37:07,207 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.bias           : 0.00055, (torch.Size([300]))
2023-03-13 12:37:07,207 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.weight            : 0.00053, (torch.Size([300, 300]))
2023-03-13 12:37:07,207 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_hh               : 0.00051, (torch.Size([900, 300]))
2023-03-13 12:37:07,207 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_hh               : 0.00040, (torch.Size([900, 300]))
2023-03-13 12:37:07,207 maskrcnn_benchmark INFO: module.pos_embed.0.weight                         : 0.00036, (torch.Size([32, 9]))
2023-03-13 12:37:07,207 maskrcnn_benchmark INFO: module.rel_label_embedding.weight                 : 0.00033, (torch.Size([300, 51]))
2023-03-13 12:37:07,207 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_ih               : 0.00030, (torch.Size([900, 300]))
2023-03-13 12:37:07,207 maskrcnn_benchmark INFO: module.pos_embed.2.bias                           : 0.00027, (torch.Size([128]))
2023-03-13 12:37:07,207 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.weight         : 0.00026, (torch.Size([300, 300]))
2023-03-13 12:37:07,207 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.bias           : 0.00023, (torch.Size([300]))
2023-03-13 12:37:07,207 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.bias                : 0.00023, (torch.Size([1]))
2023-03-13 12:37:07,208 maskrcnn_benchmark INFO: module.rel_label_embedding.bias                   : 0.00019, (torch.Size([300]))
2023-03-13 12:37:07,208 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.weight         : 0.00015, (torch.Size([300, 300, 1, 1]))
2023-03-13 12:37:07,208 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_ih                 : 0.00015, (torch.Size([900]))
2023-03-13 12:37:07,208 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.weight         : 0.00014, (torch.Size([300, 600, 1, 1]))
2023-03-13 12:37:07,208 maskrcnn_benchmark INFO: module.pos_embed.1.bias                           : 0.00011, (torch.Size([32]))
2023-03-13 12:37:07,208 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.bias                : 0.00011, (torch.Size([1]))
2023-03-13 12:37:07,208 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_hh                 : 0.00008, (torch.Size([900]))
2023-03-13 12:37:07,208 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_ih               : 0.00008, (torch.Size([900, 300]))
2023-03-13 12:37:07,208 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.bias           : 0.00008, (torch.Size([300]))
2023-03-13 12:37:07,208 maskrcnn_benchmark INFO: module.pos_embed.1.weight                         : 0.00007, (torch.Size([32]))
2023-03-13 12:37:07,208 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.bias                : 0.00006, (torch.Size([300]))
2023-03-13 12:37:07,209 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.weight              : 0.00006, (torch.Size([300, 300]))
2023-03-13 12:37:07,209 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.weight              : 0.00005, (torch.Size([300, 300]))
2023-03-13 12:37:07,209 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.weight              : 0.00005, (torch.Size([1, 300]))
2023-03-13 12:37:07,209 maskrcnn_benchmark INFO: module.obj_emdedding.bias                         : 0.00003, (torch.Size([300]))
2023-03-13 12:37:07,209 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.bias                : 0.00003, (torch.Size([300]))
2023-03-13 12:37:07,209 maskrcnn_benchmark INFO: module.pos_embed.0.bias                           : 0.00000, (torch.Size([32]))
2023-03-13 12:37:07,209 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 12:37:07,213 maskrcnn_benchmark INFO: ---Total norm 3.65817 clip coef 1.36680-----------------
2023-03-13 12:37:07,218 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 1.68628, (torch.Size([3072, 5136]))
2023-03-13 12:37:07,218 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.54012, (torch.Size([151, 512]))
2023-03-13 12:37:07,218 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.weight: 1.49138, (torch.Size([4096, 4096]))
2023-03-13 12:37:07,219 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.weight: 1.44834, (torch.Size([4096, 12544]))
2023-03-13 12:37:07,219 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 1.10553, (torch.Size([4096, 12544]))
2023-03-13 12:37:07,219 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.weight: 0.73571, (torch.Size([51, 4096]))
2023-03-13 12:37:07,219 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.73431, (torch.Size([4096, 4096]))
2023-03-13 12:37:07,219 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.67210, (torch.Size([512, 1024]))
2023-03-13 12:37:07,219 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.weight: 0.59774, (torch.Size([4096, 1024]))
2023-03-13 12:37:07,219 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.47195, (torch.Size([2048, 4808]))
2023-03-13 12:37:07,219 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.44340, (torch.Size([2048, 4808]))
2023-03-13 12:37:07,219 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.39214, (torch.Size([256, 1024, 3, 3]))
2023-03-13 12:37:07,219 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.26906, (torch.Size([256, 128, 3, 3]))
2023-03-13 12:37:07,220 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.19984, (torch.Size([2560, 512]))
2023-03-13 12:37:07,220 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.11459, (torch.Size([128, 2, 7, 7]))
2023-03-13 12:37:07,220 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.08767, (torch.Size([512]))
2023-03-13 12:37:07,220 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.08161, (torch.Size([512, 1024]))
2023-03-13 12:37:07,220 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.bias: 0.05464, (torch.Size([51]))
2023-03-13 12:37:07,220 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.05394, (torch.Size([2048, 4424]))
2023-03-13 12:37:07,220 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.05357, (torch.Size([2048, 4424]))
2023-03-13 12:37:07,220 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.04711, (torch.Size([151]))
2023-03-13 12:37:07,220 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.04335, (torch.Size([2048, 512]))
2023-03-13 12:37:07,220 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.04229, (torch.Size([2048, 512]))
2023-03-13 12:37:07,220 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.03591, (torch.Size([22801, 51]))
2023-03-13 12:37:07,220 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.weight: 0.02852, (torch.Size([1024, 512]))
2023-03-13 12:37:07,221 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.02741, (torch.Size([3072]))
2023-03-13 12:37:07,221 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.02425, (torch.Size([128]))
2023-03-13 12:37:07,221 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.01696, (torch.Size([128, 32]))
2023-03-13 12:37:07,221 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.bias : 0.01469, (torch.Size([4096]))
2023-03-13 12:37:07,221 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.01411, (torch.Size([4096]))
2023-03-13 12:37:07,221 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.bias: 0.01397, (torch.Size([4096]))
2023-03-13 12:37:07,221 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01132, (torch.Size([32, 9]))
2023-03-13 12:37:07,221 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.00956, (torch.Size([2048]))
2023-03-13 12:37:07,221 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.00956, (torch.Size([2048]))
2023-03-13 12:37:07,221 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.bias : 0.00952, (torch.Size([1024]))
2023-03-13 12:37:07,221 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.00937, (torch.Size([2048]))
2023-03-13 12:37:07,222 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.00937, (torch.Size([2048]))
2023-03-13 12:37:07,222 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.00909, (torch.Size([512]))
2023-03-13 12:37:07,222 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.00819, (torch.Size([256]))
2023-03-13 12:37:07,222 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.00813, (torch.Size([151, 200]))
2023-03-13 12:37:07,222 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.00771, (torch.Size([2560]))
2023-03-13 12:37:07,222 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.bias: 0.00748, (torch.Size([4096]))
2023-03-13 12:37:07,222 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00649, (torch.Size([2048, 512]))
2023-03-13 12:37:07,222 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00638, (torch.Size([2048, 512]))
2023-03-13 12:37:07,222 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.00546, (torch.Size([128]))
2023-03-13 12:37:07,222 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00494, (torch.Size([4096]))
2023-03-13 12:37:07,222 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00480, (torch.Size([256]))
2023-03-13 12:37:07,223 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00426, (torch.Size([152, 200]))
2023-03-13 12:37:07,223 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00412, (torch.Size([256]))
2023-03-13 12:37:07,223 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00387, (torch.Size([256]))
2023-03-13 12:37:07,223 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00375, (torch.Size([151, 200]))
2023-03-13 12:37:07,223 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00282, (torch.Size([128]))
2023-03-13 12:37:07,223 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00268, (torch.Size([32]))
2023-03-13 12:37:07,224 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00263, (torch.Size([128]))
2023-03-13 12:37:07,224 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00191, (torch.Size([32]))
2023-03-13 12:37:07,224 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00116, (torch.Size([2048]))
2023-03-13 12:37:07,224 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00116, (torch.Size([2048]))
2023-03-13 12:37:07,224 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00116, (torch.Size([2048]))
2023-03-13 12:37:07,224 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00116, (torch.Size([2048]))
2023-03-13 12:37:07,224 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-13 12:37:07,224 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 12:37:07,228 maskrcnn_benchmark INFO: eta: 1 day, 18:04:11  iter: 16000  loss: 0.4957 (0.6816)  ML Loss (cd): -0.2500 (-0.2485)  loss_refine_obj: 0.5400 (0.6558)  loss_rel: 0.1997 (0.2743)  time: 1.5617 (2.3664)  data: 0.0051 (0.7933)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 12:37:07,231 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi/model_0016000.pth
2023-03-13 12:37:43,343 maskrcnn_benchmark INFO: Start validating
2023-03-13 12:37:43,370 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-13 13:02:27,382 maskrcnn_benchmark INFO: Total run time: 0:24:44.011210 (0.5936044839859009 s / img per device, on 2 devices)
2023-03-13 13:02:27,383 maskrcnn_benchmark INFO: Model inference time: 0:19:39.697680 (0.47187907218933106 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(249987, 7)
0/249987
DONE (t=1.58s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=30.38s).
Accumulating evaluation results...
DONE (t=8.06s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.150
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.288
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.140
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.063
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.110
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.189
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.222
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.321
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.323
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.165
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.270
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.355
2023-03-13 13:07:07,729 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2878
====================================================================================================
SGG eval:   R @ 20: 0.2389;   R @ 50: 0.3061;   R @ 100: 0.3418;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2504; ngR @ 50: 0.3361; ngR @ 100: 0.3940;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0074;  zR @ 50: 0.0137;  zR @ 100: 0.0342;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0135;  zR @ 50: 0.0310;  zR @ 100: 0.0475;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0110;  zR @ 50: 0.0403;  zR @ 100: 0.0586;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0236;  zR @ 50: 0.0236;  zR @ 100: 0.0451;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0344;  zR @ 50: 0.0475;  zR @ 100: 0.0716;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0359;  zR @ 50: 0.0632;  zR @ 100: 0.1107;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0361;  zR @ 50: 0.0582;  zR @ 100: 0.0953;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0242;  zR @ 50: 0.0348;  zR @ 100: 0.0525;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0576;  zR @ 50: 0.1115;  zR @ 100: 0.1201;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0351;  zR @ 50: 0.0486;  zR @ 100: 0.0804;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0319;  zR @ 50: 0.0612;  zR @ 100: 0.0943;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0673;  zR @ 50: 0.1119;  zR @ 100: 0.1298;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0130;  zR @ 50: 0.0260;  zR @ 100: 0.0260;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1827;  zR @ 50: 0.2350;  zR @ 100: 0.3106;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.0833;  zR @ 50: 0.1875;  zR @ 100: 0.2083;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1474;  zR @ 50: 0.2051;  zR @ 100: 0.2436;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.3333;  zR @ 50: 0.3333;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0481;  mR @ 50: 0.0644;  mR @ 100: 0.0765;  for mode=sgdet, type=Mean Recall.
(above:0.0372) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.1123) (attached to:0.0000) (behind:0.1801) (belonging to:0.0000) (between:0.0000) (carrying:0.1382) (covered in:0.0714) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.4144) (holding:0.2720) (in:0.1446) (in front of:0.0776) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2334) (of:0.2210) (on:0.4433) (on back of:0.0000) (over:0.0244) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.3705) (says:0.0000) (sitting on:0.0887) (standing on:0.0000) (to:0.0000) (under:0.0816) (using:0.0769) (walking in:0.0000) (walking on:0.1634) (watching:0.0686) (wearing:0.5877) (wears:0.0000) (with:0.0169) 
====================================================================================================

2023-03-13 13:07:08,718 maskrcnn_benchmark INFO: Validation Result: 0.3418
2023-03-13 13:12:31,924 maskrcnn_benchmark INFO: eta: 1 day, 19:44:41  iter: 16200  loss: 0.6042 (0.6802)  ML Loss (cd): -0.2500 (-0.2485)  loss_refine_obj: 0.5815 (0.6546)  loss_rel: 0.2605 (0.2740)  time: 1.6087 (2.4684)  data: 0.0054 (0.8948)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 13:17:57,610 maskrcnn_benchmark INFO: eta: 1 day, 19:25:36  iter: 16400  loss: 0.5264 (0.6789)  ML Loss (cd): -0.2500 (-0.2485)  loss_refine_obj: 0.5334 (0.6536)  loss_rel: 0.2539 (0.2738)  time: 1.5977 (2.4581)  data: 0.0051 (0.8839)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 13:23:22,040 maskrcnn_benchmark INFO: eta: 1 day, 19:06:46  iter: 16600  loss: 0.5394 (0.6776)  ML Loss (cd): -0.2500 (-0.2485)  loss_refine_obj: 0.5670 (0.6524)  loss_rel: 0.2266 (0.2737)  time: 1.6817 (2.4481)  data: 0.0052 (0.8733)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 13:28:46,792 maskrcnn_benchmark INFO: eta: 1 day, 18:48:16  iter: 16800  loss: 0.5174 (0.6764)  ML Loss (cd): -0.2500 (-0.2486)  loss_refine_obj: 0.5445 (0.6515)  loss_rel: 0.2326 (0.2735)  time: 1.6533 (2.4382)  data: 0.0052 (0.8630)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 13:34:12,310 maskrcnn_benchmark INFO: eta: 1 day, 18:30:08  iter: 17000  loss: 0.5783 (0.6751)  ML Loss (cd): -0.2500 (-0.2486)  loss_refine_obj: 0.5591 (0.6505)  loss_rel: 0.2456 (0.2733)  time: 1.6216 (2.4287)  data: 0.0053 (0.8529)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 13:39:35,860 maskrcnn_benchmark INFO: eta: 1 day, 18:12:10  iter: 17200  loss: 0.5819 (0.6736)  ML Loss (cd): -0.2500 (-0.2486)  loss_refine_obj: 0.5659 (0.6493)  loss_rel: 0.2496 (0.2729)  time: 1.6536 (2.4193)  data: 0.0051 (0.8430)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 13:44:59,035 maskrcnn_benchmark INFO: eta: 1 day, 17:54:28  iter: 17400  loss: 0.5141 (0.6723)  ML Loss (cd): -0.2500 (-0.2486)  loss_refine_obj: 0.5597 (0.6482)  loss_rel: 0.2208 (0.2727)  time: 1.5609 (2.4100)  data: 0.0052 (0.8334)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 13:50:22,910 maskrcnn_benchmark INFO: eta: 1 day, 17:37:05  iter: 17600  loss: 0.5676 (0.6713)  ML Loss (cd): -0.2500 (-0.2486)  loss_refine_obj: 0.5555 (0.6474)  loss_rel: 0.2171 (0.2725)  time: 1.6517 (2.4011)  data: 0.0053 (0.8240)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 13:55:47,826 maskrcnn_benchmark INFO: eta: 1 day, 17:20:02  iter: 17800  loss: 0.4660 (0.6700)  ML Loss (cd): -0.2500 (-0.2486)  loss_refine_obj: 0.5118 (0.6464)  loss_rel: 0.2053 (0.2722)  time: 1.6084 (2.3923)  data: 0.0053 (0.8148)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 14:01:11,414 maskrcnn_benchmark INFO: ---Total norm 0.02395 clip coef 208.77243-----------------
2023-03-13 14:01:11,684 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.weight            : 0.01130, (torch.Size([300, 600]))
2023-03-13 14:01:11,684 maskrcnn_benchmark INFO: module.energy.0.weight                            : 0.01073, (torch.Size([300, 600]))
2023-03-13 14:01:11,684 maskrcnn_benchmark INFO: module.energy.2.weight                            : 0.00890, (torch.Size([1, 300]))
2023-03-13 14:01:11,684 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.bias                : 0.00727, (torch.Size([1]))
2023-03-13 14:01:11,684 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_ih                 : 0.00723, (torch.Size([900]))
2023-03-13 14:01:11,685 maskrcnn_benchmark INFO: module.obj_label_embedding.weight                 : 0.00582, (torch.Size([300, 279]))
2023-03-13 14:01:11,685 maskrcnn_benchmark INFO: module.sg_pooler.hgate_node.0.weight              : 0.00533, (torch.Size([1, 300]))
2023-03-13 14:01:11,685 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_hh               : 0.00470, (torch.Size([900, 300]))
2023-03-13 14:01:11,685 maskrcnn_benchmark INFO: module.energy.2.bias                              : 0.00436, (torch.Size([1]))
2023-03-13 14:01:11,685 maskrcnn_benchmark INFO: module.sg_layer.node_gate.bias_hh                 : 0.00362, (torch.Size([900]))
2023-03-13 14:01:11,685 maskrcnn_benchmark INFO: module.sg_layer.node_gate.weight_ih               : 0.00278, (torch.Size([900, 300]))
2023-03-13 14:01:11,685 maskrcnn_benchmark INFO: module.obj_emdedding.weight                       : 0.00246, (torch.Size([300, 4096]))
2023-03-13 14:01:11,685 maskrcnn_benchmark INFO: module.energy.0.bias                              : 0.00210, (torch.Size([300]))
2023-03-13 14:01:11,685 maskrcnn_benchmark INFO: module.obj_label_embedding.bias                   : 0.00141, (torch.Size([300]))
2023-03-13 14:01:11,685 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.bias           : 0.00137, (torch.Size([300]))
2023-03-13 14:01:11,685 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.bias           : 0.00125, (torch.Size([300]))
2023-03-13 14:01:11,686 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.bias              : 0.00090, (torch.Size([300]))
2023-03-13 14:01:11,688 maskrcnn_benchmark INFO: module.sg_pooler.poolingLayer.0.bias              : 0.00090, (torch.Size([300]))
2023-03-13 14:01:11,688 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.bias                : 0.00077, (torch.Size([1]))
2023-03-13 14:01:11,688 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.2.weight         : 0.00076, (torch.Size([300, 300]))
2023-03-13 14:01:11,688 maskrcnn_benchmark INFO: module.pos_embed.2.weight                         : 0.00071, (torch.Size([128, 32]))
2023-03-13 14:01:11,688 maskrcnn_benchmark INFO: module.im_pooler.hgate_node.0.weight              : 0.00070, (torch.Size([1, 300]))
2023-03-13 14:01:11,688 maskrcnn_benchmark INFO: module.im_pooler.poolingLayer.0.weight            : 0.00059, (torch.Size([300, 300]))
2023-03-13 14:01:11,688 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.2.weight         : 0.00059, (torch.Size([300, 300]))
2023-03-13 14:01:11,688 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.bias           : 0.00057, (torch.Size([300]))
2023-03-13 14:01:11,688 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.bias           : 0.00053, (torch.Size([300]))
2023-03-13 14:01:11,688 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_ih                 : 0.00052, (torch.Size([900]))
2023-03-13 14:01:11,689 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_hh               : 0.00049, (torch.Size([900, 300]))
2023-03-13 14:01:11,689 maskrcnn_benchmark INFO: module.sg_layer.edge2node_kernel.0.weight         : 0.00041, (torch.Size([300, 300]))
2023-03-13 14:01:11,689 maskrcnn_benchmark INFO: module.pos_embed.0.weight                         : 0.00028, (torch.Size([32, 9]))
2023-03-13 14:01:11,689 maskrcnn_benchmark INFO: module.im_layer.node_gate.bias_hh                 : 0.00026, (torch.Size([900]))
2023-03-13 14:01:11,689 maskrcnn_benchmark INFO: module.pos_embed.2.bias                           : 0.00026, (torch.Size([128]))
2023-03-13 14:01:11,689 maskrcnn_benchmark INFO: module.im_layer.node_gate.weight_ih               : 0.00023, (torch.Size([900, 300]))
2023-03-13 14:01:11,689 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.bias                : 0.00019, (torch.Size([300]))
2023-03-13 14:01:11,689 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_hh               : 0.00019, (torch.Size([900, 300]))
2023-03-13 14:01:11,689 maskrcnn_benchmark INFO: module.rel_label_embedding.weight                 : 0.00017, (torch.Size([300, 51]))
2023-03-13 14:01:11,689 maskrcnn_benchmark INFO: module.sg_layer.edge_gate.weight_ih               : 0.00015, (torch.Size([900, 300]))
2023-03-13 14:01:11,689 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.bias           : 0.00011, (torch.Size([300]))
2023-03-13 14:01:11,690 maskrcnn_benchmark INFO: module.pos_embed.1.bias                           : 0.00010, (torch.Size([32]))
2023-03-13 14:01:11,690 maskrcnn_benchmark INFO: module.rel_label_embedding.bias                   : 0.00010, (torch.Size([300]))
2023-03-13 14:01:11,690 maskrcnn_benchmark INFO: module.sg_layer.node2node_kernel.0.weight         : 0.00009, (torch.Size([300, 300]))
2023-03-13 14:01:11,690 maskrcnn_benchmark INFO: module.obj_emdedding.bias                         : 0.00009, (torch.Size([300]))
2023-03-13 14:01:11,690 maskrcnn_benchmark INFO: module.im_layer.node_kernel.2.weight              : 0.00009, (torch.Size([300, 300]))
2023-03-13 14:01:11,690 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.bias                : 0.00008, (torch.Size([300]))
2023-03-13 14:01:11,690 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.2.weight         : 0.00008, (torch.Size([300, 300, 1, 1]))
2023-03-13 14:01:11,690 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.weight         : 0.00008, (torch.Size([300, 600, 1, 1]))
2023-03-13 14:01:11,690 maskrcnn_benchmark INFO: module.pos_embed.1.weight                         : 0.00007, (torch.Size([32]))
2023-03-13 14:01:11,690 maskrcnn_benchmark INFO: module.sg_layer.node2edge_kernel.0.bias           : 0.00004, (torch.Size([300]))
2023-03-13 14:01:11,690 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.bias                : 0.00002, (torch.Size([1]))
2023-03-13 14:01:11,691 maskrcnn_benchmark INFO: module.im_layer.node_kernel.0.weight              : 0.00002, (torch.Size([300, 300]))
2023-03-13 14:01:11,693 maskrcnn_benchmark INFO: module.sg_pooler.hgate_edge.0.weight              : 0.00001, (torch.Size([1, 300]))
2023-03-13 14:01:11,694 maskrcnn_benchmark INFO: module.pos_embed.0.bias                           : 0.00000, (torch.Size([32]))
2023-03-13 14:01:11,694 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 14:01:11,698 maskrcnn_benchmark INFO: ---Total norm 2.94954 clip coef 1.69518-----------------
2023-03-13 14:01:11,706 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 1.30522, (torch.Size([4096, 12544]))
2023-03-13 14:01:11,707 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 1.06713, (torch.Size([3072, 5136]))
2023-03-13 14:01:11,707 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.04275, (torch.Size([151, 512]))
2023-03-13 14:01:11,707 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.weight: 1.02159, (torch.Size([51, 4096]))
2023-03-13 14:01:11,707 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.weight: 0.94716, (torch.Size([4096, 4096]))
2023-03-13 14:01:11,707 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.weight: 0.92176, (torch.Size([4096, 12544]))
2023-03-13 14:01:11,707 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.83745, (torch.Size([4096, 4096]))
2023-03-13 14:01:11,707 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.60787, (torch.Size([256, 1024, 3, 3]))
2023-03-13 14:01:11,707 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.weight: 0.51964, (torch.Size([4096, 1024]))
2023-03-13 14:01:11,707 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.50221, (torch.Size([512, 1024]))
2023-03-13 14:01:11,707 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.34145, (torch.Size([256, 128, 3, 3]))
2023-03-13 14:01:11,708 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.32299, (torch.Size([2048, 4808]))
2023-03-13 14:01:11,708 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.29905, (torch.Size([2048, 4808]))
2023-03-13 14:01:11,708 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.16211, (torch.Size([2560, 512]))
2023-03-13 14:01:11,708 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.15578, (torch.Size([128, 2, 7, 7]))
2023-03-13 14:01:11,708 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.07455, (torch.Size([512]))
2023-03-13 14:01:11,708 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.rel_compress.bias: 0.06234, (torch.Size([51]))
2023-03-13 14:01:11,708 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.05699, (torch.Size([512, 1024]))
2023-03-13 14:01:11,708 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.05200, (torch.Size([22801, 51]))
2023-03-13 14:01:11,708 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.03844, (torch.Size([2048, 4424]))
2023-03-13 14:01:11,708 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.03757, (torch.Size([2048, 4424]))
2023-03-13 14:01:11,708 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.03564, (torch.Size([128]))
2023-03-13 14:01:11,709 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.03300, (torch.Size([2048, 512]))
2023-03-13 14:01:11,709 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.03297, (torch.Size([2048, 512]))
2023-03-13 14:01:11,709 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.03140, (torch.Size([151]))
2023-03-13 14:01:11,709 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.weight: 0.02369, (torch.Size([1024, 512]))
2023-03-13 14:01:11,709 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.02161, (torch.Size([128, 32]))
2023-03-13 14:01:11,709 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.01844, (torch.Size([3072]))
2023-03-13 14:01:11,709 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01625, (torch.Size([32, 9]))
2023-03-13 14:01:11,709 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.01408, (torch.Size([4096]))
2023-03-13 14:01:11,709 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_cat.bias : 0.01361, (torch.Size([4096]))
2023-03-13 14:01:11,709 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.01280, (torch.Size([256]))
2023-03-13 14:01:11,709 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc7.bias: 0.00972, (torch.Size([4096]))
2023-03-13 14:01:11,709 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.post_emb.bias : 0.00875, (torch.Size([1024]))
2023-03-13 14:01:11,710 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.00861, (torch.Size([128]))
2023-03-13 14:01:11,710 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.00808, (torch.Size([2048]))
2023-03-13 14:01:11,710 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.00808, (torch.Size([2048]))
2023-03-13 14:01:11,710 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.00759, (torch.Size([2048]))
2023-03-13 14:01:11,710 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.00759, (torch.Size([2048]))
2023-03-13 14:01:11,710 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.00709, (torch.Size([512]))
2023-03-13 14:01:11,710 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00651, (torch.Size([256]))
2023-03-13 14:01:11,710 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.00593, (torch.Size([2560]))
2023-03-13 14:01:11,710 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00557, (torch.Size([4096]))
2023-03-13 14:01:11,711 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00555, (torch.Size([256]))
2023-03-13 14:01:11,711 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00525, (torch.Size([256]))
2023-03-13 14:01:11,711 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00502, (torch.Size([2048, 512]))
2023-03-13 14:01:11,711 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00494, (torch.Size([2048, 512]))
2023-03-13 14:01:11,711 maskrcnn_benchmark INFO: module.roi_heads.relation.box_feature_extractor.fc6.bias: 0.00474, (torch.Size([4096]))
2023-03-13 14:01:11,711 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.00445, (torch.Size([151, 200]))
2023-03-13 14:01:11,711 maskrcnn_benchmark INFO: module.roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00371, (torch.Size([128]))
2023-03-13 14:01:11,711 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00322, (torch.Size([152, 200]))
2023-03-13 14:01:11,711 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00276, (torch.Size([151, 200]))
2023-03-13 14:01:11,711 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00274, (torch.Size([32]))
2023-03-13 14:01:11,711 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00273, (torch.Size([128]))
2023-03-13 14:01:11,712 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00251, (torch.Size([32]))
2023-03-13 14:01:11,712 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00097, (torch.Size([2048]))
2023-03-13 14:01:11,712 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00097, (torch.Size([2048]))
2023-03-13 14:01:11,712 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00093, (torch.Size([2048]))
2023-03-13 14:01:11,712 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00093, (torch.Size([2048]))
2023-03-13 14:01:11,712 maskrcnn_benchmark INFO: module.roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-13 14:01:11,712 maskrcnn_benchmark INFO: -------------------------------
2023-03-13 14:01:11,716 maskrcnn_benchmark INFO: eta: 1 day, 17:03:11  iter: 18000  loss: 0.5008 (0.6691)  ML Loss (cd): -0.2500 (-0.2486)  loss_refine_obj: 0.5352 (0.6457)  loss_rel: 0.2441 (0.2721)  time: 1.6663 (2.3837)  data: 0.0052 (0.8058)  energy lr: 0.000100  base lr : 0.000100  max mem: 4980
2023-03-13 14:01:11,721 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sgdet_energy_multi/model_0018000.pth
2023-03-13 14:01:52,894 maskrcnn_benchmark INFO: Start validating
2023-03-13 14:01:52,916 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
