2023-03-05 17:39:31,141 maskrcnn_benchmark INFO: Using 1 GPUs
2023-03-05 17:39:31,141 maskrcnn_benchmark INFO: Namespace(config_file='configs/e2e_relation_X_101_32_8_FPN_1x_energy.yaml', local_rank=0, skip_test=False, opts=[], slurm_id=None, distributed=False)
2023-03-05 17:39:31,141 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2023-03-05 17:39:32,161 maskrcnn_benchmark INFO: 
PyTorch version: 1.13.0+cu117
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Fedora Linux 37 (KDE Plasma) (x86_64)
GCC version: (GCC) 12.2.1 20221121 (Red Hat 12.2.1-4)
Clang version: 15.0.7 (Fedora 15.0.7-1.fc37)
CMake version: version 3.26.0-rc4
Libc version: glibc-2.36

Python version: 3.10.8 (main, Nov 24 2022, 14:13:03) [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.1.11-200.fc37.x86_64-x86_64-with-glibc2.36
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA GeForce RTX 3080 Ti
GPU 1: NVIDIA GeForce RTX 3080 Ti

Nvidia driver version: 525.89.02
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] numpy==1.23.5
[pip3] torch==1.13.0
[pip3] torch-scatter==2.1.0
[pip3] torchaudio==0.13.0
[pip3] torchvision==0.14.0
[conda] Could not collect
        Pillow (9.3.0)
2023-03-05 17:39:32,162 maskrcnn_benchmark INFO: Loaded configuration file configs/e2e_relation_X_101_32_8_FPN_1x_energy.yaml
2023-03-05 17:39:32,162 maskrcnn_benchmark INFO: 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
MODEL:
  META_ARCHITECTURE: "GeneralizedRCNN"
  WEIGHT: "catalog://ImageNetPretrained/FAIR/20171220/X-101-32x8d"
  PRETRAINED_DETECTOR_CKPT: "/users/students/r0879687/amager/vg/pretrained-detector/pretrained_faster_rcnn/model_final.pth"
  BACKBONE:
    CONV_BODY: "R-101-FPN" # VGG-16
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    STRIDE_IN_1X1: False
    NUM_GROUPS: 32
    WIDTH_PER_GROUP: 8
  BASE_ONLY: False           # When training energy model set this to false.
  RELATION_ON: True
  ATTRIBUTE_ON: False
  FLIP_AUG: False            # if there is any left-right relation, FLIP AUG should be false
  RPN:
    USE_FPN: True
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)   # from neural-motifs
    PRE_NMS_TOP_N_TRAIN: 6000
    PRE_NMS_TOP_N_TEST: 6000
    POST_NMS_TOP_N_TRAIN: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_PER_BATCH: False
    RPN_MID_CHANNEL: 256
  ROI_HEADS:
    USE_FPN: True
    POSITIVE_FRACTION: 0.5
    BG_IOU_THRESHOLD: 0.3
    BATCH_SIZE_PER_IMAGE: 256
    DETECTIONS_PER_IMG: 80
    NMS_FILTER_DUPLICATES: True
  ROI_BOX_HEAD:
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    NUM_CLASSES: 151                # 151 for VG, 1201 for GQA
    MLP_HEAD_DIM: 4096
  ROI_ATTRIBUTE_HEAD:
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    USE_BINARY_LOSS: True           # choose binary, because cross_entropy loss deteriorate the box head, even with 0.1 weight
    POS_WEIGHT: 50.0
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    NUM_ATTRIBUTES: 201             # 201 for VG, 501 for GQA
    MAX_ATTRIBUTES: 10             
    ATTRIBUTE_BGFG_SAMPLE: True    
    ATTRIBUTE_BGFG_RATIO: 3        
  ROI_RELATION_HEAD:
    USE_GT_BOX: False
    USE_GT_OBJECT_LABEL: False
    REQUIRE_BOX_OVERLAP: False              # for sgdet, during training, only train pairs with overlap
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True    # for sgdet only, in case some gt boxes are missing
    NUM_CLASSES: 51                 # 51 for VG, 201 for GQA (not contain "to the left of" & "to the right of")
    BATCH_SIZE_PER_IMAGE: 1024      # sample as much as possible
    POSITIVE_FRACTION: 0.25
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_HIDDEN_DIM: 512         #1024 for VCTree
    POOLING_ALL_LEVELS: True
    LABEL_SMOOTHING_LOSS: False
    FEATURE_EXTRACTOR: "RelationFeatureExtractor"
    #################### Select Relationship Model ####################
    PREDICTOR: "MotifPredictor"
    #PREDICTOR: "VCTreePredictor"
    #PREDICTOR: "TransformerPredictor"
    #PREDICTOR: "CausalAnalysisPredictor"
    ################# Parameters for Motif Predictor ##################
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_REL_LAYER: 1
    ############# Parameters for Causal Unbias Predictor ##############
    ### Implementation for paper "Unbiased Scene Graph Generation from Biased Training"
    CAUSAL:
      EFFECT_TYPE: 'none'             # candicates: 'TDE', 'NIE', 'TE', 'none'
      FUSION_TYPE: 'sum'              # candicates: 'sum', 'gate'         
      SEPARATE_SPATIAL: False         # separate spatial in union feature
      CONTEXT_LAYER: "motifs"         # candicates: motifs, vctree, vtranse
      SPATIAL_FOR_VISION: True
      EFFECT_ANALYSIS: True
    ############### Parameters for Transformer Predictor ##############
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      OBJ_LAYER: 4
      REL_LAYER: 2
      NUM_HEAD: 8
      KEY_DIM: 64
      VAL_DIM: 64
      INNER_DIM: 2048
    ############### Parameters for Energy Model ##############
    EBM:
      OBJ_EMBED_DIM: 384
      REL_EMBED_DIM: 384
      OBJ_LABEL_EMBED_DIM: 384
      REL_LABEL_EMBED_DIM: 384
      POOLING_DIM: 384
DATASETS:
  TRAIN: ("VG_stanford_filtered_with_attribute_train",)
  VAL: ("VG_stanford_filtered_with_attribute_val",)
  TEST: ("VG_stanford_filtered_with_attribute_test",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
SOLVER:
  PRE_VAL: False
  IMS_PER_BATCH: 2
  BIAS_LR_FACTOR: 1
  BASE_LR: 0.0025
  WARMUP_FACTOR: 0.1
  WEIGHT_DECAY: 0.0001
  MOMENTUM: 0.9
  GRAD_NORM_CLIP: 5.0
  STEPS: [0, 30000, 40000 ]
  MAX_ITER: 60000
  VAL_PERIOD: 2000
  CHECKPOINT_PERIOD: 2000
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    # the following paramters are only used for WarmupReduceLROnPlateau
    TYPE: "WarmupReduceLROnPlateau"    # WarmupMultiStepLR, WarmupReduceLROnPlateau
    #TYPE: "WarmupMultiStepLR"
    PATIENCE: 2
    THRESHOLD: 0.001
    COOLDOWN: 0
    FACTOR: 0.05   #0.1
    MAX_DECAY_STEP: 3

#OUTPUT_DIR: '/users/students/r0879687/amager/vg/output/relation_baseline_predcls_energy_bs4'
#OUTPUT_DIR: '/users/students/r0879687/amager/vg/output/relation_baseline_sggcls_energy_bs4'
OUTPUT_DIR: '/users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2'

TEST:
  IMS_PER_BATCH: 1
  ALLOW_LOAD_FROM_CACHE: False
  RELATION:
    SYNC_GATHER: False      # turn on will slow down the evaluation to solve the sgdet test out of memory problem
    REQUIRE_OVERLAP: False
    LATER_NMS_PREDICTION_THRES: 0.5

  # Equival schedules with...
  # 1 GPU:
  #   BASE_LR: 0.0025
  #   MAX_ITER: 60000
  #   STEPS: [0, 30000, 40000]
  # 2 GPUs:
  #   BASE_LR: 0.005
  #   MAX_ITER: 30000
  #   STEPS: [0, 15000, 20000]
  # 4 GPUs:
  #   BASE_LR: 0.01
  #   MAX_ITER: 15000
  #   STEPS: [0, 7500, 10000]
  # 8 GPUs:
  #   BASE_LR: 0.02
  #   MAX_ITER: 7500
  #   STEPS: [0, 3750, 5000]

2023-03-05 17:39:32,163 maskrcnn_benchmark INFO: Running with config:
AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  NUM_OBJ_CLASSES: 151
  NUM_REL_CLASSES: 51
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
ENERGY_MODEL:
  DATA_NOISE_VAR: 0.0001
  L2COEFF: 1
  LOSS: ContrastiveDivergence
  META_ARCHITECTURE: GraphEnergyModel
  TEMP: 1
  TRAINIG_MODE: joint
GLOVE_DIR: /users/students/r0879687/amager/vg/glove
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  FLIP_PROB_TRAIN: 0
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  BASE_ONLY: False
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  DEV_RUN: False
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: /users/students/r0879687/amager/vg/pretrained-detector/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 80
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 1024
    CAUSAL:
      CONTEXT_LAYER: motifs
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 512
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EBM:
      OBJ_EMBED_DIM: 384
      OBJ_LABEL_EMBED_DIM: 384
      POOLING_DIM: 384
      REL_EMBED_DIM: 384
      REL_LABEL_EMBED_DIM: 384
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: MotifPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: False
    USE_GT_OBJECT_LABEL: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: catalog://ImageNetPretrained/FAIR/20171220/X-101-32x8d
OUTPUT_DIR: /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2
PATHS_CATALOG: /users/students/r0879687/Documents/Master_thesis/ebm/energy-based-scene-graph/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /users/students/r0879687/amager/vg/VG_100K
SAMPLER:
  GRAD_CLIP: 0.01
  ITERS: 10
  LR: 0.1
  NAME: SGLD
  VAR: 0.001
SOLVER:
  BASE_LR: 0.0025
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 2
  MAX_ITER: 60000
  MOMENTUM: 0.9
  PRE_VAL: False
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.05
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupReduceLROnPlateau
  STEPS: (0, 30000, 40000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 1
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: False
  SAVE_PROPOSALS: False
WANDB:
  MUTE: False
2023-03-05 17:39:32,163 maskrcnn_benchmark INFO: Saving config into: /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/config.yml
2023-03-05 17:39:32,210 maskrcnn_benchmark INFO: #################### prepare training ####################
2023-03-05 17:39:32,211 maskrcnn_benchmark.modeling.detector.generalized_rcnn INFO: #################### Building Backbone ####################
2023-03-05 17:39:32,977 maskrcnn_benchmark.modeling.detector.generalized_rcnn INFO: #################### Building RPN ####################
2023-03-05 17:39:32,985 maskrcnn_benchmark.modeling.detector.generalized_rcnn INFO: #################### Building ROI Heads ####################
2023-03-05 17:39:34,764 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
2023-03-05 17:39:34,765 maskrcnn_benchmark.data.build INFO: get dataset statistics...
2023-03-05 17:42:17,672 maskrcnn_benchmark.data.build INFO: finish
2023-03-05 17:42:17,674 maskrcnn_benchmark.data.build INFO: Save data statistics to: /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/VG_stanford_filtered_with_attribute_train_statistics.cache
2023-03-05 17:42:17,674 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
loading word vectors from /users/students/r0879687/amager/vg/glove/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
loading word vectors from /users/students/r0879687/amager/vg/glove/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
2023-03-05 17:42:37,152 maskrcnn_benchmark INFO: #################### end base model construction ####################
2023-03-05 17:42:37,190 maskrcnn_benchmark INFO: #################### End energy Model Constructin ####################
2023-03-05 17:42:38,077 maskrcnn_benchmark INFO: #################### end optimizer and scheduler ####################
2023-03-05 17:42:38,078 maskrcnn_benchmark INFO: #################### end distributed ####################
2023-03-05 17:42:38,079 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from /users/students/r0879687/amager/vg/pretrained-detector/pretrained_faster_rcnn/model_final.pth
2023-03-05 17:42:38,503 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.box_feature_extractor.fc6.bias in current model to roi_heads.box.feature_extractor.fc6.bias in loaded model.
2023-03-05 17:42:38,503 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.box_feature_extractor.fc6.weight in current model to roi_heads.box.feature_extractor.fc6.weight in loaded model.
2023-03-05 17:42:38,503 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.box_feature_extractor.fc7.bias in current model to roi_heads.box.feature_extractor.fc7.bias in loaded model.
2023-03-05 17:42:38,503 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.box_feature_extractor.fc7.weight in current model to roi_heads.box.feature_extractor.fc7.weight in loaded model.
2023-03-05 17:42:38,503 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias in current model to roi_heads.box.feature_extractor.fc6.bias in loaded model.
2023-03-05 17:42:38,503 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight in current model to roi_heads.box.feature_extractor.fc6.weight in loaded model.
2023-03-05 17:42:38,503 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias in current model to roi_heads.box.feature_extractor.fc7.bias in loaded model.
2023-03-05 17:42:38,503 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight in current model to roi_heads.box.feature_extractor.fc7.weight in loaded model.
2023-03-05 17:42:38,503 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias in current model to roi_heads.box.feature_extractor.pooler.reduce_channel.0.bias in loaded model.
2023-03-05 17:42:38,503 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight in current model to roi_heads.box.feature_extractor.pooler.reduce_channel.0.weight in loaded model.
2023-03-05 17:42:38,547 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.box_feature_extractor.fc6.bias                                           loaded from roi_heads.box.feature_extractor.fc6.bias         of shape (4096,)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.box_feature_extractor.fc6.weight                                         loaded from roi_heads.box.feature_extractor.fc6.weight       of shape (4096, 12544)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.box_feature_extractor.fc7.bias                                           loaded from roi_heads.box.feature_extractor.fc7.bias         of shape (4096,)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.box_feature_extractor.fc7.weight                                         loaded from roi_heads.box.feature_extractor.fc7.weight       of shape (4096, 4096)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias of shape (3072,)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight of shape (3072, 5136)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight of shape (152, 200)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias of shape (151,)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight of shape (151, 512)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias of shape (2560,)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight of shape (2560, 512)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0 of shape (2048,)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse of shape (2048,)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0 of shape (2048,)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse of shape (2048,)
2023-03-05 17:42:38,548 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0 of shape (2048, 512)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse of shape (2048, 512)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0 of shape (2048, 4808)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse of shape (2048, 4808)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.lin_edge_h.bias of shape (512,)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.lin_edge_h.weight of shape (512, 1024)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.lin_obj_h.bias of shape (512,)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.lin_obj_h.weight of shape (512, 1024)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0 of shape (2048,)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse of shape (2048,)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0 of shape (2048,)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse of shape (2048,)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0 of shape (2048, 512)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse of shape (2048, 512)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0 of shape (2048, 4424)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse of shape (2048, 4424)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.obj_embed1.weight of shape (151, 200)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.obj_embed2.weight of shape (151, 200)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.pos_embed.0.bias of shape (32,)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.pos_embed.0.weight of shape (32, 9)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.pos_embed.1.bias of shape (32,)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.pos_embed.1.num_batches_tracked of shape ()
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.pos_embed.1.running_mean of shape (32,)
2023-03-05 17:42:38,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.pos_embed.1.running_var of shape (32,)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.pos_embed.1.weight of shape (32,)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.pos_embed.2.bias of shape (128,)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.pos_embed.2.weight of shape (128, 32)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.untreated_dcd_feat of shape (4936,)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.untreated_edg_feat of shape (4296,)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.context_layer.untreated_obj_feat of shape (4424,)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias.obj_baseline.weight of shape (22801, 51)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.post_cat.bias of shape (4096,)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.post_cat.weight of shape (4096, 1024)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.post_emb.bias of shape (1024,)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.post_emb.weight of shape (1024, 512)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress.bias of shape (51,)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress.weight of shape (51, 4096)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias                       loaded from roi_heads.box.feature_extractor.fc6.bias         of shape (4096,)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight                     loaded from roi_heads.box.feature_extractor.fc6.weight       of shape (4096, 12544)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias                       loaded from roi_heads.box.feature_extractor.fc7.bias         of shape (4096,)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight                     loaded from roi_heads.box.feature_extractor.fc7.weight       of shape (4096, 4096)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias of shape (256,)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight of shape (256, 1024, 3, 3)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.0.bias of shape (128,)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.0.weight of shape (128, 2, 7, 7)
2023-03-05 17:42:38,550 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.2.bias of shape (128,)
2023-03-05 17:42:38,551 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.2.num_batches_tracked of shape ()
2023-03-05 17:42:38,551 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.2.running_mean of shape (128,)
2023-03-05 17:42:38,551 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.2.running_var of shape (128,)
2023-03-05 17:42:38,551 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.2.weight of shape (128,)
2023-03-05 17:42:38,551 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.4.bias of shape (256,)
2023-03-05 17:42:38,551 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.4.weight of shape (256, 128, 3, 3)
2023-03-05 17:42:38,551 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.6.bias of shape (256,)
2023-03-05 17:42:38,551 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.6.num_batches_tracked of shape ()
2023-03-05 17:42:38,551 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.6.running_mean of shape (256,)
2023-03-05 17:42:38,551 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.6.running_var of shape (256,)
2023-03-05 17:42:38,551 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.union_feature_extractor.rect_conv.6.weight of shape (256,)
2023-03-05 17:42:38,683 maskrcnn_benchmark INFO: #################### end load checkpointer ####################
2023-03-05 17:42:38,683 maskrcnn_benchmark.data.build WARNING: When using more than one image per GPU you may encounter an out-of-memory (OOM) error if your GPU does not have sufficient memory. If this happens, you can reduce SOLVER.IMS_PER_BATCH (for training) or TEST.IMS_PER_BATCH (for inference). For training, you must also adjust the learning rate and schedule length according to the linear scaling rule. See for example: https://github.com/facebookresearch/Detectron/blob/master/configs/getting_started/tutorial_1gpu_e2e_faster_rcnn_R-50-FPN.yaml#L14
2023-03-05 17:43:54,455 maskrcnn_benchmark.utils.miscellaneous INFO: Saving labels mapping into /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/labels.json
2023-03-05 17:43:55,535 maskrcnn_benchmark INFO: #################### end dataloader ####################
2023-03-05 17:43:55,535 maskrcnn_benchmark INFO: Start training
2023-03-05 17:44:05,729 maskrcnn_benchmark INFO: ---Total norm 0.62442 clip coef 8.00741-----------------
2023-03-05 17:44:05,733 maskrcnn_benchmark INFO: energy.0.weight                                   : 0.29279, (torch.Size([384, 768]))
2023-03-05 17:44:05,733 maskrcnn_benchmark INFO: obj_emdedding.weight                              : 0.25825, (torch.Size([384, 4096]))
2023-03-05 17:44:05,733 maskrcnn_benchmark INFO: sg_pooler.poolingLayer.0.weight                   : 0.19580, (torch.Size([384, 768]))
2023-03-05 17:44:05,733 maskrcnn_benchmark INFO: sg_pooler.hgate_edge.0.bias                       : 0.19495, (torch.Size([1]))
2023-03-05 17:44:05,733 maskrcnn_benchmark INFO: energy.2.weight                                   : 0.18990, (torch.Size([1, 384]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: energy.0.bias                                     : 0.17924, (torch.Size([384]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: im_pooler.poolingLayer.0.weight                   : 0.11418, (torch.Size([384, 384]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: sg_pooler.hgate_edge.0.weight                     : 0.10652, (torch.Size([1, 384]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: sg_layer.edge_gate.weight_ih                      : 0.08687, (torch.Size([1152, 384]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: im_layer.node_gate.bias_ih                        : 0.07833, (torch.Size([1152]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: sg_layer.edge_gate.weight_hh                      : 0.07756, (torch.Size([1152, 384]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: sg_pooler.poolingLayer.0.bias                     : 0.07501, (torch.Size([384]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: im_pooler.poolingLayer.0.bias                     : 0.07276, (torch.Size([384]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: obj_label_embedding.weight                        : 0.06597, (torch.Size([384, 279]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.0.weight                : 0.06090, (torch.Size([384, 768, 1, 1]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: im_layer.node_gate.weight_hh                      : 0.05704, (torch.Size([1152, 384]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.2.weight                : 0.05540, (torch.Size([384, 384, 1, 1]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: sg_layer.node_gate.weight_hh                      : 0.05053, (torch.Size([1152, 384]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.2.bias                  : 0.04896, (torch.Size([384]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: energy.2.bias                                     : 0.04408, (torch.Size([1]))
2023-03-05 17:44:05,734 maskrcnn_benchmark INFO: im_pooler.hgate_node.0.weight                     : 0.04305, (torch.Size([1, 384]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: im_pooler.hgate_node.0.bias                       : 0.04164, (torch.Size([1]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.2.weight                : 0.04045, (torch.Size([384, 384]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: sg_layer.node_gate.weight_ih                      : 0.03956, (torch.Size([1152, 384]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: im_layer.node_gate.bias_hh                        : 0.03933, (torch.Size([1152]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.0.weight                : 0.03608, (torch.Size([384, 384]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: sg_layer.node_gate.bias_ih                        : 0.03415, (torch.Size([1152]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: im_layer.node_gate.weight_ih                      : 0.03330, (torch.Size([1152, 384]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: rel_label_embedding.weight                        : 0.03298, (torch.Size([384, 51]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: im_layer.node_kernel.2.bias                       : 0.03108, (torch.Size([384]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: rel_label_embedding.bias                          : 0.02632, (torch.Size([384]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: sg_pooler.hgate_node.0.weight                     : 0.02011, (torch.Size([1, 384]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: sg_layer.node_gate.bias_hh                        : 0.01729, (torch.Size([1152]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.0.bias                  : 0.01645, (torch.Size([384]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: obj_emdedding.bias                                : 0.01453, (torch.Size([384]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: im_layer.node_kernel.2.weight                     : 0.01325, (torch.Size([384, 384]))
2023-03-05 17:44:05,735 maskrcnn_benchmark INFO: im_layer.node_kernel.0.bias                       : 0.01318, (torch.Size([384]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.2.bias                  : 0.00972, (torch.Size([384]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.2.bias                  : 0.00850, (torch.Size([384]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: pos_embed.2.weight                                : 0.00834, (torch.Size([128, 32]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: obj_label_embedding.bias                          : 0.00800, (torch.Size([384]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: sg_pooler.hgate_node.0.bias                       : 0.00629, (torch.Size([1]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: pos_embed.0.weight                                : 0.00581, (torch.Size([32, 9]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.2.weight                : 0.00541, (torch.Size([384, 384]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.0.bias                  : 0.00498, (torch.Size([384]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.0.weight                : 0.00473, (torch.Size([384, 384]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.0.bias                  : 0.00428, (torch.Size([384]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: im_layer.node_kernel.0.weight                     : 0.00333, (torch.Size([384, 384]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: pos_embed.2.bias                                  : 0.00199, (torch.Size([128]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: pos_embed.1.bias                                  : 0.00106, (torch.Size([32]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: pos_embed.1.weight                                : 0.00070, (torch.Size([32]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: pos_embed.0.bias                                  : 0.00000, (torch.Size([32]))
2023-03-05 17:44:05,736 maskrcnn_benchmark INFO: -------------------------------
2023-03-05 17:44:05,741 maskrcnn_benchmark INFO: ---Total norm 6.42878 clip coef 0.77775-----------------
2023-03-05 17:44:05,745 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 4.16643, (torch.Size([3072, 5136]))
2023-03-05 17:44:05,745 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc7.weight: 3.67486, (torch.Size([4096, 4096]))
2023-03-05 17:44:05,745 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc6.weight: 2.31250, (torch.Size([4096, 12544]))
2023-03-05 17:44:05,745 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.30445, (torch.Size([151, 512]))
2023-03-05 17:44:05,745 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 1.01059, (torch.Size([4096, 12544]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.83251, (torch.Size([151]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.79721, (torch.Size([4096, 4096]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.45299, (torch.Size([512, 1024]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_cat.weight      : 0.43083, (torch.Size([4096, 1024]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.predictor.rel_compress.weight  : 0.41567, (torch.Size([51, 4096]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.28221, (torch.Size([256, 1024, 3, 3]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.28134, (torch.Size([3072]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.26321, (torch.Size([2048, 4808]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.25593, (torch.Size([2048, 4808]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.21980, (torch.Size([512, 1024]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.20071, (torch.Size([256, 128, 3, 3]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.18388, (torch.Size([2560, 512]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.12053, (torch.Size([2560]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.11998, (torch.Size([512]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.10912, (torch.Size([2048, 4424]))
2023-03-05 17:44:05,746 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.10597, (torch.Size([2048, 4424]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc7.bias : 0.09043, (torch.Size([4096]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.predictor.rel_compress.bias    : 0.07724, (torch.Size([51]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.07359, (torch.Size([128, 2, 7, 7]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.05389, (torch.Size([512]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.05379, (torch.Size([2048, 512]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.05148, (torch.Size([2048, 512]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.03137, (torch.Size([128, 32]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.02219, (torch.Size([2048, 512]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc6.bias : 0.02193, (torch.Size([4096]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.02049, (torch.Size([2048, 512]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.02005, (torch.Size([2048]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.02005, (torch.Size([2048]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_cat.bias        : 0.01987, (torch.Size([4096]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.01920, (torch.Size([2048]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.01920, (torch.Size([2048]))
2023-03-05 17:44:05,747 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_emb.weight      : 0.01868, (torch.Size([1024, 512]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.01823, (torch.Size([151, 200]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.01822, (torch.Size([22801, 51]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01654, (torch.Size([32, 9]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.01348, (torch.Size([128]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_emb.bias        : 0.01237, (torch.Size([1024]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.01196, (torch.Size([128]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.00819, (torch.Size([4096]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00772, (torch.Size([152, 200]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00769, (torch.Size([2048]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00769, (torch.Size([2048]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00752, (torch.Size([2048]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00752, (torch.Size([2048]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00681, (torch.Size([32]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.00566, (torch.Size([256]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00416, (torch.Size([151, 200]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00394, (torch.Size([4096]))
2023-03-05 17:44:05,748 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.00382, (torch.Size([128]))
2023-03-05 17:44:05,749 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00346, (torch.Size([32]))
2023-03-05 17:44:05,749 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00324, (torch.Size([256]))
2023-03-05 17:44:05,749 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00301, (torch.Size([256]))
2023-03-05 17:44:05,749 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00297, (torch.Size([256]))
2023-03-05 17:44:05,749 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00197, (torch.Size([128]))
2023-03-05 17:44:05,749 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-05 17:44:05,749 maskrcnn_benchmark INFO: -------------------------------
2023-03-05 17:47:11,154 maskrcnn_benchmark INFO: eta: 16:14:49  iter: 200  loss: 1.0679 (1.7638)  loss_rel: 0.1812 (0.2027)  loss_refine_obj: 1.0709 (1.7553)  ML Loss (cd): -0.2465 (-0.1942)  time: 0.9279 (0.9781)  data: 0.0037 (0.0074)  energy lr: 0.002291  base lr : 0.002291  max mem: 6919
2023-03-05 17:50:18,053 maskrcnn_benchmark INFO: eta: 15:49:55  iter: 400  loss: 0.8872 (1.3645)  loss_rel: 0.1806 (0.1891)  loss_refine_obj: 0.9420 (1.3956)  ML Loss (cd): -0.2478 (-0.2202)  time: 0.9316 (0.9563)  data: 0.0037 (0.0056)  energy lr: 0.004091  base lr : 0.004091  max mem: 6919
2023-03-05 17:53:26,221 maskrcnn_benchmark INFO: eta: 15:41:37  iter: 600  loss: 0.7749 (1.1962)  loss_rel: 0.1313 (0.1831)  loss_refine_obj: 0.8976 (1.2418)  ML Loss (cd): -0.2490 (-0.2287)  time: 0.9337 (0.9511)  data: 0.0038 (0.0050)  energy lr: 0.005000  base lr : 0.005000  max mem: 6919
2023-03-05 17:56:33,426 maskrcnn_benchmark INFO: eta: 15:34:43  iter: 800  loss: 0.6336 (1.0682)  loss_rel: 0.1508 (0.1807)  loss_refine_obj: 0.6428 (1.1210)  ML Loss (cd): -0.2489 (-0.2336)  time: 0.9388 (0.9474)  data: 0.0037 (0.0048)  energy lr: 0.005000  base lr : 0.005000  max mem: 6919
2023-03-05 17:59:41,034 maskrcnn_benchmark INFO: eta: 15:29:44  iter: 1000  loss: 0.5914 (0.9830)  loss_rel: 0.1512 (0.1811)  loss_refine_obj: 0.5980 (1.0381)  ML Loss (cd): -0.2490 (-0.2363)  time: 0.9324 (0.9455)  data: 0.0036 (0.0046)  energy lr: 0.005000  base lr : 0.005000  max mem: 6919
2023-03-05 18:02:47,672 maskrcnn_benchmark INFO: eta: 15:24:34  iter: 1200  loss: 0.5010 (0.9119)  loss_rel: 0.1703 (0.1812)  loss_refine_obj: 0.5209 (0.9690)  ML Loss (cd): -0.2494 (-0.2383)  time: 0.9314 (0.9434)  data: 0.0037 (0.0045)  energy lr: 0.005000  base lr : 0.005000  max mem: 6919
2023-03-05 18:05:55,118 maskrcnn_benchmark INFO: eta: 15:20:33  iter: 1400  loss: 0.4954 (0.8600)  loss_rel: 0.1750 (0.1790)  loss_refine_obj: 0.5332 (0.9209)  ML Loss (cd): -0.2498 (-0.2399)  time: 0.9299 (0.9426)  data: 0.0036 (0.0044)  energy lr: 0.005000  base lr : 0.005000  max mem: 6919
2023-03-05 18:09:02,413 maskrcnn_benchmark INFO: eta: 15:16:40  iter: 1600  loss: 0.5671 (0.8218)  loss_rel: 0.1186 (0.1777)  loss_refine_obj: 0.6193 (0.8852)  ML Loss (cd): -0.2497 (-0.2411)  time: 0.9387 (0.9418)  data: 0.0039 (0.0044)  energy lr: 0.005000  base lr : 0.005000  max mem: 6919
2023-03-05 18:12:09,200 maskrcnn_benchmark INFO: eta: 15:12:41  iter: 1800  loss: 0.4986 (0.7893)  loss_rel: 0.1126 (0.1764)  loss_refine_obj: 0.6219 (0.8550)  ML Loss (cd): -0.2499 (-0.2420)  time: 0.9424 (0.9409)  data: 0.0036 (0.0043)  energy lr: 0.005000  base lr : 0.005000  max mem: 6919
2023-03-05 18:15:15,209 maskrcnn_benchmark INFO: eta: 15:08:30  iter: 2000  loss: 0.5102 (0.7603)  loss_rel: 0.1452 (0.1763)  loss_refine_obj: 0.5614 (0.8267)  ML Loss (cd): -0.2498 (-0.2427)  time: 0.9324 (0.9398)  data: 0.0037 (0.0043)  energy lr: 0.005000  base lr : 0.005000  max mem: 6919
2023-03-05 18:15:15,214 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/model_0002000.pth
2023-03-05 18:16:07,924 maskrcnn_benchmark INFO: Start validating
2023-03-05 18:16:07,985 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-05 18:41:04,701 maskrcnn_benchmark INFO: Total run time: 0:24:56.715655 (0.29934313101768495 s / img per device, on 1 devices)
2023-03-05 18:41:04,702 maskrcnn_benchmark INFO: Model inference time: 0:22:58.617413 (0.2757234825134277 s / img per device, on 1 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(398905, 7)
0/398905
DONE (t=1.81s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=29.54s).
Accumulating evaluation results...
DONE (t=7.20s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.138
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.270
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.127
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.060
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.103
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.175
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.218
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.325
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.329
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.172
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.278
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.359
2023-03-05 18:46:32,634 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2698
====================================================================================================
SGG eval:   R @ 20: 0.2126;   R @ 50: 0.2817;   R @ 100: 0.3275;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2168; ngR @ 50: 0.2972; ngR @ 100: 0.3609;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0085;  zR @ 100: 0.0254;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0060;  zR @ 50: 0.0120;  zR @ 100: 0.0195;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0110;  zR @ 50: 0.0183;  zR @ 100: 0.0366;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0150;  zR @ 50: 0.0322;  zR @ 100: 0.0365;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0234;  zR @ 50: 0.0431;  zR @ 100: 0.0585;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0205;  zR @ 50: 0.0513;  zR @ 100: 0.0821;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0111;  zR @ 50: 0.0439;  zR @ 100: 0.0757;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0121;  zR @ 50: 0.0217;  zR @ 100: 0.0616;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0072;  zR @ 50: 0.0288;  zR @ 100: 0.0734;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0135;  zR @ 50: 0.0419;  zR @ 100: 0.0622;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0532;  zR @ 50: 0.0638;  zR @ 100: 0.0851;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0393;  zR @ 50: 0.0821;  zR @ 100: 0.1256;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0130;  zR @ 50: 0.0260;  zR @ 100: 0.0260;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1478;  zR @ 50: 0.2060;  zR @ 100: 0.2292;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.1042;  zR @ 50: 0.1577;  zR @ 100: 0.1786;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1859;  zR @ 50: 0.1859;  zR @ 100: 0.2436;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.3333;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0320;  mR @ 50: 0.0443;  mR @ 100: 0.0547;  for mode=sgdet, type=Mean Recall.
(above:0.0086) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0404) (attached to:0.0000) (behind:0.1833) (belonging to:0.0000) (between:0.0000) (carrying:0.0000) (covered in:0.0000) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.3932) (holding:0.2160) (in:0.1342) (in front of:0.0038) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2209) (of:0.2042) (on:0.4289) (on back of:0.0000) (over:0.0000) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.1324) (says:0.0000) (sitting on:0.0794) (standing on:0.0000) (to:0.0000) (under:0.0476) (using:0.0000) (walking in:0.0000) (walking on:0.0000) (watching:0.0000) (wearing:0.6130) (wears:0.0000) (with:0.0313) 
====================================================================================================

2023-03-05 18:46:33,589 maskrcnn_benchmark INFO: Validation Result: 0.3275
2023-03-05 18:49:38,571 maskrcnn_benchmark INFO: eta: 1 day, 4:46:34  iter: 2200  loss: 0.3788 (0.7373)  loss_rel: 0.1279 (0.1745)  loss_refine_obj: 0.5774 (0.8061)  ML Loss (cd): -0.2499 (-0.2433)  time: 0.9240 (1.7923)  data: 0.0036 (0.8580)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 18:52:46,214 maskrcnn_benchmark INFO: eta: 1 day, 3:32:16  iter: 2400  loss: 0.4463 (0.7190)  loss_rel: 0.1283 (0.1739)  loss_refine_obj: 0.5887 (0.7890)  ML Loss (cd): -0.2495 (-0.2438)  time: 0.9389 (1.7211)  data: 0.0042 (0.7869)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 18:55:53,170 maskrcnn_benchmark INFO: eta: 1 day, 2:28:40  iter: 2600  loss: 0.5275 (0.7030)  loss_rel: 0.1274 (0.1735)  loss_refine_obj: 0.6740 (0.7738)  ML Loss (cd): -0.2499 (-0.2443)  time: 0.9435 (1.6606)  data: 0.0041 (0.7267)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 18:58:59,956 maskrcnn_benchmark INFO: eta: 1 day, 1:33:38  iter: 2800  loss: 0.4553 (0.6885)  loss_rel: 0.1526 (0.1739)  loss_refine_obj: 0.4679 (0.7591)  ML Loss (cd): -0.2496 (-0.2446)  time: 0.9271 (1.6087)  data: 0.0038 (0.6750)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 19:02:07,259 maskrcnn_benchmark INFO: eta: 1 day, 0:45:42  iter: 3000  loss: 0.4388 (0.6758)  loss_rel: 0.1801 (0.1729)  loss_refine_obj: 0.5321 (0.7479)  ML Loss (cd): -0.2499 (-0.2450)  time: 0.9290 (1.5639)  data: 0.0037 (0.6303)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 19:05:14,389 maskrcnn_benchmark INFO: eta: 1 day, 0:03:19  iter: 3200  loss: 0.5171 (0.6653)  loss_rel: 0.1427 (0.1730)  loss_refine_obj: 0.6152 (0.7376)  ML Loss (cd): -0.2500 (-0.2453)  time: 0.9421 (1.5246)  data: 0.0038 (0.5911)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 19:08:21,723 maskrcnn_benchmark INFO: eta: 23:25:37  iter: 3400  loss: 0.4578 (0.6550)  loss_rel: 0.0910 (0.1723)  loss_refine_obj: 0.6179 (0.7282)  ML Loss (cd): -0.2500 (-0.2455)  time: 0.9422 (1.4901)  data: 0.0036 (0.5566)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 19:11:28,621 maskrcnn_benchmark INFO: eta: 22:51:38  iter: 3600  loss: 0.5017 (0.6453)  loss_rel: 0.1336 (0.1720)  loss_refine_obj: 0.5779 (0.7191)  ML Loss (cd): -0.2500 (-0.2458)  time: 0.9361 (1.4592)  data: 0.0041 (0.5259)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 19:14:36,095 maskrcnn_benchmark INFO: eta: 22:21:02  iter: 3800  loss: 0.4550 (0.6374)  loss_rel: 0.1406 (0.1717)  loss_refine_obj: 0.6041 (0.7117)  ML Loss (cd): -0.2500 (-0.2460)  time: 0.9351 (1.4317)  data: 0.0038 (0.4984)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 19:17:44,182 maskrcnn_benchmark INFO: ---Total norm 0.06512 clip coef 76.78235-----------------
2023-03-05 19:17:44,187 maskrcnn_benchmark INFO: energy.2.weight                                   : 0.03462, (torch.Size([1, 384]))
2023-03-05 19:17:44,187 maskrcnn_benchmark INFO: energy.0.weight                                   : 0.02914, (torch.Size([384, 768]))
2023-03-05 19:17:44,187 maskrcnn_benchmark INFO: energy.2.bias                                     : 0.02441, (torch.Size([1]))
2023-03-05 19:17:44,187 maskrcnn_benchmark INFO: sg_pooler.poolingLayer.0.weight                   : 0.02360, (torch.Size([384, 768]))
2023-03-05 19:17:44,187 maskrcnn_benchmark INFO: sg_pooler.hgate_node.0.bias                       : 0.01608, (torch.Size([1]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: sg_layer.node_gate.bias_ih                        : 0.01505, (torch.Size([1152]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: obj_label_embedding.weight                        : 0.01097, (torch.Size([384, 279]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: sg_pooler.hgate_node.0.weight                     : 0.01066, (torch.Size([1, 384]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: sg_layer.node_gate.weight_hh                      : 0.00954, (torch.Size([1152, 384]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: sg_layer.node_gate.bias_hh                        : 0.00754, (torch.Size([1152]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: sg_layer.node_gate.weight_ih                      : 0.00742, (torch.Size([1152, 384]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: energy.0.bias                                     : 0.00599, (torch.Size([384]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.2.weight                : 0.00381, (torch.Size([384, 384]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: obj_emdedding.weight                              : 0.00320, (torch.Size([384, 4096]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.0.weight                : 0.00320, (torch.Size([384, 384]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: obj_label_embedding.bias                          : 0.00290, (torch.Size([384]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.2.bias                  : 0.00263, (torch.Size([384]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.2.bias                  : 0.00258, (torch.Size([384]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: sg_pooler.poolingLayer.0.bias                     : 0.00226, (torch.Size([384]))
2023-03-05 19:17:44,188 maskrcnn_benchmark INFO: im_pooler.poolingLayer.0.bias                     : 0.00205, (torch.Size([384]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: sg_pooler.hgate_edge.0.bias                       : 0.00146, (torch.Size([1]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: sg_layer.edge_gate.weight_hh                      : 0.00125, (torch.Size([1152, 384]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: pos_embed.2.weight                                : 0.00122, (torch.Size([128, 32]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.2.weight                : 0.00114, (torch.Size([384, 384]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: im_pooler.poolingLayer.0.weight                   : 0.00107, (torch.Size([384, 384]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.0.bias                  : 0.00105, (torch.Size([384]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.0.bias                  : 0.00104, (torch.Size([384]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: rel_label_embedding.weight                        : 0.00099, (torch.Size([384, 51]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: sg_layer.edge_gate.weight_ih                      : 0.00089, (torch.Size([1152, 384]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: im_pooler.hgate_node.0.weight                     : 0.00087, (torch.Size([1, 384]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: pos_embed.0.weight                                : 0.00085, (torch.Size([32, 9]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: im_layer.node_gate.weight_hh                      : 0.00076, (torch.Size([1152, 384]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: sg_pooler.hgate_edge.0.weight                     : 0.00073, (torch.Size([1, 384]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: rel_label_embedding.bias                          : 0.00063, (torch.Size([384]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.2.bias                  : 0.00063, (torch.Size([384]))
2023-03-05 19:17:44,189 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.0.weight                : 0.00054, (torch.Size([384, 768, 1, 1]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.2.weight                : 0.00050, (torch.Size([384, 384, 1, 1]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: pos_embed.2.bias                                  : 0.00045, (torch.Size([128]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: im_layer.node_gate.bias_ih                        : 0.00039, (torch.Size([1152]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: im_pooler.hgate_node.0.bias                       : 0.00030, (torch.Size([1]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.0.weight                : 0.00026, (torch.Size([384, 384]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: pos_embed.1.bias                                  : 0.00024, (torch.Size([32]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.0.bias                  : 0.00021, (torch.Size([384]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: im_layer.node_gate.bias_hh                        : 0.00020, (torch.Size([1152]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: im_layer.node_gate.weight_ih                      : 0.00017, (torch.Size([1152, 384]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: im_layer.node_kernel.2.bias                       : 0.00016, (torch.Size([384]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: pos_embed.1.weight                                : 0.00015, (torch.Size([32]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: im_layer.node_kernel.2.weight                     : 0.00008, (torch.Size([384, 384]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: obj_emdedding.bias                                : 0.00007, (torch.Size([384]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: im_layer.node_kernel.0.bias                       : 0.00006, (torch.Size([384]))
2023-03-05 19:17:44,190 maskrcnn_benchmark INFO: im_layer.node_kernel.0.weight                     : 0.00004, (torch.Size([384, 384]))
2023-03-05 19:17:44,191 maskrcnn_benchmark INFO: pos_embed.0.bias                                  : 0.00000, (torch.Size([32]))
2023-03-05 19:17:44,191 maskrcnn_benchmark INFO: -------------------------------
2023-03-05 19:17:44,193 maskrcnn_benchmark INFO: ---Total norm 3.97869 clip coef 1.25670-----------------
2023-03-05 19:17:44,197 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc6.weight: 2.57475, (torch.Size([4096, 12544]))
2023-03-05 19:17:44,197 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc7.weight: 1.99101, (torch.Size([4096, 4096]))
2023-03-05 19:17:44,197 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.60403, (torch.Size([151, 512]))
2023-03-05 19:17:44,197 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 1.50252, (torch.Size([3072, 5136]))
2023-03-05 19:17:44,197 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 0.35981, (torch.Size([4096, 12544]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.34258, (torch.Size([2560, 512]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.20346, (torch.Size([4096, 4096]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.predictor.rel_compress.weight  : 0.17089, (torch.Size([51, 4096]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.14437, (torch.Size([256, 1024, 3, 3]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.11928, (torch.Size([512, 1024]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_cat.weight      : 0.11170, (torch.Size([4096, 1024]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.09058, (torch.Size([151]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.08645, (torch.Size([256, 128, 3, 3]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.07756, (torch.Size([2048, 4808]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.07568, (torch.Size([2048, 4808]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.05857, (torch.Size([128, 2, 7, 7]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.05533, (torch.Size([512, 1024]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.04442, (torch.Size([3072]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.03505, (torch.Size([2048, 4424]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.02974, (torch.Size([2048, 4424]))
2023-03-05 19:17:44,198 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc7.bias : 0.02176, (torch.Size([4096]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01848, (torch.Size([32, 9]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.01836, (torch.Size([128, 32]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.01832, (torch.Size([2560]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc6.bias : 0.01763, (torch.Size([4096]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.01464, (torch.Size([512]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.01379, (torch.Size([22801, 51]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.01268, (torch.Size([151, 200]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.predictor.rel_compress.bias    : 0.01193, (torch.Size([51]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.01054, (torch.Size([128]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.01010, (torch.Size([2048, 512]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.00951, (torch.Size([2048, 512]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.00828, (torch.Size([512]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00518, (torch.Size([2048, 512]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_emb.weight      : 0.00516, (torch.Size([1024, 512]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00489, (torch.Size([152, 200]))
2023-03-05 19:17:44,199 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.00435, (torch.Size([4096]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00426, (torch.Size([128]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00396, (torch.Size([2048, 512]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00287, (torch.Size([32]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_cat.bias        : 0.00227, (torch.Size([4096]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.00223, (torch.Size([256]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00215, (torch.Size([32]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.00210, (torch.Size([2048]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.00210, (torch.Size([2048]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.00197, (torch.Size([128]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.00192, (torch.Size([2048]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.00192, (torch.Size([2048]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00164, (torch.Size([256]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_emb.bias        : 0.00143, (torch.Size([1024]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00143, (torch.Size([4096]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00129, (torch.Size([256]))
2023-03-05 19:17:44,200 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00120, (torch.Size([256]))
2023-03-05 19:17:44,201 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00118, (torch.Size([2048]))
2023-03-05 19:17:44,201 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00118, (torch.Size([2048]))
2023-03-05 19:17:44,201 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00095, (torch.Size([2048]))
2023-03-05 19:17:44,201 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00095, (torch.Size([2048]))
2023-03-05 19:17:44,201 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00090, (torch.Size([128]))
2023-03-05 19:17:44,201 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00080, (torch.Size([151, 200]))
2023-03-05 19:17:44,201 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-05 19:17:44,201 maskrcnn_benchmark INFO: -------------------------------
2023-03-05 19:17:44,204 maskrcnn_benchmark INFO: eta: 21:53:21  iter: 4000  loss: 0.4896 (0.6300)  loss_rel: 0.1610 (0.1712)  loss_refine_obj: 0.5504 (0.7049)  ML Loss (cd): -0.2500 (-0.2462)  time: 0.9395 (1.4072)  data: 0.0040 (0.4737)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 19:17:44,206 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/model_0004000.pth
2023-03-05 19:18:25,593 maskrcnn_benchmark INFO: Start validating
2023-03-05 19:18:25,663 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-05 19:43:38,416 maskrcnn_benchmark INFO: Total run time: 0:25:12.752839 (0.30255056772232053 s / img per device, on 1 devices)
2023-03-05 19:43:38,419 maskrcnn_benchmark INFO: Model inference time: 0:23:11.389694 (0.27827793874740603 s / img per device, on 1 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(398905, 7)
0/398905
DONE (t=1.88s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=29.69s).
Accumulating evaluation results...
DONE (t=7.14s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.142
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.276
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.131
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.065
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.107
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.179
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.220
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.330
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.334
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.171
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.281
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.364
2023-03-05 19:49:07,260 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2760
====================================================================================================
SGG eval:   R @ 20: 0.2224;   R @ 50: 0.2906;   R @ 100: 0.3335;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2291; ngR @ 50: 0.3105; ngR @ 100: 0.3727;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0032;  zR @ 50: 0.0074;  zR @ 100: 0.0173;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0060;  zR @ 50: 0.0150;  zR @ 100: 0.0165;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0110;  zR @ 50: 0.0256;  zR @ 100: 0.0403;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0193;  zR @ 50: 0.0236;  zR @ 100: 0.0365;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0175;  zR @ 50: 0.0519;  zR @ 100: 0.0651;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0154;  zR @ 50: 0.0222;  zR @ 100: 0.0556;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0139;  zR @ 50: 0.0623;  zR @ 100: 0.0771;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0197;  zR @ 50: 0.0449;  zR @ 100: 0.0495;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0288;  zR @ 50: 0.0576;  zR @ 100: 0.0914;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0203;  zR @ 50: 0.0338;  zR @ 100: 0.0689;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0319;  zR @ 50: 0.0638;  zR @ 100: 0.0931;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0750;  zR @ 50: 0.1077;  zR @ 100: 0.1369;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0000;  zR @ 50: 0.0130;  zR @ 100: 0.0130;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.0814;  zR @ 50: 0.2292;  zR @ 100: 0.2932;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.1458;  zR @ 50: 0.1458;  zR @ 100: 0.1994;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1859;  zR @ 50: 0.1859;  zR @ 100: 0.2244;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.3333;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0374;  mR @ 50: 0.0520;  mR @ 100: 0.0619;  for mode=sgdet, type=Mean Recall.
(above:0.0158) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0303) (attached to:0.0000) (behind:0.1544) (belonging to:0.0000) (between:0.0000) (carrying:0.0132) (covered in:0.0000) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.3974) (holding:0.2571) (in:0.1426) (in front of:0.0083) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2168) (of:0.1777) (on:0.4400) (on back of:0.0000) (over:0.0000) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.3348) (says:0.0000) (sitting on:0.1017) (standing on:0.0000) (to:0.0000) (under:0.0510) (using:0.0769) (walking in:0.0000) (walking on:0.0186) (watching:0.0098) (wearing:0.6355) (wears:0.0000) (with:0.0129) 
====================================================================================================

2023-03-05 19:49:08,191 maskrcnn_benchmark INFO: Validation Result: 0.3335
2023-03-05 19:52:14,093 maskrcnn_benchmark INFO: eta: 1 day, 4:24:40  iter: 4200  loss: 0.4308 (0.6223)  loss_rel: 0.1288 (0.1708)  loss_refine_obj: 0.5075 (0.6978)  ML Loss (cd): -0.2499 (-0.2463)  time: 0.9334 (1.8330)  data: 0.0041 (0.8999)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 19:55:21,018 maskrcnn_benchmark INFO: eta: 1 day, 3:40:43  iter: 4400  loss: 0.4096 (0.6161)  loss_rel: 0.1320 (0.1707)  loss_refine_obj: 0.4850 (0.6918)  ML Loss (cd): -0.2500 (-0.2465)  time: 0.9354 (1.7922)  data: 0.0039 (0.8592)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 19:58:28,282 maskrcnn_benchmark INFO: eta: 1 day, 3:00:23  iter: 4600  loss: 0.4985 (0.6100)  loss_rel: 0.1289 (0.1702)  loss_refine_obj: 0.5676 (0.6865)  ML Loss (cd): -0.2498 (-0.2466)  time: 0.9362 (1.7549)  data: 0.0039 (0.8220)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 20:01:35,950 maskrcnn_benchmark INFO: eta: 1 day, 2:23:14  iter: 4800  loss: 0.5187 (0.6043)  loss_rel: 0.1486 (0.1704)  loss_refine_obj: 0.5320 (0.6806)  ML Loss (cd): -0.2500 (-0.2468)  time: 0.9378 (1.7209)  data: 0.0038 (0.7879)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 20:04:43,667 maskrcnn_benchmark INFO: eta: 1 day, 1:48:49  iter: 5000  loss: 0.4005 (0.5991)  loss_rel: 0.1391 (0.1703)  loss_refine_obj: 0.4702 (0.6756)  ML Loss (cd): -0.2500 (-0.2469)  time: 0.9325 (1.6896)  data: 0.0038 (0.7566)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 20:07:50,373 maskrcnn_benchmark INFO: eta: 1 day, 1:16:37  iter: 5200  loss: 0.4584 (0.5936)  loss_rel: 0.1109 (0.1700)  loss_refine_obj: 0.5379 (0.6706)  ML Loss (cd): -0.2499 (-0.2470)  time: 0.9299 (1.6605)  data: 0.0043 (0.7276)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 20:10:58,332 maskrcnn_benchmark INFO: eta: 1 day, 0:46:48  iter: 5400  loss: 0.4549 (0.5899)  loss_rel: 0.1631 (0.1702)  loss_refine_obj: 0.4687 (0.6668)  ML Loss (cd): -0.2499 (-0.2471)  time: 0.9308 (1.6339)  data: 0.0040 (0.7008)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 20:14:05,594 maskrcnn_benchmark INFO: eta: 1 day, 0:18:46  iter: 5600  loss: 0.3844 (0.5856)  loss_rel: 0.1416 (0.1701)  loss_refine_obj: 0.4906 (0.6628)  ML Loss (cd): -0.2500 (-0.2472)  time: 0.9398 (1.6089)  data: 0.0042 (0.6759)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 20:17:13,068 maskrcnn_benchmark INFO: eta: 23:52:29  iter: 5800  loss: 0.4159 (0.5819)  loss_rel: 0.1190 (0.1695)  loss_refine_obj: 0.4777 (0.6597)  ML Loss (cd): -0.2500 (-0.2473)  time: 0.9388 (1.5858)  data: 0.0042 (0.6528)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 20:20:20,233 maskrcnn_benchmark INFO: eta: 23:27:42  iter: 6000  loss: 0.5120 (0.5781)  loss_rel: 0.1560 (0.1690)  loss_refine_obj: 0.5020 (0.6565)  ML Loss (cd): -0.2500 (-0.2474)  time: 0.9355 (1.5641)  data: 0.0037 (0.6311)  energy lr: 0.005000  base lr : 0.005000  max mem: 8957
2023-03-05 20:20:20,236 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/model_0006000.pth
2023-03-05 20:20:54,723 maskrcnn_benchmark INFO: Start validating
2023-03-05 20:20:54,797 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-05 20:46:10,186 maskrcnn_benchmark INFO: Total run time: 0:25:15.388881 (0.3030777762889862 s / img per device, on 1 devices)
2023-03-05 20:46:10,187 maskrcnn_benchmark INFO: Model inference time: 0:23:11.403327 (0.27828066549301145 s / img per device, on 1 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(398905, 7)
0/398905
DONE (t=1.83s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=29.45s).
Accumulating evaluation results...
DONE (t=7.13s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.141
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.277
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.128
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.064
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.105
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.177
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.220
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.336
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.171
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.285
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.364
2023-03-05 20:51:40,796 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2767
====================================================================================================
SGG eval:   R @ 20: 0.2328;   R @ 50: 0.2979;   R @ 100: 0.3402;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2402; ngR @ 50: 0.3221; ngR @ 100: 0.3836;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0042;  zR @ 50: 0.0106;  zR @ 100: 0.0233;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0060;  zR @ 50: 0.0145;  zR @ 100: 0.0190;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0110;  zR @ 50: 0.0147;  zR @ 100: 0.0330;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0193;  zR @ 50: 0.0279;  zR @ 100: 0.0322;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0190;  zR @ 50: 0.0344;  zR @ 100: 0.0519;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0205;  zR @ 50: 0.0419;  zR @ 100: 0.0859;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0222;  zR @ 50: 0.0389;  zR @ 100: 0.0630;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0121;  zR @ 50: 0.0182;  zR @ 100: 0.0298;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0216;  zR @ 50: 0.0755;  zR @ 100: 0.0899;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0068;  zR @ 50: 0.0419;  zR @ 100: 0.0622;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0532;  zR @ 50: 0.0691;  zR @ 100: 0.0798;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0214;  zR @ 50: 0.0524;  zR @ 100: 0.0917;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0130;  zR @ 50: 0.0260;  zR @ 100: 0.0390;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1827;  zR @ 50: 0.2583;  zR @ 100: 0.3106;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.1250;  zR @ 50: 0.1488;  zR @ 100: 0.2202;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.2244;  zR @ 50: 0.2628;  zR @ 100: 0.3013;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.3333;  zR @ 50: 0.3333;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0386;  mR @ 50: 0.0523;  mR @ 100: 0.0626;  for mode=sgdet, type=Mean Recall.
(above:0.0158) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0404) (attached to:0.0000) (behind:0.1467) (belonging to:0.0000) (between:0.0000) (carrying:0.1250) (covered in:0.0000) (covering:0.0000) (eating:0.0476) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.3890) (holding:0.2084) (in:0.1330) (in front of:0.0196) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2034) (of:0.2116) (on:0.4556) (on back of:0.0000) (over:0.0122) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.2068) (says:0.0000) (sitting on:0.0541) (standing on:0.0000) (to:0.0000) (under:0.0408) (using:0.0769) (walking in:0.0000) (walking on:0.0230) (watching:0.0392) (wearing:0.6581) (wears:0.0000) (with:0.0211) 
====================================================================================================

2023-03-05 20:51:41,720 maskrcnn_benchmark INFO: Validation Result: 0.3402
2023-03-05 20:54:47,905 maskrcnn_benchmark INFO: eta: 1 day, 3:36:16  iter: 6200  loss: 0.4064 (0.5749)  loss_rel: 0.1500 (0.1682)  loss_refine_obj: 0.5366 (0.6541)  ML Loss (cd): -0.2500 (-0.2475)  time: 0.9284 (1.8472)  data: 0.0040 (0.9144)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 20:57:54,457 maskrcnn_benchmark INFO: eta: 1 day, 3:04:35  iter: 6400  loss: 0.5327 (0.5718)  loss_rel: 0.1390 (0.1681)  loss_refine_obj: 0.6151 (0.6512)  ML Loss (cd): -0.2500 (-0.2475)  time: 0.9393 (1.8186)  data: 0.0038 (0.8859)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 21:01:02,193 maskrcnn_benchmark INFO: eta: 1 day, 2:34:48  iter: 6600  loss: 0.3768 (0.5681)  loss_rel: 0.0943 (0.1680)  loss_refine_obj: 0.5133 (0.6478)  ML Loss (cd): -0.2500 (-0.2476)  time: 0.9324 (1.7919)  data: 0.0038 (0.8592)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 21:04:08,485 maskrcnn_benchmark INFO: eta: 1 day, 2:06:23  iter: 6800  loss: 0.3848 (0.5644)  loss_rel: 0.1338 (0.1674)  loss_refine_obj: 0.5110 (0.6447)  ML Loss (cd): -0.2500 (-0.2477)  time: 0.9351 (1.7666)  data: 0.0042 (0.8340)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 21:07:15,285 maskrcnn_benchmark INFO: eta: 1 day, 1:39:29  iter: 7000  loss: 0.5027 (0.5622)  loss_rel: 0.1564 (0.1677)  loss_refine_obj: 0.5848 (0.6422)  ML Loss (cd): -0.2500 (-0.2477)  time: 0.9381 (1.7428)  data: 0.0041 (0.8103)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 21:10:22,784 maskrcnn_benchmark INFO: eta: 1 day, 1:13:59  iter: 7200  loss: 0.5051 (0.5596)  loss_rel: 0.1164 (0.1678)  loss_refine_obj: 0.5998 (0.6396)  ML Loss (cd): -0.2499 (-0.2478)  time: 0.9434 (1.7205)  data: 0.0037 (0.7879)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 21:13:30,314 maskrcnn_benchmark INFO: eta: 1 day, 0:49:42  iter: 7400  loss: 0.4488 (0.5571)  loss_rel: 0.1255 (0.1676)  loss_refine_obj: 0.5062 (0.6374)  ML Loss (cd): -0.2500 (-0.2478)  time: 0.9332 (1.6993)  data: 0.0039 (0.7667)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 21:16:37,286 maskrcnn_benchmark INFO: eta: 1 day, 0:26:28  iter: 7600  loss: 0.3851 (0.5545)  loss_rel: 0.1373 (0.1676)  loss_refine_obj: 0.4894 (0.6348)  ML Loss (cd): -0.2500 (-0.2479)  time: 0.9363 (1.6792)  data: 0.0037 (0.7467)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 21:19:44,386 maskrcnn_benchmark INFO: eta: 1 day, 0:04:17  iter: 7800  loss: 0.4437 (0.5518)  loss_rel: 0.1130 (0.1674)  loss_refine_obj: 0.4998 (0.6324)  ML Loss (cd): -0.2500 (-0.2480)  time: 0.9465 (1.6601)  data: 0.0039 (0.7276)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 21:22:51,150 maskrcnn_benchmark INFO: ---Total norm 0.02258 clip coef 221.38930-----------------
2023-03-05 21:22:51,155 maskrcnn_benchmark INFO: energy.2.weight                                   : 0.01390, (torch.Size([1, 384]))
2023-03-05 21:22:51,155 maskrcnn_benchmark INFO: energy.0.weight                                   : 0.01252, (torch.Size([384, 768]))
2023-03-05 21:22:51,155 maskrcnn_benchmark INFO: sg_pooler.poolingLayer.0.weight                   : 0.00868, (torch.Size([384, 768]))
2023-03-05 21:22:51,155 maskrcnn_benchmark INFO: sg_layer.node_gate.bias_ih                        : 0.00448, (torch.Size([1152]))
2023-03-05 21:22:51,155 maskrcnn_benchmark INFO: energy.0.bias                                     : 0.00349, (torch.Size([384]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: obj_label_embedding.weight                        : 0.00311, (torch.Size([384, 279]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: sg_layer.node_gate.weight_hh                      : 0.00281, (torch.Size([1152, 384]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: sg_pooler.hgate_node.0.bias                       : 0.00280, (torch.Size([1]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: obj_emdedding.weight                              : 0.00229, (torch.Size([384, 4096]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: sg_layer.node_gate.bias_hh                        : 0.00224, (torch.Size([1152]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: sg_pooler.hgate_node.0.weight                     : 0.00183, (torch.Size([1, 384]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: sg_pooler.poolingLayer.0.bias                     : 0.00181, (torch.Size([384]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: sg_layer.node_gate.weight_ih                      : 0.00177, (torch.Size([1152, 384]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: im_pooler.poolingLayer.0.bias                     : 0.00155, (torch.Size([384]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: obj_label_embedding.bias                          : 0.00084, (torch.Size([384]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.2.bias                  : 0.00083, (torch.Size([384]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.2.bias                  : 0.00079, (torch.Size([384]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: im_pooler.hgate_node.0.weight                     : 0.00071, (torch.Size([1, 384]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.2.weight                : 0.00063, (torch.Size([384, 384]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: im_pooler.poolingLayer.0.weight                   : 0.00061, (torch.Size([384, 384]))
2023-03-05 21:22:51,156 maskrcnn_benchmark INFO: im_layer.node_gate.weight_hh                      : 0.00054, (torch.Size([1152, 384]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.0.weight                : 0.00045, (torch.Size([384, 384]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: im_pooler.hgate_node.0.bias                       : 0.00040, (torch.Size([1]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: pos_embed.2.weight                                : 0.00038, (torch.Size([128, 32]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.2.weight                : 0.00034, (torch.Size([384, 384]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.0.bias                  : 0.00032, (torch.Size([384]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: energy.2.bias                                     : 0.00031, (torch.Size([1]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.0.bias                  : 0.00029, (torch.Size([384]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: im_layer.node_gate.bias_ih                        : 0.00026, (torch.Size([1152]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: sg_layer.edge_gate.weight_hh                      : 0.00023, (torch.Size([1152, 384]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: pos_embed.0.weight                                : 0.00021, (torch.Size([32, 9]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: sg_layer.edge_gate.weight_ih                      : 0.00017, (torch.Size([1152, 384]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: rel_label_embedding.weight                        : 0.00016, (torch.Size([384, 51]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: pos_embed.2.bias                                  : 0.00014, (torch.Size([128]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: im_layer.node_gate.bias_hh                        : 0.00013, (torch.Size([1152]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: im_layer.node_gate.weight_ih                      : 0.00011, (torch.Size([1152, 384]))
2023-03-05 21:22:51,157 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.2.bias                  : 0.00011, (torch.Size([384]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: im_layer.node_kernel.2.bias                       : 0.00011, (torch.Size([384]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: rel_label_embedding.bias                          : 0.00010, (torch.Size([384]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.0.weight                : 0.00009, (torch.Size([384, 768, 1, 1]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: pos_embed.1.bias                                  : 0.00008, (torch.Size([32]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.2.weight                : 0.00008, (torch.Size([384, 384, 1, 1]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.0.weight                : 0.00006, (torch.Size([384, 384]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: im_layer.node_kernel.2.weight                     : 0.00005, (torch.Size([384, 384]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: sg_pooler.hgate_edge.0.weight                     : 0.00005, (torch.Size([1, 384]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: obj_emdedding.bias                                : 0.00004, (torch.Size([384]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.0.bias                  : 0.00004, (torch.Size([384]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: pos_embed.1.weight                                : 0.00004, (torch.Size([32]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: im_layer.node_kernel.0.bias                       : 0.00004, (torch.Size([384]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: im_layer.node_kernel.0.weight                     : 0.00002, (torch.Size([384, 384]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: sg_pooler.hgate_edge.0.bias                       : 0.00000, (torch.Size([1]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: pos_embed.0.bias                                  : 0.00000, (torch.Size([32]))
2023-03-05 21:22:51,158 maskrcnn_benchmark INFO: -------------------------------
2023-03-05 21:22:51,161 maskrcnn_benchmark INFO: ---Total norm 3.61544 clip coef 1.38296-----------------
2023-03-05 21:22:51,165 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc6.weight: 2.42075, (torch.Size([4096, 12544]))
2023-03-05 21:22:51,165 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc7.weight: 2.04157, (torch.Size([4096, 4096]))
2023-03-05 21:22:51,165 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 1.17953, (torch.Size([3072, 5136]))
2023-03-05 21:22:51,165 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.03671, (torch.Size([151, 512]))
2023-03-05 21:22:51,165 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 0.42396, (torch.Size([4096, 12544]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.predictor.rel_compress.weight  : 0.29233, (torch.Size([51, 4096]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.29208, (torch.Size([4096, 4096]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.23888, (torch.Size([2560, 512]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.20902, (torch.Size([512, 1024]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_cat.weight      : 0.18997, (torch.Size([4096, 1024]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.14807, (torch.Size([256, 1024, 3, 3]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.14109, (torch.Size([256, 128, 3, 3]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.13398, (torch.Size([2048, 4808]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.12805, (torch.Size([2048, 4808]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.05565, (torch.Size([128, 2, 7, 7]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.04417, (torch.Size([151]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.04097, (torch.Size([512, 1024]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.03791, (torch.Size([512]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.predictor.rel_compress.bias    : 0.03421, (torch.Size([51]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.02930, (torch.Size([2048, 4424]))
2023-03-05 21:22:51,166 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.02707, (torch.Size([2048, 4424]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.02229, (torch.Size([3072]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.02113, (torch.Size([128, 32]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.01630, (torch.Size([22801, 51]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.01517, (torch.Size([2048, 512]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.01511, (torch.Size([2048, 512]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01380, (torch.Size([32, 9]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.01202, (torch.Size([128]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.01200, (torch.Size([2560]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc7.bias : 0.01197, (torch.Size([4096]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc6.bias : 0.01132, (torch.Size([4096]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_emb.weight      : 0.00906, (torch.Size([1024, 512]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.00898, (torch.Size([4096]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.00698, (torch.Size([151, 200]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_cat.bias        : 0.00583, (torch.Size([4096]))
2023-03-05 21:22:51,167 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.00510, (torch.Size([512]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.00426, (torch.Size([256]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.00408, (torch.Size([2048]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.00408, (torch.Size([2048]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.00395, (torch.Size([2048]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.00395, (torch.Size([2048]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00384, (torch.Size([152, 200]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_emb.bias        : 0.00373, (torch.Size([1024]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00363, (torch.Size([2048, 512]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00338, (torch.Size([2048, 512]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.00313, (torch.Size([128]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00270, (torch.Size([256]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00267, (torch.Size([128]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00252, (torch.Size([4096]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00251, (torch.Size([256]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00199, (torch.Size([32]))
2023-03-05 21:22:51,168 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00193, (torch.Size([32]))
2023-03-05 21:22:51,169 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00163, (torch.Size([256]))
2023-03-05 21:22:51,169 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00139, (torch.Size([128]))
2023-03-05 21:22:51,169 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00115, (torch.Size([151, 200]))
2023-03-05 21:22:51,169 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00077, (torch.Size([2048]))
2023-03-05 21:22:51,169 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00077, (torch.Size([2048]))
2023-03-05 21:22:51,169 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00068, (torch.Size([2048]))
2023-03-05 21:22:51,169 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00068, (torch.Size([2048]))
2023-03-05 21:22:51,169 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-05 21:22:51,169 maskrcnn_benchmark INFO: -------------------------------
2023-03-05 21:22:51,172 maskrcnn_benchmark INFO: eta: 23:43:01  iter: 8000  loss: 0.4450 (0.5495)  loss_rel: 0.1385 (0.1672)  loss_refine_obj: 0.4545 (0.6303)  ML Loss (cd): -0.2500 (-0.2480)  time: 0.9315 (1.6420)  data: 0.0033 (0.7095)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 21:22:51,174 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/model_0008000.pth
2023-03-05 21:23:20,725 maskrcnn_benchmark INFO: Start validating
2023-03-05 21:23:20,797 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-05 21:48:31,849 maskrcnn_benchmark INFO: Total run time: 0:25:11.051259 (0.3022102518081665 s / img per device, on 1 devices)
2023-03-05 21:48:31,850 maskrcnn_benchmark INFO: Model inference time: 0:23:07.068587 (0.2774137173652649 s / img per device, on 1 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(398905, 7)
0/398905
DONE (t=1.87s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=29.74s).
Accumulating evaluation results...
DONE (t=7.08s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.141
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.275
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.130
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.060
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.106
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.179
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.222
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.335
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.339
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.173
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.285
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.370
2023-03-05 21:54:01,246 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2752
====================================================================================================
SGG eval:   R @ 20: 0.2252;   R @ 50: 0.2940;   R @ 100: 0.3407;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2322; ngR @ 50: 0.3168; ngR @ 100: 0.3775;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0053;  zR @ 50: 0.0074;  zR @ 100: 0.0222;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0060;  zR @ 50: 0.0150;  zR @ 100: 0.0195;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0220;  zR @ 50: 0.0220;  zR @ 100: 0.0330;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0150;  zR @ 50: 0.0150;  zR @ 100: 0.0322;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0190;  zR @ 50: 0.0322;  zR @ 100: 0.0541;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0205;  zR @ 50: 0.0427;  zR @ 100: 0.0735;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0278;  zR @ 50: 0.0500;  zR @ 100: 0.0767;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0242;  zR @ 50: 0.0343;  zR @ 100: 0.0495;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0216;  zR @ 50: 0.0683;  zR @ 100: 0.0899;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0216;  zR @ 50: 0.0486;  zR @ 100: 0.0892;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0319;  zR @ 50: 0.0426;  zR @ 100: 0.0957;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0464;  zR @ 50: 0.1006;  zR @ 100: 0.1405;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0130;  zR @ 50: 0.0130;  zR @ 100: 0.0260;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1047;  zR @ 50: 0.1827;  zR @ 100: 0.2816;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.0833;  zR @ 50: 0.1488;  zR @ 100: 0.1994;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1859;  zR @ 50: 0.1859;  zR @ 100: 0.1859;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.0000;  zR @ 50: 0.3333;  zR @ 100: 0.3333;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0362;  mR @ 50: 0.0486;  mR @ 100: 0.0579;  for mode=sgdet, type=Mean Recall.
(above:0.0129) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0202) (attached to:0.0000) (behind:0.1747) (belonging to:0.0000) (between:0.0000) (carrying:0.0461) (covered in:0.0000) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.4037) (holding:0.2410) (in:0.1420) (in front of:0.0075) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2353) (of:0.2169) (on:0.4424) (on back of:0.0000) (over:0.0000) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.1473) (says:0.0000) (sitting on:0.1122) (standing on:0.0000) (to:0.0000) (under:0.0374) (using:0.0000) (walking in:0.0000) (walking on:0.0000) (watching:0.0098) (wearing:0.6297) (wears:0.0000) (with:0.0172) 
====================================================================================================

2023-03-05 21:54:02,180 maskrcnn_benchmark INFO: Validation Result: 0.3407
2023-03-05 21:57:08,163 maskrcnn_benchmark INFO: eta: 1 day, 2:39:32  iter: 8200  loss: 0.4593 (0.5477)  loss_rel: 0.1651 (0.1673)  loss_refine_obj: 0.5227 (0.6284)  ML Loss (cd): -0.2500 (-0.2480)  time: 0.9354 (1.8528)  data: 0.0040 (0.9205)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 22:00:15,673 maskrcnn_benchmark INFO: eta: 1 day, 2:14:37  iter: 8400  loss: 0.3971 (0.5451)  loss_rel: 0.1430 (0.1669)  loss_refine_obj: 0.4969 (0.6263)  ML Loss (cd): -0.2500 (-0.2481)  time: 0.9389 (1.8310)  data: 0.0039 (0.8987)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 22:03:23,643 maskrcnn_benchmark INFO: eta: 1 day, 1:50:46  iter: 8600  loss: 0.3798 (0.5435)  loss_rel: 0.1453 (0.1670)  loss_refine_obj: 0.4643 (0.6246)  ML Loss (cd): -0.2500 (-0.2481)  time: 0.9340 (1.8102)  data: 0.0039 (0.8779)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 22:06:30,297 maskrcnn_benchmark INFO: eta: 1 day, 1:27:44  iter: 8800  loss: 0.3757 (0.5414)  loss_rel: 0.1299 (0.1668)  loss_refine_obj: 0.4944 (0.6228)  ML Loss (cd): -0.2500 (-0.2482)  time: 0.9395 (1.7903)  data: 0.0040 (0.8580)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 22:09:38,845 maskrcnn_benchmark INFO: eta: 1 day, 1:05:45  iter: 9000  loss: 0.5011 (0.5392)  loss_rel: 0.0894 (0.1665)  loss_refine_obj: 0.5686 (0.6210)  ML Loss (cd): -0.2500 (-0.2482)  time: 0.9448 (1.7715)  data: 0.0038 (0.8390)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 22:12:47,243 maskrcnn_benchmark INFO: eta: 1 day, 0:44:35  iter: 9200  loss: 0.4794 (0.5379)  loss_rel: 0.1289 (0.1666)  loss_refine_obj: 0.5092 (0.6196)  ML Loss (cd): -0.2500 (-0.2483)  time: 0.9428 (1.7534)  data: 0.0038 (0.8209)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 22:15:55,691 maskrcnn_benchmark INFO: eta: 1 day, 0:24:11  iter: 9400  loss: 0.4573 (0.5367)  loss_rel: 0.1477 (0.1664)  loss_refine_obj: 0.5178 (0.6185)  ML Loss (cd): -0.2500 (-0.2483)  time: 0.9342 (1.7362)  data: 0.0037 (0.8035)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 22:19:03,890 maskrcnn_benchmark INFO: eta: 1 day, 0:04:28  iter: 9600  loss: 0.5049 (0.5356)  loss_rel: 0.1509 (0.1665)  loss_refine_obj: 0.5754 (0.6175)  ML Loss (cd): -0.2500 (-0.2483)  time: 0.9416 (1.7196)  data: 0.0036 (0.7868)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 22:22:12,025 maskrcnn_benchmark INFO: eta: 23:45:26  iter: 9800  loss: 0.4247 (0.5341)  loss_rel: 0.1452 (0.1664)  loss_refine_obj: 0.5065 (0.6160)  ML Loss (cd): -0.2500 (-0.2484)  time: 0.9367 (1.7037)  data: 0.0035 (0.7709)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 22:25:19,919 maskrcnn_benchmark INFO: eta: 23:27:01  iter: 10000  loss: 0.4677 (0.5331)  loss_rel: 0.1182 (0.1667)  loss_refine_obj: 0.6032 (0.6147)  ML Loss (cd): -0.2500 (-0.2484)  time: 0.9521 (1.6884)  data: 0.0035 (0.7555)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 22:25:19,923 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/model_0010000.pth
2023-03-05 22:26:00,884 maskrcnn_benchmark INFO: Start validating
2023-03-05 22:26:00,951 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-05 22:51:18,805 maskrcnn_benchmark INFO: Total run time: 0:25:17.853868 (0.3035707736492157 s / img per device, on 1 devices)
2023-03-05 22:51:18,806 maskrcnn_benchmark INFO: Model inference time: 0:23:32.876392 (0.28257527837753293 s / img per device, on 1 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(398905, 7)
0/398905
DONE (t=1.92s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=30.74s).
Accumulating evaluation results...
DONE (t=7.37s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.144
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.281
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.132
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.064
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.107
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.183
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.224
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.337
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.341
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.180
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.284
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.373
2023-03-05 22:57:03,377 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2809
====================================================================================================
SGG eval:   R @ 20: 0.2281;   R @ 50: 0.2975;   R @ 100: 0.3422;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2328; ngR @ 50: 0.3198; ngR @ 100: 0.3806;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0021;  zR @ 50: 0.0085;  zR @ 100: 0.0211;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0060;  zR @ 50: 0.0120;  zR @ 100: 0.0240;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0147;  zR @ 50: 0.0293;  zR @ 100: 0.0366;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0225;  zR @ 50: 0.0354;  zR @ 100: 0.0494;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0234;  zR @ 50: 0.0431;  zR @ 100: 0.0673;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0222;  zR @ 50: 0.0376;  zR @ 100: 0.0607;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0250;  zR @ 50: 0.0417;  zR @ 100: 0.0685;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0121;  zR @ 50: 0.0263;  zR @ 100: 0.0566;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0504;  zR @ 50: 0.0863;  zR @ 100: 0.1022;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0135;  zR @ 50: 0.0554;  zR @ 100: 0.0757;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0319;  zR @ 50: 0.0585;  zR @ 100: 0.0931;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0607;  zR @ 50: 0.1101;  zR @ 100: 0.1458;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0130;  zR @ 50: 0.0260;  zR @ 100: 0.0260;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1711;  zR @ 50: 0.2234;  zR @ 100: 0.2467;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.0625;  zR @ 50: 0.1280;  zR @ 100: 0.1786;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1218;  zR @ 50: 0.1859;  zR @ 100: 0.2244;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.3333;  zR @ 50: 0.3333;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0404;  mR @ 50: 0.0538;  mR @ 100: 0.0644;  for mode=sgdet, type=Mean Recall.
(above:0.0186) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0404) (attached to:0.0000) (behind:0.1811) (belonging to:0.0000) (between:0.0000) (carrying:0.1228) (covered in:0.0000) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.3884) (holding:0.2299) (in:0.1367) (in front of:0.0060) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2397) (of:0.1925) (on:0.4541) (on back of:0.0000) (over:0.0000) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.2812) (says:0.0000) (sitting on:0.1117) (standing on:0.0000) (to:0.0000) (under:0.0527) (using:0.0769) (walking in:0.0000) (walking on:0.0000) (watching:0.0196) (wearing:0.6527) (wears:0.0000) (with:0.0150) 
====================================================================================================

2023-03-05 22:57:04,336 maskrcnn_benchmark INFO: Validation Result: 0.3422
2023-03-05 23:00:12,534 maskrcnn_benchmark INFO: eta: 1 day, 1:44:12  iter: 10200  loss: 0.3639 (0.5315)  loss_rel: 0.1585 (0.1667)  loss_refine_obj: 0.4676 (0.6132)  ML Loss (cd): -0.2500 (-0.2484)  time: 0.9455 (1.8605)  data: 0.0033 (0.9275)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 23:03:22,558 maskrcnn_benchmark INFO: eta: 1 day, 1:23:31  iter: 10400  loss: 0.4359 (0.5300)  loss_rel: 0.1434 (0.1663)  loss_refine_obj: 0.5442 (0.6121)  ML Loss (cd): -0.2500 (-0.2484)  time: 0.9465 (1.8430)  data: 0.0038 (0.9097)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 23:06:31,837 maskrcnn_benchmark INFO: eta: 1 day, 1:03:27  iter: 10600  loss: 0.4660 (0.5286)  loss_rel: 0.1447 (0.1665)  loss_refine_obj: 0.5913 (0.6106)  ML Loss (cd): -0.2500 (-0.2485)  time: 0.9531 (1.8261)  data: 0.0037 (0.8926)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 23:09:42,312 maskrcnn_benchmark INFO: eta: 1 day, 0:44:06  iter: 10800  loss: 0.3749 (0.5273)  loss_rel: 0.1524 (0.1663)  loss_refine_obj: 0.4691 (0.6096)  ML Loss (cd): -0.2500 (-0.2485)  time: 0.9502 (1.8099)  data: 0.0035 (0.8762)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 23:12:51,969 maskrcnn_benchmark INFO: eta: 1 day, 0:25:16  iter: 11000  loss: 0.3949 (0.5257)  loss_rel: 0.1136 (0.1660)  loss_refine_obj: 0.5083 (0.6082)  ML Loss (cd): -0.2500 (-0.2485)  time: 0.9448 (1.7942)  data: 0.0037 (0.8603)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 23:16:01,506 maskrcnn_benchmark INFO: eta: 1 day, 0:07:00  iter: 11200  loss: 0.3449 (0.5244)  loss_rel: 0.1635 (0.1659)  loss_refine_obj: 0.4036 (0.6071)  ML Loss (cd): -0.2500 (-0.2486)  time: 0.9415 (1.7791)  data: 0.0033 (0.8450)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 23:19:11,694 maskrcnn_benchmark INFO: eta: 23:49:18  iter: 11400  loss: 0.4586 (0.5233)  loss_rel: 0.1304 (0.1655)  loss_refine_obj: 0.5813 (0.6063)  ML Loss (cd): -0.2500 (-0.2486)  time: 0.9528 (1.7646)  data: 0.0039 (0.8303)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 23:22:20,495 maskrcnn_benchmark INFO: eta: 23:32:00  iter: 11600  loss: 0.4494 (0.5221)  loss_rel: 0.1644 (0.1655)  loss_refine_obj: 0.5065 (0.6052)  ML Loss (cd): -0.2500 (-0.2486)  time: 0.9462 (1.7504)  data: 0.0040 (0.8160)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 23:25:30,280 maskrcnn_benchmark INFO: eta: 23:15:15  iter: 11800  loss: 0.5761 (0.5214)  loss_rel: 0.1443 (0.1655)  loss_refine_obj: 0.6283 (0.6045)  ML Loss (cd): -0.2500 (-0.2486)  time: 0.9496 (1.7368)  data: 0.0038 (0.8023)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 23:28:40,689 maskrcnn_benchmark INFO: ---Total norm 0.01916 clip coef 260.92801-----------------
2023-03-05 23:28:40,693 maskrcnn_benchmark INFO: energy.2.weight                                   : 0.01137, (torch.Size([1, 384]))
2023-03-05 23:28:40,693 maskrcnn_benchmark INFO: energy.0.weight                                   : 0.01068, (torch.Size([384, 768]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: sg_pooler.poolingLayer.0.weight                   : 0.00760, (torch.Size([384, 768]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: sg_layer.node_gate.bias_ih                        : 0.00419, (torch.Size([1152]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: energy.0.bias                                     : 0.00279, (torch.Size([384]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: obj_label_embedding.weight                        : 0.00264, (torch.Size([384, 279]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: sg_layer.node_gate.weight_hh                      : 0.00232, (torch.Size([1152, 384]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: sg_layer.node_gate.bias_hh                        : 0.00210, (torch.Size([1152]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: obj_emdedding.weight                              : 0.00206, (torch.Size([384, 4096]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: energy.2.bias                                     : 0.00193, (torch.Size([1]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: sg_pooler.hgate_node.0.bias                       : 0.00188, (torch.Size([1]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: sg_layer.node_gate.weight_ih                      : 0.00166, (torch.Size([1152, 384]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: sg_pooler.poolingLayer.0.bias                     : 0.00140, (torch.Size([384]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: im_pooler.poolingLayer.0.bias                     : 0.00127, (torch.Size([384]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: sg_pooler.hgate_node.0.weight                     : 0.00120, (torch.Size([1, 384]))
2023-03-05 23:28:40,694 maskrcnn_benchmark INFO: obj_label_embedding.bias                          : 0.00083, (torch.Size([384]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.2.bias                  : 0.00078, (torch.Size([384]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.2.bias                  : 0.00072, (torch.Size([384]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.2.weight                : 0.00062, (torch.Size([384, 384]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: im_pooler.poolingLayer.0.weight                   : 0.00059, (torch.Size([384, 384]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: im_pooler.hgate_node.0.weight                     : 0.00058, (torch.Size([1, 384]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.0.weight                : 0.00047, (torch.Size([384, 384]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: im_layer.node_gate.weight_hh                      : 0.00046, (torch.Size([1152, 384]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: im_pooler.hgate_node.0.bias                       : 0.00045, (torch.Size([1]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: sg_pooler.hgate_edge.0.bias                       : 0.00041, (torch.Size([1]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: pos_embed.2.weight                                : 0.00037, (torch.Size([128, 32]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.2.weight                : 0.00032, (torch.Size([384, 384]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.0.bias                  : 0.00030, (torch.Size([384]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: im_layer.node_gate.bias_ih                        : 0.00027, (torch.Size([1152]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.0.bias                  : 0.00026, (torch.Size([384]))
2023-03-05 23:28:40,695 maskrcnn_benchmark INFO: sg_layer.edge_gate.weight_hh                      : 0.00021, (torch.Size([1152, 384]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: sg_layer.edge_gate.weight_ih                      : 0.00018, (torch.Size([1152, 384]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: pos_embed.0.weight                                : 0.00016, (torch.Size([32, 9]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: sg_pooler.hgate_edge.0.weight                     : 0.00016, (torch.Size([1, 384]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: rel_label_embedding.weight                        : 0.00015, (torch.Size([384, 51]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: pos_embed.2.bias                                  : 0.00014, (torch.Size([128]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: im_layer.node_gate.bias_hh                        : 0.00014, (torch.Size([1152]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.2.bias                  : 0.00012, (torch.Size([384]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: rel_label_embedding.bias                          : 0.00012, (torch.Size([384]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: im_layer.node_gate.weight_ih                      : 0.00012, (torch.Size([1152, 384]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: im_layer.node_kernel.2.bias                       : 0.00011, (torch.Size([384]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.0.weight                : 0.00009, (torch.Size([384, 384]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.0.weight                : 0.00009, (torch.Size([384, 768, 1, 1]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.2.weight                : 0.00008, (torch.Size([384, 384, 1, 1]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: pos_embed.1.bias                                  : 0.00007, (torch.Size([32]))
2023-03-05 23:28:40,696 maskrcnn_benchmark INFO: im_layer.node_kernel.2.weight                     : 0.00006, (torch.Size([384, 384]))
2023-03-05 23:28:40,697 maskrcnn_benchmark INFO: obj_emdedding.bias                                : 0.00005, (torch.Size([384]))
2023-03-05 23:28:40,697 maskrcnn_benchmark INFO: im_layer.node_kernel.0.bias                       : 0.00004, (torch.Size([384]))
2023-03-05 23:28:40,697 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.0.bias                  : 0.00004, (torch.Size([384]))
2023-03-05 23:28:40,697 maskrcnn_benchmark INFO: pos_embed.1.weight                                : 0.00004, (torch.Size([32]))
2023-03-05 23:28:40,697 maskrcnn_benchmark INFO: im_layer.node_kernel.0.weight                     : 0.00004, (torch.Size([384, 384]))
2023-03-05 23:28:40,697 maskrcnn_benchmark INFO: pos_embed.0.bias                                  : 0.00000, (torch.Size([32]))
2023-03-05 23:28:40,697 maskrcnn_benchmark INFO: -------------------------------
2023-03-05 23:28:40,702 maskrcnn_benchmark INFO: ---Total norm 5.64151 clip coef 0.88629-----------------
2023-03-05 23:28:40,706 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc6.weight: 3.70473, (torch.Size([4096, 12544]))
2023-03-05 23:28:40,706 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc7.weight: 3.54883, (torch.Size([4096, 4096]))
2023-03-05 23:28:40,706 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 1.49882, (torch.Size([3072, 5136]))
2023-03-05 23:28:40,706 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.27368, (torch.Size([151, 512]))
2023-03-05 23:28:40,706 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 0.75842, (torch.Size([4096, 12544]))
2023-03-05 23:28:40,706 maskrcnn_benchmark INFO: roi_heads.relation.predictor.rel_compress.weight  : 0.50732, (torch.Size([51, 4096]))
2023-03-05 23:28:40,706 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.48951, (torch.Size([4096, 4096]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.31602, (torch.Size([512, 1024]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.30080, (torch.Size([256, 128, 3, 3]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_cat.weight      : 0.29716, (torch.Size([4096, 1024]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.28171, (torch.Size([2560, 512]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.26022, (torch.Size([256, 1024, 3, 3]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.20984, (torch.Size([2048, 4808]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.19712, (torch.Size([2048, 4808]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.18613, (torch.Size([128, 2, 7, 7]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.08254, (torch.Size([151]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.05018, (torch.Size([512, 1024]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.predictor.rel_compress.bias    : 0.04865, (torch.Size([51]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.04682, (torch.Size([512]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.03550, (torch.Size([22801, 51]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.03538, (torch.Size([3072]))
2023-03-05 23:28:40,707 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.03259, (torch.Size([2048, 4424]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.03238, (torch.Size([2048, 4424]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.02699, (torch.Size([128]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc6.bias : 0.02483, (torch.Size([4096]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.02181, (torch.Size([2048, 512]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.02037, (torch.Size([2048, 512]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.01846, (torch.Size([128, 32]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.01807, (torch.Size([2560]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc7.bias : 0.01778, (torch.Size([4096]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01737, (torch.Size([32, 9]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.01711, (torch.Size([4096]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_emb.weight      : 0.01389, (torch.Size([1024, 512]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.01257, (torch.Size([151, 200]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.01023, (torch.Size([128]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_cat.bias        : 0.00775, (torch.Size([4096]))
2023-03-05 23:28:40,708 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.00759, (torch.Size([256]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.00750, (torch.Size([512]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00660, (torch.Size([256]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00549, (torch.Size([152, 200]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.00494, (torch.Size([2048]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.00494, (torch.Size([2048]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.00482, (torch.Size([2048]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.00482, (torch.Size([2048]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_emb.bias        : 0.00476, (torch.Size([1024]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00466, (torch.Size([128]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00465, (torch.Size([4096]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00372, (torch.Size([2048, 512]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00369, (torch.Size([2048, 512]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00327, (torch.Size([256]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00298, (torch.Size([32]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00281, (torch.Size([32]))
2023-03-05 23:28:40,709 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00246, (torch.Size([256]))
2023-03-05 23:28:40,710 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00178, (torch.Size([128]))
2023-03-05 23:28:40,710 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00163, (torch.Size([151, 200]))
2023-03-05 23:28:40,710 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00084, (torch.Size([2048]))
2023-03-05 23:28:40,710 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00084, (torch.Size([2048]))
2023-03-05 23:28:40,710 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00081, (torch.Size([2048]))
2023-03-05 23:28:40,710 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00081, (torch.Size([2048]))
2023-03-05 23:28:40,710 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-05 23:28:40,710 maskrcnn_benchmark INFO: -------------------------------
2023-03-05 23:28:40,713 maskrcnn_benchmark INFO: eta: 22:59:00  iter: 12000  loss: 0.4704 (0.5203)  loss_rel: 0.1031 (0.1652)  loss_refine_obj: 0.5825 (0.6038)  ML Loss (cd): -0.2500 (-0.2486)  time: 0.9522 (1.7238)  data: 0.0036 (0.7889)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-05 23:28:40,715 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/model_0012000.pth
2023-03-05 23:29:22,181 maskrcnn_benchmark INFO: Start validating
2023-03-05 23:29:22,246 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-05 23:54:43,578 maskrcnn_benchmark INFO: Total run time: 0:25:21.331963 (0.30426639261245725 s / img per device, on 1 devices)
2023-03-05 23:54:43,579 maskrcnn_benchmark INFO: Model inference time: 0:23:29.260123 (0.28185202465057374 s / img per device, on 1 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(398905, 7)
0/398905
DONE (t=2.06s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=30.49s).
Accumulating evaluation results...
DONE (t=7.46s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.143
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.279
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.131
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.062
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.108
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.182
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.224
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.337
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.341
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.172
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.287
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.373
2023-03-06 00:00:29,787 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2790
====================================================================================================
SGG eval:   R @ 20: 0.2271;   R @ 50: 0.2990;   R @ 100: 0.3396;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2338; ngR @ 50: 0.3228; ngR @ 100: 0.3838;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0011;  zR @ 50: 0.0053;  zR @ 100: 0.0208;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0060;  zR @ 50: 0.0165;  zR @ 100: 0.0225;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0147;  zR @ 50: 0.0330;  zR @ 100: 0.0440;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0172;  zR @ 50: 0.0193;  zR @ 100: 0.0279;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0256;  zR @ 50: 0.0475;  zR @ 100: 0.0765;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0154;  zR @ 50: 0.0521;  zR @ 100: 0.0838;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0278;  zR @ 50: 0.0429;  zR @ 100: 0.0940;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0076;  zR @ 50: 0.0242;  zR @ 100: 0.0495;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0504;  zR @ 50: 0.0612;  zR @ 100: 0.0842;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0203;  zR @ 50: 0.0622;  zR @ 100: 0.0723;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0426;  zR @ 50: 0.0638;  zR @ 100: 0.0904;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0583;  zR @ 50: 0.0815;  zR @ 100: 0.1119;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0130;  zR @ 50: 0.0390;  zR @ 100: 0.0390;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1769;  zR @ 50: 0.2525;  zR @ 100: 0.2932;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.0833;  zR @ 50: 0.1577;  zR @ 100: 0.1994;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1859;  zR @ 50: 0.1859;  zR @ 100: 0.1859;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.3333;  zR @ 50: 0.3333;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0381;  mR @ 50: 0.0518;  mR @ 100: 0.0614;  for mode=sgdet, type=Mean Recall.
(above:0.0129) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0303) (attached to:0.0000) (behind:0.1674) (belonging to:0.0000) (between:0.0000) (carrying:0.0724) (covered in:0.0000) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.4235) (holding:0.2461) (in:0.1489) (in front of:0.0068) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2122) (of:0.2131) (on:0.4486) (on back of:0.0000) (over:0.0000) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.2068) (says:0.0000) (sitting on:0.1117) (standing on:0.0000) (to:0.0000) (under:0.0527) (using:0.0769) (walking in:0.0000) (walking on:0.0177) (watching:0.0098) (wearing:0.6013) (wears:0.0000) (with:0.0116) 
====================================================================================================

2023-03-06 00:00:30,783 maskrcnn_benchmark INFO: Validation Result: 0.3396
2023-03-06 00:03:39,858 maskrcnn_benchmark INFO: eta: 1 day, 0:47:49  iter: 12200  loss: 0.4731 (0.5192)  loss_rel: 0.1561 (0.1653)  loss_refine_obj: 0.5487 (0.6026)  ML Loss (cd): -0.2500 (-0.2487)  time: 0.9469 (1.8676)  data: 0.0036 (0.9326)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 00:06:50,056 maskrcnn_benchmark INFO: eta: 1 day, 0:29:52  iter: 12400  loss: 0.3884 (0.5180)  loss_rel: 0.1344 (0.1649)  loss_refine_obj: 0.4958 (0.6018)  ML Loss (cd): -0.2500 (-0.2487)  time: 0.9464 (1.8528)  data: 0.0037 (0.9177)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 00:09:59,340 maskrcnn_benchmark INFO: eta: 1 day, 0:12:20  iter: 12600  loss: 0.4243 (0.5169)  loss_rel: 0.0917 (0.1647)  loss_refine_obj: 0.5468 (0.6009)  ML Loss (cd): -0.2500 (-0.2487)  time: 0.9469 (1.8384)  data: 0.0035 (0.9032)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 00:13:09,858 maskrcnn_benchmark INFO: eta: 23:55:19  iter: 12800  loss: 0.5088 (0.5159)  loss_rel: 0.1072 (0.1646)  loss_refine_obj: 0.5390 (0.6000)  ML Loss (cd): -0.2500 (-0.2487)  time: 0.9532 (1.8246)  data: 0.0038 (0.8891)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 00:16:20,666 maskrcnn_benchmark INFO: eta: 23:38:44  iter: 13000  loss: 0.4772 (0.5148)  loss_rel: 0.1208 (0.1644)  loss_refine_obj: 0.5324 (0.5991)  ML Loss (cd): -0.2500 (-0.2488)  time: 0.9618 (1.8112)  data: 0.0042 (0.8755)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 00:19:31,420 maskrcnn_benchmark INFO: eta: 23:22:34  iter: 13200  loss: 0.5036 (0.5139)  loss_rel: 0.1515 (0.1644)  loss_refine_obj: 0.5302 (0.5983)  ML Loss (cd): -0.2500 (-0.2488)  time: 0.9559 (1.7982)  data: 0.0037 (0.8623)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 00:22:41,740 maskrcnn_benchmark INFO: eta: 23:06:46  iter: 13400  loss: 0.5251 (0.5131)  loss_rel: 0.1588 (0.1644)  loss_refine_obj: 0.5076 (0.5975)  ML Loss (cd): -0.2500 (-0.2488)  time: 0.9522 (1.7855)  data: 0.0037 (0.8495)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 00:25:52,621 maskrcnn_benchmark INFO: eta: 22:51:21  iter: 13600  loss: 0.3590 (0.5124)  loss_rel: 0.1325 (0.1643)  loss_refine_obj: 0.4278 (0.5969)  ML Loss (cd): -0.2500 (-0.2488)  time: 0.9568 (1.7733)  data: 0.0040 (0.8370)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 00:29:03,034 maskrcnn_benchmark INFO: eta: 22:36:17  iter: 13800  loss: 0.4157 (0.5113)  loss_rel: 0.0767 (0.1640)  loss_refine_obj: 0.5364 (0.5962)  ML Loss (cd): -0.2500 (-0.2488)  time: 0.9506 (1.7614)  data: 0.0040 (0.8250)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 00:32:13,373 maskrcnn_benchmark INFO: eta: 22:21:32  iter: 14000  loss: 0.4754 (0.5106)  loss_rel: 0.1441 (0.1639)  loss_refine_obj: 0.5833 (0.5955)  ML Loss (cd): -0.2500 (-0.2488)  time: 0.9577 (1.7498)  data: 0.0036 (0.8132)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 00:32:13,376 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/model_0014000.pth
2023-03-06 00:32:41,754 maskrcnn_benchmark INFO: Start validating
2023-03-06 00:32:41,825 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-06 00:58:16,077 maskrcnn_benchmark INFO: Total run time: 0:25:34.251211 (0.30685024218559265 s / img per device, on 1 devices)
2023-03-06 00:58:16,078 maskrcnn_benchmark INFO: Model inference time: 0:23:28.722917 (0.2817445833683014 s / img per device, on 1 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(398905, 7)
0/398905
DONE (t=1.95s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=31.32s).
Accumulating evaluation results...
DONE (t=7.44s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.144
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.281
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.133
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.059
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.107
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.183
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.223
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.333
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.338
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.170
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.283
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.368
2023-03-06 01:04:03,870 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2807
====================================================================================================
SGG eval:   R @ 20: 0.2354;   R @ 50: 0.3032;   R @ 100: 0.3450;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2446; ngR @ 50: 0.3285; ngR @ 100: 0.3897;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0011;  zR @ 50: 0.0095;  zR @ 100: 0.0243;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0060;  zR @ 50: 0.0135;  zR @ 100: 0.0270;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0110;  zR @ 50: 0.0220;  zR @ 100: 0.0330;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0279;  zR @ 50: 0.0279;  zR @ 100: 0.0279;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0300;  zR @ 50: 0.0344;  zR @ 100: 0.0629;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0308;  zR @ 50: 0.0427;  zR @ 100: 0.0701;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0367;  zR @ 50: 0.0503;  zR @ 100: 0.0783;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0182;  zR @ 50: 0.0328;  zR @ 100: 0.0394;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0360;  zR @ 50: 0.0576;  zR @ 100: 0.0935;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0203;  zR @ 50: 0.0554;  zR @ 100: 0.0689;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0319;  zR @ 50: 0.0319;  zR @ 100: 0.0836;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0262;  zR @ 50: 0.0494;  zR @ 100: 0.0780;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0000;  zR @ 50: 0.0260;  zR @ 100: 0.0260;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1478;  zR @ 50: 0.2060;  zR @ 100: 0.2467;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.1042;  zR @ 50: 0.1458;  zR @ 100: 0.2083;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1603;  zR @ 50: 0.1987;  zR @ 100: 0.2372;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.0000;  zR @ 50: 0.3333;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0431;  mR @ 50: 0.0571;  mR @ 100: 0.0676;  for mode=sgdet, type=Mean Recall.
(above:0.0272) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0354) (attached to:0.0000) (behind:0.1606) (belonging to:0.0000) (between:0.0000) (carrying:0.1842) (covered in:0.0000) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.4122) (holding:0.2376) (in:0.1413) (in front of:0.0289) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.1818) (of:0.1877) (on:0.4647) (on back of:0.0000) (over:0.0122) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.2961) (says:0.0000) (sitting on:0.1038) (standing on:0.0000) (to:0.0000) (under:0.0561) (using:0.1538) (walking in:0.0000) (walking on:0.0053) (watching:0.0294) (wearing:0.6378) (wears:0.0000) (with:0.0245) 
====================================================================================================

2023-03-06 01:04:04,855 maskrcnn_benchmark INFO: Validation Result: 0.3450
2023-03-06 01:07:14,105 maskrcnn_benchmark INFO: eta: 23:49:49  iter: 14200  loss: 0.4296 (0.5097)  loss_rel: 0.1382 (0.1638)  loss_refine_obj: 0.5736 (0.5947)  ML Loss (cd): -0.2500 (-0.2489)  time: 0.9582 (1.8731)  data: 0.0040 (0.9364)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 01:10:24,526 maskrcnn_benchmark INFO: eta: 23:33:51  iter: 14400  loss: 0.4078 (0.5088)  loss_rel: 0.1344 (0.1638)  loss_refine_obj: 0.4996 (0.5939)  ML Loss (cd): -0.2500 (-0.2489)  time: 0.9579 (1.8603)  data: 0.0038 (0.9235)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 01:13:34,263 maskrcnn_benchmark INFO: eta: 23:18:12  iter: 14600  loss: 0.4358 (0.5079)  loss_rel: 0.1049 (0.1637)  loss_refine_obj: 0.5385 (0.5931)  ML Loss (cd): -0.2500 (-0.2489)  time: 0.9489 (1.8479)  data: 0.0039 (0.9109)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 01:16:44,317 maskrcnn_benchmark INFO: eta: 23:02:54  iter: 14800  loss: 0.4417 (0.5073)  loss_rel: 0.1105 (0.1638)  loss_refine_obj: 0.4432 (0.5925)  ML Loss (cd): -0.2500 (-0.2489)  time: 0.9487 (1.8357)  data: 0.0037 (0.8986)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 01:19:54,946 maskrcnn_benchmark INFO: eta: 22:47:58  iter: 15000  loss: 0.4474 (0.5068)  loss_rel: 0.1132 (0.1637)  loss_refine_obj: 0.5577 (0.5920)  ML Loss (cd): -0.2500 (-0.2489)  time: 0.9551 (1.8240)  data: 0.0035 (0.8867)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 01:23:05,864 maskrcnn_benchmark INFO: eta: 22:33:20  iter: 15200  loss: 0.4198 (0.5062)  loss_rel: 0.1633 (0.1636)  loss_refine_obj: 0.5322 (0.5915)  ML Loss (cd): -0.2500 (-0.2489)  time: 0.9598 (1.8125)  data: 0.0037 (0.8751)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 01:26:16,753 maskrcnn_benchmark INFO: eta: 22:19:01  iter: 15400  loss: 0.3968 (0.5056)  loss_rel: 0.1085 (0.1635)  loss_refine_obj: 0.5285 (0.5911)  ML Loss (cd): -0.2500 (-0.2489)  time: 0.9584 (1.8014)  data: 0.0037 (0.8638)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 01:29:27,448 maskrcnn_benchmark INFO: eta: 22:04:58  iter: 15600  loss: 0.4417 (0.5050)  loss_rel: 0.1310 (0.1634)  loss_refine_obj: 0.5031 (0.5906)  ML Loss (cd): -0.2500 (-0.2490)  time: 0.9548 (1.7905)  data: 0.0036 (0.8527)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 01:32:38,315 maskrcnn_benchmark INFO: eta: 21:51:12  iter: 15800  loss: 0.4596 (0.5047)  loss_rel: 0.1698 (0.1634)  loss_refine_obj: 0.5361 (0.5903)  ML Loss (cd): -0.2500 (-0.2490)  time: 0.9600 (1.7799)  data: 0.0036 (0.8420)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 01:35:48,772 maskrcnn_benchmark INFO: ---Total norm 0.01648 clip coef 303.29108-----------------
2023-03-06 01:35:48,776 maskrcnn_benchmark INFO: energy.2.weight                                   : 0.00963, (torch.Size([1, 384]))
2023-03-06 01:35:48,777 maskrcnn_benchmark INFO: energy.0.weight                                   : 0.00913, (torch.Size([384, 768]))
2023-03-06 01:35:48,777 maskrcnn_benchmark INFO: sg_pooler.poolingLayer.0.weight                   : 0.00628, (torch.Size([384, 768]))
2023-03-06 01:35:48,777 maskrcnn_benchmark INFO: energy.2.bias                                     : 0.00516, (torch.Size([1]))
2023-03-06 01:35:48,777 maskrcnn_benchmark INFO: sg_layer.node_gate.bias_ih                        : 0.00293, (torch.Size([1152]))
2023-03-06 01:35:48,777 maskrcnn_benchmark INFO: obj_label_embedding.weight                        : 0.00185, (torch.Size([384, 279]))
2023-03-06 01:35:48,777 maskrcnn_benchmark INFO: sg_layer.node_gate.weight_hh                      : 0.00171, (torch.Size([1152, 384]))
2023-03-06 01:35:48,777 maskrcnn_benchmark INFO: energy.0.bias                                     : 0.00167, (torch.Size([384]))
2023-03-06 01:35:48,777 maskrcnn_benchmark INFO: sg_layer.node_gate.bias_hh                        : 0.00146, (torch.Size([1152]))
2023-03-06 01:35:48,777 maskrcnn_benchmark INFO: obj_emdedding.weight                              : 0.00146, (torch.Size([384, 4096]))
2023-03-06 01:35:48,777 maskrcnn_benchmark INFO: sg_pooler.hgate_node.0.bias                       : 0.00140, (torch.Size([1]))
2023-03-06 01:35:48,777 maskrcnn_benchmark INFO: sg_layer.node_gate.weight_ih                      : 0.00129, (torch.Size([1152, 384]))
2023-03-06 01:35:48,777 maskrcnn_benchmark INFO: sg_pooler.hgate_node.0.weight                     : 0.00087, (torch.Size([1, 384]))
2023-03-06 01:35:48,777 maskrcnn_benchmark INFO: im_pooler.poolingLayer.0.bias                     : 0.00069, (torch.Size([384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.2.weight                : 0.00064, (torch.Size([384, 384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: sg_pooler.poolingLayer.0.bias                     : 0.00058, (torch.Size([384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.2.bias                  : 0.00055, (torch.Size([384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: im_pooler.hgate_node.0.weight                     : 0.00054, (torch.Size([1, 384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: obj_label_embedding.bias                          : 0.00052, (torch.Size([384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.0.weight                : 0.00052, (torch.Size([384, 384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.2.bias                  : 0.00050, (torch.Size([384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: im_pooler.poolingLayer.0.weight                   : 0.00035, (torch.Size([384, 384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: im_layer.node_gate.weight_hh                      : 0.00034, (torch.Size([1152, 384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: sg_layer.edge_gate.weight_hh                      : 0.00028, (torch.Size([1152, 384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: im_pooler.hgate_node.0.bias                       : 0.00027, (torch.Size([1]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.2.weight                : 0.00022, (torch.Size([384, 384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.0.bias                  : 0.00020, (torch.Size([384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: pos_embed.2.weight                                : 0.00020, (torch.Size([128, 32]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: sg_layer.edge_gate.weight_ih                      : 0.00020, (torch.Size([1152, 384]))
2023-03-06 01:35:48,778 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.0.bias                  : 0.00019, (torch.Size([384]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: rel_label_embedding.weight                        : 0.00019, (torch.Size([384, 51]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: sg_pooler.hgate_edge.0.bias                       : 0.00014, (torch.Size([1]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.2.bias                  : 0.00013, (torch.Size([384]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: rel_label_embedding.bias                          : 0.00012, (torch.Size([384]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: im_layer.node_gate.bias_ih                        : 0.00011, (torch.Size([1152]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: sg_pooler.hgate_edge.0.weight                     : 0.00011, (torch.Size([1, 384]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: pos_embed.0.weight                                : 0.00010, (torch.Size([32, 9]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.0.weight                : 0.00009, (torch.Size([384, 768, 1, 1]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.2.weight                : 0.00008, (torch.Size([384, 384, 1, 1]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: pos_embed.2.bias                                  : 0.00008, (torch.Size([128]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.0.weight                : 0.00008, (torch.Size([384, 384]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: im_layer.node_gate.bias_hh                        : 0.00006, (torch.Size([1152]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: im_layer.node_gate.weight_ih                      : 0.00006, (torch.Size([1152, 384]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.0.bias                  : 0.00004, (torch.Size([384]))
2023-03-06 01:35:48,779 maskrcnn_benchmark INFO: im_layer.node_kernel.2.bias                       : 0.00004, (torch.Size([384]))
2023-03-06 01:35:48,780 maskrcnn_benchmark INFO: pos_embed.1.bias                                  : 0.00004, (torch.Size([32]))
2023-03-06 01:35:48,780 maskrcnn_benchmark INFO: im_layer.node_kernel.2.weight                     : 0.00003, (torch.Size([384, 384]))
2023-03-06 01:35:48,780 maskrcnn_benchmark INFO: im_layer.node_kernel.0.weight                     : 0.00002, (torch.Size([384, 384]))
2023-03-06 01:35:48,780 maskrcnn_benchmark INFO: obj_emdedding.bias                                : 0.00002, (torch.Size([384]))
2023-03-06 01:35:48,780 maskrcnn_benchmark INFO: pos_embed.1.weight                                : 0.00002, (torch.Size([32]))
2023-03-06 01:35:48,780 maskrcnn_benchmark INFO: im_layer.node_kernel.0.bias                       : 0.00001, (torch.Size([384]))
2023-03-06 01:35:48,780 maskrcnn_benchmark INFO: pos_embed.0.bias                                  : 0.00000, (torch.Size([32]))
2023-03-06 01:35:48,780 maskrcnn_benchmark INFO: -------------------------------
2023-03-06 01:35:48,782 maskrcnn_benchmark INFO: ---Total norm 4.21450 clip coef 1.18638-----------------
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc6.weight: 2.75431, (torch.Size([4096, 12544]))
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc7.weight: 2.66145, (torch.Size([4096, 4096]))
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 1.26826, (torch.Size([3072, 5136]))
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.05316, (torch.Size([151, 512]))
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 0.32852, (torch.Size([4096, 12544]))
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.22682, (torch.Size([4096, 4096]))
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.21742, (torch.Size([2560, 512]))
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.predictor.rel_compress.weight  : 0.20861, (torch.Size([51, 4096]))
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.16069, (torch.Size([512, 1024]))
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_cat.weight      : 0.15403, (torch.Size([4096, 1024]))
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.13216, (torch.Size([256, 128, 3, 3]))
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.12855, (torch.Size([256, 1024, 3, 3]))
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.12097, (torch.Size([2048, 4808]))
2023-03-06 01:35:48,787 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.11365, (torch.Size([2048, 4808]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.06265, (torch.Size([128, 2, 7, 7]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.06158, (torch.Size([151]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.03404, (torch.Size([512, 1024]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.02376, (torch.Size([2048, 4424]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.02369, (torch.Size([512]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.02316, (torch.Size([2048, 4424]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.02168, (torch.Size([3072]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc6.bias : 0.02013, (torch.Size([4096]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.predictor.rel_compress.bias    : 0.01917, (torch.Size([51]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.01898, (torch.Size([22801, 51]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.01447, (torch.Size([2560]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.01263, (torch.Size([128, 32]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.01241, (torch.Size([2048, 512]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.01137, (torch.Size([32, 9]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc7.bias : 0.01129, (torch.Size([4096]))
2023-03-06 01:35:48,788 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.01053, (torch.Size([2048, 512]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.01047, (torch.Size([128]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.00998, (torch.Size([4096]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.00833, (torch.Size([151, 200]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_emb.weight      : 0.00760, (torch.Size([1024, 512]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.00519, (torch.Size([256]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00411, (torch.Size([152, 200]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.00402, (torch.Size([512]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_cat.bias        : 0.00359, (torch.Size([4096]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.00321, (torch.Size([128]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00312, (torch.Size([256]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00266, (torch.Size([4096]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00262, (torch.Size([128]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.00260, (torch.Size([2048]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.00260, (torch.Size([2048]))
2023-03-06 01:35:48,789 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00258, (torch.Size([2048, 512]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00251, (torch.Size([2048, 512]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_emb.bias        : 0.00238, (torch.Size([1024]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.00236, (torch.Size([2048]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.00236, (torch.Size([2048]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00202, (torch.Size([32]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00187, (torch.Size([256]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00174, (torch.Size([32]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00170, (torch.Size([128]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00144, (torch.Size([256]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00082, (torch.Size([151, 200]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00049, (torch.Size([2048]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00049, (torch.Size([2048]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00049, (torch.Size([2048]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00049, (torch.Size([2048]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-06 01:35:48,790 maskrcnn_benchmark INFO: -------------------------------
2023-03-06 01:35:48,793 maskrcnn_benchmark INFO: eta: 21:37:41  iter: 16000  loss: 0.3562 (0.5040)  loss_rel: 0.1118 (0.1632)  loss_refine_obj: 0.4353 (0.5897)  ML Loss (cd): -0.2500 (-0.2490)  time: 0.9449 (1.7696)  data: 0.0040 (0.8315)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 01:35:48,796 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/model_0016000.pth
2023-03-06 01:36:22,971 maskrcnn_benchmark INFO: Start validating
2023-03-06 01:36:23,038 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-06 02:01:56,129 maskrcnn_benchmark INFO: Total run time: 0:25:33.090973 (0.3066181945800781 s / img per device, on 1 devices)
2023-03-06 02:01:56,130 maskrcnn_benchmark INFO: Model inference time: 0:23:33.137126 (0.2826274251461029 s / img per device, on 1 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(398905, 7)
0/398905
DONE (t=1.91s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=30.63s).
Accumulating evaluation results...
DONE (t=7.43s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.141
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.276
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.128
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.058
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.104
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.179
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.221
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.333
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.338
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.170
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.284
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.369
2023-03-06 02:07:42,703 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2758
====================================================================================================
SGG eval:   R @ 20: 0.2190;   R @ 50: 0.2890;   R @ 100: 0.3334;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2241; ngR @ 50: 0.3107; ngR @ 100: 0.3722;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0032;  zR @ 50: 0.0137;  zR @ 100: 0.0282;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0055;  zR @ 50: 0.0185;  zR @ 100: 0.0320;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0201;  zR @ 50: 0.0348;  zR @ 100: 0.0458;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0193;  zR @ 50: 0.0193;  zR @ 100: 0.0365;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0212;  zR @ 50: 0.0365;  zR @ 100: 0.0585;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0308;  zR @ 50: 0.0581;  zR @ 100: 0.0799;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0250;  zR @ 50: 0.0435;  zR @ 100: 0.0724;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0121;  zR @ 50: 0.0343;  zR @ 100: 0.0429;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0432;  zR @ 50: 0.0863;  zR @ 100: 0.1129;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0216;  zR @ 50: 0.0486;  zR @ 100: 0.0824;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0213;  zR @ 50: 0.0677;  zR @ 100: 0.1155;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0536;  zR @ 50: 0.0833;  zR @ 100: 0.1321;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0260;  zR @ 50: 0.0260;  zR @ 100: 0.0260;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1047;  zR @ 50: 0.2176;  zR @ 100: 0.2699;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.1042;  zR @ 50: 0.1667;  zR @ 100: 0.1667;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.0833;  zR @ 50: 0.1603;  zR @ 100: 0.1987;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.3333;  zR @ 50: 0.6667;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0362;  mR @ 50: 0.0499;  mR @ 100: 0.0596;  for mode=sgdet, type=Mean Recall.
(above:0.0244) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0404) (attached to:0.0000) (behind:0.1570) (belonging to:0.0000) (between:0.0000) (carrying:0.0417) (covered in:0.0000) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.3727) (holding:0.2314) (in:0.1292) (in front of:0.0203) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2529) (of:0.1901) (on:0.4483) (on back of:0.0000) (over:0.0122) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.2812) (says:0.0000) (sitting on:0.0834) (standing on:0.0000) (to:0.0000) (under:0.0561) (using:0.0000) (walking in:0.0000) (walking on:0.0093) (watching:0.0196) (wearing:0.6002) (wears:0.0000) (with:0.0095) 
====================================================================================================

2023-03-06 02:07:43,676 maskrcnn_benchmark INFO: Validation Result: 0.3334
2023-03-06 02:10:52,141 maskrcnn_benchmark INFO: eta: 22:50:37  iter: 16200  loss: 0.4190 (0.5034)  loss_rel: 0.1391 (0.1633)  loss_refine_obj: 0.4998 (0.5891)  ML Loss (cd): -0.2500 (-0.2490)  time: 0.9470 (1.8776)  data: 0.0041 (0.9395)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 02:14:02,177 maskrcnn_benchmark INFO: eta: 22:36:08  iter: 16400  loss: 0.5137 (0.5032)  loss_rel: 0.1821 (0.1634)  loss_refine_obj: 0.5375 (0.5887)  ML Loss (cd): -0.2500 (-0.2490)  time: 0.9501 (1.8663)  data: 0.0037 (0.9281)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 02:17:13,310 maskrcnn_benchmark INFO: eta: 22:21:59  iter: 16600  loss: 0.5739 (0.5029)  loss_rel: 0.0908 (0.1634)  loss_refine_obj: 0.7178 (0.5885)  ML Loss (cd): -0.2500 (-0.2490)  time: 0.9617 (1.8553)  data: 0.0037 (0.9170)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 02:20:23,660 maskrcnn_benchmark INFO: eta: 22:08:03  iter: 16800  loss: 0.4632 (0.5025)  loss_rel: 0.1107 (0.1633)  loss_refine_obj: 0.5696 (0.5883)  ML Loss (cd): -0.2500 (-0.2490)  time: 0.9504 (1.8445)  data: 0.0036 (0.9061)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 02:23:33,929 maskrcnn_benchmark INFO: eta: 21:54:22  iter: 17000  loss: 0.4730 (0.5017)  loss_rel: 0.1236 (0.1632)  loss_refine_obj: 0.5003 (0.5875)  ML Loss (cd): -0.2500 (-0.2490)  time: 0.9556 (1.8340)  data: 0.0040 (0.8955)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 02:26:43,889 maskrcnn_benchmark INFO: eta: 21:40:56  iter: 17200  loss: 0.4870 (0.5015)  loss_rel: 0.1682 (0.1635)  loss_refine_obj: 0.5483 (0.5870)  ML Loss (cd): -0.2499 (-0.2490)  time: 0.9484 (1.8237)  data: 0.0040 (0.8851)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 02:29:54,857 maskrcnn_benchmark INFO: eta: 21:27:45  iter: 17400  loss: 0.3907 (0.5010)  loss_rel: 0.1525 (0.1634)  loss_refine_obj: 0.4808 (0.5867)  ML Loss (cd): -0.2500 (-0.2491)  time: 0.9493 (1.8138)  data: 0.0036 (0.8750)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 02:33:04,563 maskrcnn_benchmark INFO: eta: 21:14:46  iter: 17600  loss: 0.3988 (0.5002)  loss_rel: 0.1095 (0.1633)  loss_refine_obj: 0.4950 (0.5860)  ML Loss (cd): -0.2500 (-0.2491)  time: 0.9479 (1.8039)  data: 0.0039 (0.8651)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 02:36:15,190 maskrcnn_benchmark INFO: eta: 21:02:02  iter: 17800  loss: 0.4428 (0.4999)  loss_rel: 0.1174 (0.1632)  loss_refine_obj: 0.5132 (0.5857)  ML Loss (cd): -0.2500 (-0.2491)  time: 0.9493 (1.7944)  data: 0.0039 (0.8554)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 02:39:26,124 maskrcnn_benchmark INFO: eta: 20:49:31  iter: 18000  loss: 0.3907 (0.4994)  loss_rel: 0.1087 (0.1631)  loss_refine_obj: 0.4819 (0.5853)  ML Loss (cd): -0.2500 (-0.2491)  time: 0.9478 (1.7850)  data: 0.0038 (0.8459)  energy lr: 0.005000  base lr : 0.005000  max mem: 8958
2023-03-06 02:39:26,128 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/model_0018000.pth
2023-03-06 02:40:00,524 maskrcnn_benchmark INFO: Start validating
2023-03-06 02:40:00,588 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-06 03:05:37,955 maskrcnn_benchmark INFO: Total run time: 0:25:37.366145 (0.3074732290267944 s / img per device, on 1 devices)
2023-03-06 03:05:37,956 maskrcnn_benchmark INFO: Model inference time: 0:23:32.409354 (0.28248187079429626 s / img per device, on 1 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(398905, 7)
0/398905
DONE (t=1.95s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=31.03s).
Accumulating evaluation results...
DONE (t=7.48s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.141
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.276
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.129
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.058
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.105
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.178
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.222
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.334
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.338
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.169
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.286
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.367
2023-03-06 03:11:24,964 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2755
====================================================================================================
SGG eval:   R @ 20: 0.2157;   R @ 50: 0.2884;   R @ 100: 0.3349;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2193; ngR @ 50: 0.3082; ngR @ 100: 0.3734;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0085;  zR @ 50: 0.0127;  zR @ 100: 0.0222;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0075;  zR @ 50: 0.0135;  zR @ 100: 0.0245;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0073;  zR @ 50: 0.0220;  zR @ 100: 0.0330;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0193;  zR @ 50: 0.0236;  zR @ 100: 0.0408;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0234;  zR @ 50: 0.0431;  zR @ 100: 0.0612;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0256;  zR @ 50: 0.0564;  zR @ 100: 0.0769;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0278;  zR @ 50: 0.0500;  zR @ 100: 0.0667;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0136;  zR @ 50: 0.0318;  zR @ 100: 0.0530;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0216;  zR @ 50: 0.0576;  zR @ 100: 0.0755;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0284;  zR @ 50: 0.0655;  zR @ 100: 0.0993;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0319;  zR @ 50: 0.0372;  zR @ 100: 0.0904;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0274;  zR @ 50: 0.0702;  zR @ 100: 0.0940;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0130;  zR @ 50: 0.0390;  zR @ 100: 0.0390;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1478;  zR @ 50: 0.1944;  zR @ 100: 0.2525;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.0208;  zR @ 50: 0.1250;  zR @ 100: 0.1667;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1474;  zR @ 50: 0.1859;  zR @ 100: 0.2244;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.3333;  zR @ 50: 0.6667;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0381;  mR @ 50: 0.0534;  mR @ 100: 0.0639;  for mode=sgdet, type=Mean Recall.
(above:0.0158) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0404) (attached to:0.0000) (behind:0.1666) (belonging to:0.0000) (between:0.0000) (carrying:0.1009) (covered in:0.0000) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.3883) (holding:0.2960) (in:0.1239) (in front of:0.0173) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2414) (of:0.2060) (on:0.4389) (on back of:0.0000) (over:0.0000) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.3021) (says:0.0000) (sitting on:0.1143) (standing on:0.0000) (to:0.0000) (under:0.0510) (using:0.0000) (walking in:0.0000) (walking on:0.0044) (watching:0.0098) (wearing:0.6442) (wears:0.0000) (with:0.0353) 
====================================================================================================

2023-03-06 03:11:25,948 maskrcnn_benchmark INFO: Validation Result: 0.3349
2023-03-06 03:11:25,950 maskrcnn_benchmark INFO: Trigger Schedule Decay, RL has been reduced by factor 0.05
2023-03-06 03:11:25,950 maskrcnn_benchmark INFO: Trigger Schedule Decay, RL has been reduced by factor 0.05
2023-03-06 03:14:34,545 maskrcnn_benchmark INFO: eta: 21:50:36  iter: 18200  loss: 0.3294 (0.4987)  loss_rel: 0.0906 (0.1630)  loss_refine_obj: 0.4884 (0.5848)  ML Loss (cd): -0.2500 (-0.2491)  time: 0.9412 (1.8813)  data: 0.0040 (0.9422)  energy lr: 0.000250  base lr : 0.000250  max mem: 8958
2023-03-06 03:17:44,250 maskrcnn_benchmark INFO: eta: 21:37:18  iter: 18400  loss: 0.4005 (0.4980)  loss_rel: 0.1096 (0.1628)  loss_refine_obj: 0.4862 (0.5843)  ML Loss (cd): -0.2500 (-0.2491)  time: 0.9437 (1.8711)  data: 0.0039 (0.9320)  energy lr: 0.000250  base lr : 0.000250  max mem: 8958
2023-03-06 03:20:53,876 maskrcnn_benchmark INFO: eta: 21:24:13  iter: 18600  loss: 0.4360 (0.4974)  loss_rel: 0.1057 (0.1628)  loss_refine_obj: 0.5908 (0.5837)  ML Loss (cd): -0.2500 (-0.2491)  time: 0.9545 (1.8612)  data: 0.0038 (0.9220)  energy lr: 0.000250  base lr : 0.000250  max mem: 8958
2023-03-06 03:24:04,646 maskrcnn_benchmark INFO: eta: 21:11:23  iter: 18800  loss: 0.3848 (0.4968)  loss_rel: 0.1033 (0.1627)  loss_refine_obj: 0.5900 (0.5832)  ML Loss (cd): -0.2500 (-0.2491)  time: 0.9555 (1.8515)  data: 0.0035 (0.9122)  energy lr: 0.000250  base lr : 0.000250  max mem: 8958
2023-03-06 03:27:14,786 maskrcnn_benchmark INFO: eta: 20:58:44  iter: 19000  loss: 0.3306 (0.4959)  loss_rel: 0.1153 (0.1627)  loss_refine_obj: 0.4673 (0.5824)  ML Loss (cd): -0.2500 (-0.2491)  time: 0.9499 (1.8421)  data: 0.0037 (0.9027)  energy lr: 0.000250  base lr : 0.000250  max mem: 8958
2023-03-06 03:30:24,121 maskrcnn_benchmark INFO: eta: 20:46:15  iter: 19200  loss: 0.4614 (0.4951)  loss_rel: 0.1655 (0.1628)  loss_refine_obj: 0.5045 (0.5814)  ML Loss (cd): -0.2500 (-0.2491)  time: 0.9515 (1.8327)  data: 0.0037 (0.8933)  energy lr: 0.000250  base lr : 0.000250  max mem: 8958
2023-03-06 03:33:34,499 maskrcnn_benchmark INFO: eta: 20:34:00  iter: 19400  loss: 0.4329 (0.4944)  loss_rel: 0.0974 (0.1629)  loss_refine_obj: 0.5606 (0.5807)  ML Loss (cd): -0.2500 (-0.2492)  time: 0.9506 (1.8237)  data: 0.0037 (0.8841)  energy lr: 0.000250  base lr : 0.000250  max mem: 8958
2023-03-06 03:36:44,752 maskrcnn_benchmark INFO: eta: 20:21:56  iter: 19600  loss: 0.3986 (0.4941)  loss_rel: 0.1490 (0.1629)  loss_refine_obj: 0.4570 (0.5803)  ML Loss (cd): -0.2500 (-0.2492)  time: 0.9462 (1.8148)  data: 0.0038 (0.8752)  energy lr: 0.000250  base lr : 0.000250  max mem: 8958
2023-03-06 03:39:55,322 maskrcnn_benchmark INFO: eta: 20:10:03  iter: 19800  loss: 0.4124 (0.4933)  loss_rel: 0.1144 (0.1628)  loss_refine_obj: 0.5262 (0.5797)  ML Loss (cd): -0.2500 (-0.2492)  time: 0.9588 (1.8060)  data: 0.0040 (0.8664)  energy lr: 0.000250  base lr : 0.000250  max mem: 8958
2023-03-06 03:43:06,086 maskrcnn_benchmark INFO: ---Total norm 0.02601 clip coef 192.20157-----------------
2023-03-06 03:43:06,090 maskrcnn_benchmark INFO: energy.2.weight                                   : 0.01473, (torch.Size([1, 384]))
2023-03-06 03:43:06,090 maskrcnn_benchmark INFO: energy.0.weight                                   : 0.01339, (torch.Size([384, 768]))
2023-03-06 03:43:06,090 maskrcnn_benchmark INFO: energy.2.bias                                     : 0.01077, (torch.Size([1]))
2023-03-06 03:43:06,090 maskrcnn_benchmark INFO: sg_pooler.poolingLayer.0.weight                   : 0.00949, (torch.Size([384, 768]))
2023-03-06 03:43:06,090 maskrcnn_benchmark INFO: sg_layer.node_gate.bias_ih                        : 0.00504, (torch.Size([1152]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: obj_label_embedding.weight                        : 0.00290, (torch.Size([384, 279]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: energy.0.bias                                     : 0.00269, (torch.Size([384]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: sg_layer.node_gate.weight_hh                      : 0.00260, (torch.Size([1152, 384]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: sg_layer.node_gate.bias_hh                        : 0.00253, (torch.Size([1152]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: obj_emdedding.weight                              : 0.00215, (torch.Size([384, 4096]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: sg_layer.node_gate.weight_ih                      : 0.00212, (torch.Size([1152, 384]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: sg_pooler.hgate_node.0.bias                       : 0.00132, (torch.Size([1]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: obj_label_embedding.bias                          : 0.00101, (torch.Size([384]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.2.weight                : 0.00095, (torch.Size([384, 384]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.2.bias                  : 0.00095, (torch.Size([384]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: sg_pooler.poolingLayer.0.bias                     : 0.00094, (torch.Size([384]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.2.bias                  : 0.00090, (torch.Size([384]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: sg_pooler.hgate_node.0.weight                     : 0.00086, (torch.Size([1, 384]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: im_pooler.poolingLayer.0.bias                     : 0.00084, (torch.Size([384]))
2023-03-06 03:43:06,091 maskrcnn_benchmark INFO: im_pooler.hgate_node.0.weight                     : 0.00083, (torch.Size([1, 384]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.0.weight                : 0.00081, (torch.Size([384, 384]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: sg_pooler.hgate_edge.0.bias                       : 0.00063, (torch.Size([1]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: im_layer.node_gate.weight_hh                      : 0.00051, (torch.Size([1152, 384]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: sg_layer.edge_gate.weight_hh                      : 0.00046, (torch.Size([1152, 384]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: im_pooler.poolingLayer.0.weight                   : 0.00045, (torch.Size([384, 384]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.2.weight                : 0.00041, (torch.Size([384, 384]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: pos_embed.2.weight                                : 0.00036, (torch.Size([128, 32]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.0.bias                  : 0.00036, (torch.Size([384]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: sg_layer.edge_gate.weight_ih                      : 0.00035, (torch.Size([1152, 384]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: rel_label_embedding.weight                        : 0.00031, (torch.Size([384, 51]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: sg_layer.edge2node_kernel.0.bias                  : 0.00031, (torch.Size([384]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: sg_pooler.hgate_edge.0.weight                     : 0.00025, (torch.Size([1, 384]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.2.bias                  : 0.00024, (torch.Size([384]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: pos_embed.0.weight                                : 0.00023, (torch.Size([32, 9]))
2023-03-06 03:43:06,092 maskrcnn_benchmark INFO: rel_label_embedding.bias                          : 0.00020, (torch.Size([384]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: im_pooler.hgate_node.0.bias                       : 0.00019, (torch.Size([1]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.0.weight                : 0.00016, (torch.Size([384, 768, 1, 1]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: pos_embed.2.bias                                  : 0.00015, (torch.Size([128]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.2.weight                : 0.00015, (torch.Size([384, 384, 1, 1]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: im_layer.node_gate.bias_ih                        : 0.00012, (torch.Size([1152]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: sg_layer.node2node_kernel.0.weight                : 0.00010, (torch.Size([384, 384]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: sg_layer.node2edge_kernel.0.bias                  : 0.00008, (torch.Size([384]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: pos_embed.1.bias                                  : 0.00007, (torch.Size([32]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: im_layer.node_gate.weight_ih                      : 0.00007, (torch.Size([1152, 384]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: im_layer.node_gate.bias_hh                        : 0.00006, (torch.Size([1152]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: im_layer.node_kernel.2.weight                     : 0.00005, (torch.Size([384, 384]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: pos_embed.1.weight                                : 0.00004, (torch.Size([32]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: im_layer.node_kernel.2.bias                       : 0.00004, (torch.Size([384]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: im_layer.node_kernel.0.weight                     : 0.00004, (torch.Size([384, 384]))
2023-03-06 03:43:06,093 maskrcnn_benchmark INFO: obj_emdedding.bias                                : 0.00002, (torch.Size([384]))
2023-03-06 03:43:06,094 maskrcnn_benchmark INFO: im_layer.node_kernel.0.bias                       : 0.00001, (torch.Size([384]))
2023-03-06 03:43:06,094 maskrcnn_benchmark INFO: pos_embed.0.bias                                  : 0.00000, (torch.Size([32]))
2023-03-06 03:43:06,094 maskrcnn_benchmark INFO: -------------------------------
2023-03-06 03:43:06,098 maskrcnn_benchmark INFO: ---Total norm 5.11759 clip coef 0.97702-----------------
2023-03-06 03:43:06,102 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc6.weight: 3.47510, (torch.Size([4096, 12544]))
2023-03-06 03:43:06,102 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc7.weight: 3.12563, (torch.Size([4096, 4096]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.weight: 1.63288, (torch.Size([3072, 5136]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.weight: 1.17939, (torch.Size([151, 512]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc6.weight: 0.25886, (torch.Size([4096, 12544]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.weight: 0.24176, (torch.Size([2560, 512]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.predictor.rel_compress.weight  : 0.23478, (torch.Size([51, 4096]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc7.weight: 0.17504, (torch.Size([4096, 4096]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_edge_h.weight: 0.12227, (torch.Size([512, 1024]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_cat.weight      : 0.12053, (torch.Size([4096, 1024]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.weight: 0.10402, (torch.Size([256, 1024, 3, 3]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0: 0.09371, (torch.Size([2048, 4808]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_ih_l0_reverse: 0.08979, (torch.Size([2048, 4808]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.4.weight: 0.07779, (torch.Size([256, 128, 3, 3]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.out_obj.bias: 0.06332, (torch.Size([151]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.0.weight: 0.04169, (torch.Size([128, 2, 7, 7]))
2023-03-06 03:43:06,103 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_obj_h.weight: 0.03884, (torch.Size([512, 1024]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.input_linearity.bias: 0.02812, (torch.Size([3072]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0_reverse: 0.02722, (torch.Size([2048, 4424]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_ih_l0: 0.02699, (torch.Size([2048, 4424]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.predictor.rel_compress.bias    : 0.02590, (torch.Size([51]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc6.bias : 0.01654, (torch.Size([4096]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_edge_h.bias: 0.01615, (torch.Size([512]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.predictor.freq_bias.obj_baseline.weight: 0.01517, (torch.Size([22801, 51]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.state_linearity.bias: 0.01511, (torch.Size([2560]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.box_feature_extractor.fc7.bias : 0.01275, (torch.Size([4096]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.2.weight: 0.01264, (torch.Size([128, 32]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_embed1.weight: 0.01015, (torch.Size([151, 200]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.0.weight: 0.00997, (torch.Size([32, 9]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.0.bias: 0.00882, (torch.Size([128]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0: 0.00827, (torch.Size([2048, 512]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.weight_hh_l0_reverse: 0.00808, (torch.Size([2048, 512]))
2023-03-06 03:43:06,104 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc7.bias: 0.00712, (torch.Size([4096]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_emb.weight      : 0.00568, (torch.Size([1024, 512]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.lin_obj_h.bias: 0.00508, (torch.Size([512]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.decoder_rnn.obj_embed.weight: 0.00409, (torch.Size([152, 200]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.2.bias: 0.00313, (torch.Size([128]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.6.bias: 0.00311, (torch.Size([256]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_cat.bias        : 0.00301, (torch.Size([4096]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0_reverse: 0.00278, (torch.Size([2048, 512]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.weight_hh_l0: 0.00277, (torch.Size([2048, 512]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.2.weight: 0.00214, (torch.Size([128]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.1.bias: 0.00204, (torch.Size([32]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.6.weight: 0.00194, (torch.Size([256]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0: 0.00188, (torch.Size([2048]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0: 0.00188, (torch.Size([2048]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.predictor.post_emb.bias        : 0.00187, (torch.Size([1024]))
2023-03-06 03:43:06,105 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_ih_l0_reverse: 0.00178, (torch.Size([2048]))
2023-03-06 03:43:06,106 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.edge_ctx_rnn.bias_hh_l0_reverse: 0.00178, (torch.Size([2048]))
2023-03-06 03:43:06,106 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.fc6.bias: 0.00169, (torch.Size([4096]))
2023-03-06 03:43:06,106 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.4.bias: 0.00104, (torch.Size([256]))
2023-03-06 03:43:06,106 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.1.weight: 0.00097, (torch.Size([32]))
2023-03-06 03:43:06,106 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.feature_extractor.pooler.reduce_channel.0.bias: 0.00090, (torch.Size([256]))
2023-03-06 03:43:06,106 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_embed2.weight: 0.00068, (torch.Size([151, 200]))
2023-03-06 03:43:06,106 maskrcnn_benchmark INFO: roi_heads.relation.union_feature_extractor.rect_conv.2.bias: 0.00063, (torch.Size([128]))
2023-03-06 03:43:06,106 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0: 0.00058, (torch.Size([2048]))
2023-03-06 03:43:06,106 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0: 0.00058, (torch.Size([2048]))
2023-03-06 03:43:06,106 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_ih_l0_reverse: 0.00057, (torch.Size([2048]))
2023-03-06 03:43:06,106 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.obj_ctx_rnn.bias_hh_l0_reverse: 0.00057, (torch.Size([2048]))
2023-03-06 03:43:06,106 maskrcnn_benchmark INFO: roi_heads.relation.predictor.context_layer.pos_embed.0.bias: 0.00000, (torch.Size([32]))
2023-03-06 03:43:06,106 maskrcnn_benchmark INFO: -------------------------------
2023-03-06 03:43:06,109 maskrcnn_benchmark INFO: eta: 19:58:21  iter: 20000  loss: 0.4775 (0.4928)  loss_rel: 0.1109 (0.1627)  loss_refine_obj: 0.6177 (0.5793)  ML Loss (cd): -0.2500 (-0.2492)  time: 0.9530 (1.7975)  data: 0.0037 (0.8577)  energy lr: 0.000250  base lr : 0.000250  max mem: 8958
2023-03-06 03:43:06,112 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/model_0020000.pth
2023-03-06 03:43:40,568 maskrcnn_benchmark INFO: Start validating
2023-03-06 03:43:40,635 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-06 04:09:02,419 maskrcnn_benchmark INFO: Total run time: 0:25:21.784152 (0.3043568304538727 s / img per device, on 1 devices)
2023-03-06 04:09:02,420 maskrcnn_benchmark INFO: Model inference time: 0:23:26.955105 (0.2813910210132599 s / img per device, on 1 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(398905, 7)
0/398905
DONE (t=1.94s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=31.28s).
Accumulating evaluation results...
DONE (t=7.46s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.145
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.283
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.134
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.059
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.107
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.184
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.225
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.340
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.344
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.172
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.290
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.374
2023-03-06 04:14:51,381 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2831
====================================================================================================
SGG eval:   R @ 20: 0.2397;   R @ 50: 0.3078;   R @ 100: 0.3505;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2487; ngR @ 50: 0.3359; ngR @ 100: 0.3963;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0021;  zR @ 50: 0.0116;  zR @ 100: 0.0201;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0060;  zR @ 50: 0.0135;  zR @ 100: 0.0260;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0147;  zR @ 50: 0.0183;  zR @ 100: 0.0366;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0236;  zR @ 50: 0.0236;  zR @ 100: 0.0354;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0278;  zR @ 50: 0.0475;  zR @ 100: 0.0629;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0359;  zR @ 50: 0.0615;  zR @ 100: 0.0889;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0333;  zR @ 50: 0.0528;  zR @ 100: 0.0809;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0121;  zR @ 50: 0.0278;  zR @ 100: 0.0449;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0216;  zR @ 50: 0.0612;  zR @ 100: 0.0899;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0149;  zR @ 50: 0.0554;  zR @ 100: 0.1027;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0319;  zR @ 50: 0.0479;  zR @ 100: 0.0916;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0274;  zR @ 50: 0.0655;  zR @ 100: 0.0940;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0130;  zR @ 50: 0.0260;  zR @ 100: 0.0390;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1595;  zR @ 50: 0.2060;  zR @ 100: 0.2757;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.1042;  zR @ 50: 0.1250;  zR @ 100: 0.1875;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1090;  zR @ 50: 0.1859;  zR @ 100: 0.2436;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.3333;  zR @ 50: 0.6667;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0402;  mR @ 50: 0.0542;  mR @ 100: 0.0649;  for mode=sgdet, type=Mean Recall.
(above:0.0215) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0463) (attached to:0.0000) (behind:0.1709) (belonging to:0.0000) (between:0.0000) (carrying:0.0811) (covered in:0.0000) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.4062) (holding:0.2720) (in:0.1431) (in front of:0.0128) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2148) (of:0.2141) (on:0.4683) (on back of:0.0000) (over:0.0122) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.3140) (says:0.0000) (sitting on:0.1274) (standing on:0.0022) (to:0.0000) (under:0.0459) (using:0.0000) (walking in:0.0000) (walking on:0.0044) (watching:0.0098) (wearing:0.6555) (wears:0.0000) (with:0.0243) 
====================================================================================================

2023-03-06 04:14:52,356 maskrcnn_benchmark INFO: Validation Result: 0.3505
2023-03-06 04:18:01,616 maskrcnn_benchmark INFO: eta: 20:49:22  iter: 20200  loss: 0.3785 (0.4920)  loss_rel: 0.1151 (0.1625)  loss_refine_obj: 0.4759 (0.5787)  ML Loss (cd): -0.2500 (-0.2492)  time: 0.9477 (1.8835)  data: 0.0040 (0.9437)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 04:21:12,924 maskrcnn_benchmark INFO: eta: 20:37:05  iter: 20400  loss: 0.3335 (0.4911)  loss_rel: 0.1262 (0.1623)  loss_refine_obj: 0.3851 (0.5779)  ML Loss (cd): -0.2500 (-0.2492)  time: 0.9444 (1.8744)  data: 0.0038 (0.9344)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 04:24:23,528 maskrcnn_benchmark INFO: eta: 20:24:58  iter: 20600  loss: 0.3496 (0.4902)  loss_rel: 0.1068 (0.1621)  loss_refine_obj: 0.4758 (0.5773)  ML Loss (cd): -0.2500 (-0.2492)  time: 0.9527 (1.8654)  data: 0.0041 (0.9254)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 04:27:34,360 maskrcnn_benchmark INFO: eta: 20:13:01  iter: 20800  loss: 0.4473 (0.4895)  loss_rel: 0.1124 (0.1619)  loss_refine_obj: 0.5521 (0.5768)  ML Loss (cd): -0.2500 (-0.2492)  time: 0.9458 (1.8567)  data: 0.0040 (0.9166)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 04:30:44,953 maskrcnn_benchmark INFO: eta: 20:01:14  iter: 21000  loss: 0.4654 (0.4889)  loss_rel: 0.1453 (0.1619)  loss_refine_obj: 0.5954 (0.5763)  ML Loss (cd): -0.2500 (-0.2492)  time: 0.9575 (1.8481)  data: 0.0040 (0.9079)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 04:33:55,656 maskrcnn_benchmark INFO: eta: 19:49:37  iter: 21200  loss: 0.4659 (0.4884)  loss_rel: 0.1408 (0.1619)  loss_refine_obj: 0.5865 (0.5758)  ML Loss (cd): -0.2500 (-0.2492)  time: 0.9607 (1.8396)  data: 0.0039 (0.8993)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 04:37:05,744 maskrcnn_benchmark INFO: eta: 19:38:08  iter: 21400  loss: 0.4121 (0.4878)  loss_rel: 0.1221 (0.1619)  loss_refine_obj: 0.4390 (0.5751)  ML Loss (cd): -0.2500 (-0.2492)  time: 0.9543 (1.8313)  data: 0.0036 (0.8910)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 04:40:16,953 maskrcnn_benchmark INFO: eta: 19:26:51  iter: 21600  loss: 0.3806 (0.4873)  loss_rel: 0.0861 (0.1619)  loss_refine_obj: 0.4856 (0.5746)  ML Loss (cd): -0.2500 (-0.2492)  time: 0.9592 (1.8232)  data: 0.0039 (0.8828)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 04:43:28,594 maskrcnn_benchmark INFO: eta: 19:15:43  iter: 21800  loss: 0.4202 (0.4867)  loss_rel: 0.1722 (0.1618)  loss_refine_obj: 0.4434 (0.5741)  ML Loss (cd): -0.2500 (-0.2492)  time: 0.9514 (1.8153)  data: 0.0038 (0.8747)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 04:46:39,128 maskrcnn_benchmark INFO: eta: 19:04:42  iter: 22000  loss: 0.3754 (0.4859)  loss_rel: 0.1101 (0.1618)  loss_refine_obj: 0.4987 (0.5734)  ML Loss (cd): -0.2500 (-0.2493)  time: 0.9558 (1.8074)  data: 0.0037 (0.8668)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 04:46:39,131 maskrcnn_benchmark.utils.checkpoint INFO: Saving checkpoint to /users/students/r0879687/amager/vg/output/relation_baseline_sggdet_energy_bs2/model_0022000.pth
2023-03-06 04:47:13,993 maskrcnn_benchmark INFO: Start validating
2023-03-06 04:47:14,064 maskrcnn_benchmark INFO: Start evaluation on VG_stanford_filtered_with_attribute_val dataset(5000 images).
2023-03-06 05:12:41,145 maskrcnn_benchmark INFO: Total run time: 0:25:27.080881 (0.3054161762714386 s / img per device, on 1 devices)
2023-03-06 05:12:41,146 maskrcnn_benchmark INFO: Model inference time: 0:23:25.072144 (0.2810144287109375 s / img per device, on 1 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(398905, 7)
0/398905
DONE (t=2.03s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=30.52s).
Accumulating evaluation results...
DONE (t=8.49s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.284
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.135
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.060
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.108
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.185
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.226
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.340
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.345
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.172
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.290
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.376
2023-03-06 05:18:28,887 maskrcnn_benchmark INFO: 
====================================================================================================
Detection evaluation mAp=0.2842
====================================================================================================
SGG eval:   R @ 20: 0.2403;   R @ 50: 0.3098;   R @ 100: 0.3517;  for mode=sgdet, type=Recall(Main).
SGG eval: ngR @ 20: 0.2492; ngR @ 50: 0.3384; ngR @ 100: 0.3979;  for mode=sgdet, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0000;  zR @ 50: 0.0000;  zR @ 100: 0.0000;  for mode=sgdet, type=Zero Shot Recall.
SGG eval:  zR @ 20: 0.0032;  zR @ 50: 0.0116;  zR @ 100: 0.0229;  for mode=sgdet, type=1 Shot Recall.
 zR @ 20: 0.0060;  zR @ 50: 0.0125;  zR @ 100: 0.0260;  for mode=sgdet, type=2 Shot Recall.
 zR @ 20: 0.0147;  zR @ 50: 0.0220;  zR @ 100: 0.0403;  for mode=sgdet, type=3 Shot Recall.
 zR @ 20: 0.0236;  zR @ 50: 0.0236;  zR @ 100: 0.0354;  for mode=sgdet, type=4 Shot Recall.
 zR @ 20: 0.0278;  zR @ 50: 0.0475;  zR @ 100: 0.0704;  for mode=sgdet, type=5 Shot Recall.
 zR @ 20: 0.0308;  zR @ 50: 0.0513;  zR @ 100: 0.0838;  for mode=sgdet, type=6 Shot Recall.
 zR @ 20: 0.0333;  zR @ 50: 0.0472;  zR @ 100: 0.0864;  for mode=sgdet, type=7 Shot Recall.
 zR @ 20: 0.0121;  zR @ 50: 0.0288;  zR @ 100: 0.0596;  for mode=sgdet, type=8 Shot Recall.
 zR @ 20: 0.0288;  zR @ 50: 0.0612;  zR @ 100: 0.0971;  for mode=sgdet, type=9 Shot Recall.
 zR @ 20: 0.0149;  zR @ 50: 0.0554;  zR @ 100: 0.0993;  for mode=sgdet, type=10 Shot Recall.
 zR @ 20: 0.0213;  zR @ 50: 0.0585;  zR @ 100: 0.0931;  for mode=sgdet, type=20 Shot Recall.
 zR @ 20: 0.0274;  zR @ 50: 0.0583;  zR @ 100: 0.0869;  for mode=sgdet, type=25 Shot Recall.
 zR @ 20: 0.0130;  zR @ 50: 0.0390;  zR @ 100: 0.0390;  for mode=sgdet, type=30 Shot Recall.
 zR @ 20: 0.1711;  zR @ 50: 0.2118;  zR @ 100: 0.2816;  for mode=sgdet, type=40 Shot Recall.
 zR @ 20: 0.1042;  zR @ 50: 0.1250;  zR @ 100: 0.2083;  for mode=sgdet, type=50 Shot Recall.
 zR @ 20: 0.1218;  zR @ 50: 0.2244;  zR @ 100: 0.2628;  for mode=sgdet, type=100 Shot Recall.
 zR @ 20: 0.3333;  zR @ 50: 0.6667;  zR @ 100: 0.6667;  for mode=sgdet, type=200 Shot Recall.
SGG eval:  mR @ 20: 0.0411;  mR @ 50: 0.0545;  mR @ 100: 0.0655;  for mode=sgdet, type=Mean Recall.
(above:0.0258) (across:0.0000) (against:0.0000) (along:0.0000) (and:0.0000) (at:0.0463) (attached to:0.0000) (behind:0.1799) (belonging to:0.0000) (between:0.0000) (carrying:0.1075) (covered in:0.0000) (covering:0.0000) (eating:0.0000) (flying in:0.0000) (for:0.0000) (from:0.0000) (growing on:0.0000) (hanging from:0.0000) (has:0.4069) (holding:0.2764) (in:0.1452) (in front of:0.0158) (laying on:0.0000) (looking at:0.0000) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.2152) (of:0.2084) (on:0.4719) (on back of:0.0000) (over:0.0122) (painted on:0.0000) (parked on:0.0000) (part of:0.0000) (playing:0.0000) (riding:0.2872) (says:0.0000) (sitting on:0.1274) (standing on:0.0022) (to:0.0000) (under:0.0476) (using:0.0000) (walking in:0.0000) (walking on:0.0098) (watching:0.0196) (wearing:0.6454) (wears:0.0000) (with:0.0221) 
====================================================================================================

2023-03-06 05:18:29,875 maskrcnn_benchmark INFO: Validation Result: 0.3517
2023-03-06 05:21:39,043 maskrcnn_benchmark INFO: eta: 19:48:01  iter: 22200  loss: 0.3735 (0.4854)  loss_rel: 0.1249 (0.1617)  loss_refine_obj: 0.4986 (0.5730)  ML Loss (cd): -0.2500 (-0.2493)  time: 0.9475 (1.8857)  data: 0.0036 (0.9451)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 05:24:50,352 maskrcnn_benchmark INFO: eta: 19:36:31  iter: 22400  loss: 0.4153 (0.4850)  loss_rel: 0.1260 (0.1616)  loss_refine_obj: 0.5158 (0.5727)  ML Loss (cd): -0.2500 (-0.2493)  time: 0.9539 (1.8774)  data: 0.0040 (0.9367)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 05:28:00,461 maskrcnn_benchmark INFO: eta: 19:25:09  iter: 22600  loss: 0.4260 (0.4845)  loss_rel: 0.1070 (0.1615)  loss_refine_obj: 0.5336 (0.5723)  ML Loss (cd): -0.2500 (-0.2493)  time: 0.9616 (1.8692)  data: 0.0040 (0.9284)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 05:31:11,297 maskrcnn_benchmark INFO: eta: 19:13:57  iter: 22800  loss: 0.3534 (0.4837)  loss_rel: 0.0912 (0.1615)  loss_refine_obj: 0.3933 (0.5715)  ML Loss (cd): -0.2500 (-0.2493)  time: 0.9473 (1.8612)  data: 0.0039 (0.9203)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 05:34:22,247 maskrcnn_benchmark INFO: eta: 19:02:53  iter: 23000  loss: 0.3705 (0.4832)  loss_rel: 0.1200 (0.1615)  loss_refine_obj: 0.4651 (0.5710)  ML Loss (cd): -0.2500 (-0.2493)  time: 0.9547 (1.8533)  data: 0.0037 (0.9123)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
2023-03-06 05:37:34,075 maskrcnn_benchmark INFO: eta: 18:51:59  iter: 23200  loss: 0.3746 (0.4827)  loss_rel: 0.0852 (0.1614)  loss_refine_obj: 0.4883 (0.5706)  ML Loss (cd): -0.2500 (-0.2493)  time: 0.9593 (1.8456)  data: 0.0034 (0.9045)  energy lr: 0.000250  base lr : 0.000250  max mem: 8960
